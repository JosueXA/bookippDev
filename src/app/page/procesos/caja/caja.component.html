<mat-card class="mat-elevation-z8" id="modalCaja001">
    <mat-card-header style="display: flex; justify-content: space-between;">
        <mat-card-title>Punto de Venta</mat-card-title>
        <mat-icon class="iconosBookipp" svgIcon="iconCruzCirculo" (click)="caja_cerrarModalCaja()" style="cursor: pointer; float: right; font-size: 16px;"></mat-icon>
    </mat-card-header>
    <mat-divider></mat-divider>

    <mat-card-content>
        <mat-tab-group #tabGroup dynamicHeight="true" mat-align-tabs="center" preserveContent="false" (selectedIndexChange)="cambiarPestana($event)">
            <mat-tab label="Venta" style="width: 25%;" *ngIf="accesosPantalla.caja.venta == 1">
                <div id="tabVenta" class="tab-pane active in" style="margin-top: 20px; padding: 0px 2px;">
                    <div class="row">
                        
                        <div class="col-lg-9" style=" margin-bottom: 10px;" *ngIf="caja.venta.parte == 1">
                            <!-- Cliente -->
                            <div class="row" style=" min-height: 34px;" *ngIf="!caja.venta.clienteNuevo.mostrarNuevoCliente">

                                <div class="col-lg-6">
                                    <div class="row">
                                        <div class="col-lg-3" style="margin-top: 6px; font-size: 15px; display: flex;">
                                            <label> Cliente </label>
                                            <mat-icon svgIcon="iconAgregar" class="iconosBookipp ms-2 cursorPointer" (click)="caja_venta_clienteNuevo_nuevoCliente()" *ngIf="caja.venta.permitirCambioCliente" style="width: 27px; display: flex;"></mat-icon>
                                        </div>
                                        <div class="col-lg-9" >
                                            <ng-select id="uiSelectClienteCaja" 
                                                    style="width: 100%;" 
                                                    [dropdownPosition]="'bottom'"                                                    
                                                    [multiple]="false" 
                                                    appendTo="#uiSelectClienteCaja" 
                                                    [searchable]="true"
                                                    [(ngModel)]="caja.venta.cliente" 
                                                    [clearable]="true"
                                                    placeholder="Cliente"
                                                    [items]="caja.venta.listadoClientesBuffer" 
                                                    bindLabel="nombreBuscar" 
                                                    bindValue="idCliente"
                                                    (change)="caja_venta_cambiarCliente()"
                                                    [disabled]="!caja.venta.permitirCambioCliente"
                                                    
                                                    (click)="resetInfScroll('CajaVentaClientes', null)"
                                                    (blur)="resetDdl()"
                                                    [virtualScroll]="true"
                                                    (keyup)="buscarEnScroll('CajaVentaClientes', 'uiSelectClienteCaja', null, null)"
                                                    (scroll)="onScroll('CajaVentaClientes', $event, null)">
                                            </ng-select>
                                        </div>
                                        
                                    </div>
                                </div>

                                <div class="col-lg-6" *ngIf="caja.venta.cliente">
                                    <div class="row">
                                        <div class="col-lg-8" style="margin-top: 6px; font-size: 15px; text-align: right;">
                                            <a class="nwLink2" href="javascript:void(0);" (click)="caja_venta_clienteHistorial_abrirModalClienteHistorial()" *ngIf="accesosPantalla.caja.ventaHistorial == 1">
                                                Historial del Cliente
                                            </a>
                                        </div>
                                        <div class="col-lg-4" style="height: 34px; color: red; font-size: 15px; border-radius: 6px; border: 2px solid red;  text-align: center;">
                                            <label style="margin-top: 5px;"> {{ caja.venta.totales.totalCuentasCobrar | currency }}</label>
                                        </div>
                                    </div>
                                </div>

                            </div>

                            <!-- Nuevo Cliente -->
                            <div class="col-lg-12" style=" min-height: 34px;" *ngIf="caja.venta.clienteNuevo.mostrarNuevoCliente">
                                <div class="col-lg-12" style="min-height: 34px; font-size: 15px; align-items: center; display: flex;">
                                    <label> Nuevo Cliente </label>
                                    <mat-icon svgIcon="iconDeshacer" class="iconosBookipp ms-2 cursorPointer" (click)="caja_venta_clienteNuevo_quitarNuevoCliente()" style="width: 27px;"></mat-icon>
                                </div>
                                <div class="row" style="margin: 0px;">
                                    <div class="col-lg-6" style="font-size: 15px;">
                                        Nombre
                                        <input id="cajaCNNombre" class="form-control borderAzul" type="text"
                                            [matAutocomplete]="nombreAutocomplete"
                                            [(ngModel)]="caja.venta.clienteNuevo.nombre"
                                            (ngModelChange)="filtroNombre()"/>
                                        <mat-autocomplete #nombreAutocomplete="matAutocomplete" [displayWith]="displayOptions">
                                            <mat-option *ngFor="let dcb of caja.venta.dataClienteBuscador" [value]="dcb">
                                                {{dcb}}
                                            </mat-option>
                                        </mat-autocomplete>                                        
                                    </div>
                                    <div class="col-lg-6" style="font-size: 15px;">
                                        Email
                                        <input id="cajaCNEmail" class="form-control borderAzul" [(ngModel)]="caja.venta.clienteNuevo.email"/>
                                    </div>
                                </div>
                                <div class="row" style="margin: 0px;">
                                    <div class="col-lg-6" style="font-size: 15px;">
                                        Teléfono
                                        <input id="cajaCNTelefono" class="form-control borderAzul" [(ngModel)]="caja.venta.clienteNuevo.telefono"/>
                                    </div>
                                    <div class="col-lg-6" style="font-size: 15px;">
                                        Fecha de Nacimiento
                                        <!-- <input onkeypress="javascript:return valFecha(event)"  id="cajaCNFechaNacimiento"
                                            [(ngModel)]="caja.venta.clienteNuevo.fechaNacimiento" 
                                            (blur)="caja.venta.clienteNuevo.cambiarFechaNacimiento()"
                                            type="text" class="form-control borderAzul" autoclose="true" 
                                            date-format="dd/MM/yyyy" bs-datepicker maxlength="10" placeholder="13/03/1995"> -->
                                        <input id="cajaCNFechaNacimiento" class="form-control borderAzul" type="date"
                                            required min="01-01-1930" [(ngModel)]="caja.venta.clienteNuevo.fechaNacimiento" />
                                    </div>
                                </div>
                            </div>

                            <div class="col-lg-12" style="padding-right: 0;">
                                <hr style="background-color: #357EC1; height: 1px;">
                            </div>

                            <!-- Ventas y cuentas por cobrar -->
                            <div class="col-lg-12" style="padding-right: 0; margin-top: 15px; overflow-y: scroll; height: 480px;" [ngStyle]="{ 'height': caja.venta.estiloListado }">

                                <!--Lista de servicios -->
                                <div class="col-lg-12">
                                    <div id="Div5" style="width:100%; font-size: 15px; margin-bottom: 15px;">
                                        <b> Servicios </b> 
                                        <mat-icon svgIcon="iconAgregar" class="iconosBookipp ms-2 cursorPointer" (click)="caja_venta_servicios_agregarServicio()" style="width: 24px; display: inline-table;"></mat-icon>
                                    </div>

                                    <div id="pagar-servicios" style="display:inline-block; width:100%">

                                        <!-- Titulos de campos de servicio sin prepago -->
                                        <div *ngIf="caja.venta.servicios.listaServiciosPorCobrar.length != 0 && !caja.venta.servicios.titulosConPrepago" 
                                            style="width: 100%; display: flex; padding-left: 15px; padding-right: 15px;">
                                            <div style="width:100%; display:flex;">
                                                <div style="width: 35%; text-align: left;"> Personal </div>
                                                <div style="width: 35%; text-align: left;"> Servicio </div>
                                                <div style="width: 20%; text-align: center;"> Costo </div>
                                            </div>
                                        </div>

                                        <div *ngFor="let s of caja.venta.servicios.listaServiciosPorCobrar; let $index = index;" style="width:100%; margin-bottom:5px; padding-left: 15px; padding-right: 15px;">

                                            <!---- Sección cuando es un servicio creado en caja o viene desde pagar cita ---->
                                            <div *ngIf="s.esVenta" style="width:100%;">

                                                <!-- Servicio de cita normal(no paquete) o creado en caja -->
                                                <div *ngIf="s.idPaqueteSucursalCliente == null" style="width: 100%;">

                                                    <!-- Servicio sin prepago -->
                                                    <div *ngIf="s.idPagoClienteDetalle == null" style="width: 100%;">

                                                        <!-- Titulos de campos de servicio normal si hay un prepago -->
                                                        <div *ngIf="caja.venta.servicios.titulosConPrepago" style="width: 100%; display: flex;">
                                                            <div style="width:100%; display:flex;">
                                                                <div style="width: 35%; text-align: left;"> Personal </div>
                                                                <div style="width: 35%; text-align: left;"> Servicio </div>
                                                                <div style="width: 20%; text-align: center;"> Costo </div>
                                                            </div>
                                                        </div>

                                                        <!--Servicio-->
                                                        <div style="width: 100%; display: flex;">

                                                            <div style="width: 35%;">
                                                                <ng-select id="{{'servicioDDLPersonal' + $index}}" 
                                                                        style="width: 95% !important;"                                                                                                               
                                                                        [multiple]="false" 
                                                                        [dropdownPosition]="'bottom'"
                                                                        appendTo="#{{'servicioDDLPersonal' + $index}}" 
                                                                        [searchable]="true"
                                                                        [(ngModel)]="s.idPersonal" 
                                                                        [clearable]="false"
                                                                        placeholder="{{'agendaTranslate.placeholderPersonal'| translate}}"
                                                                        [items]="caja.venta.listadoPersonal" 
                                                                        bindLabel="nombre" 
                                                                        bindValue="idPersonal"
                                                                        (change)="caja_venta_servicios_consultarServiciosPorPersonal(s)">
                                                                </ng-select>
                                                            </div>

                                                            <div style="width: 35%;">
                                                                <ng-select id="{{'servicioDDLServicio'+$index}}" 
                                                                    style="width: 95% !important;"
                                                                    [multiple]="false" 
                                                                    [dropdownPosition]="'bottom'"
                                                                    appendTo="#{{'servicioDDLServicio'+$index}}" 
                                                                    [searchable]="true"
                                                                    [(ngModel)]="s.idServicio" 
                                                                    [clearable]="false"
                                                                    placeholder="{{'agendaTranslate.placeholderServicio'| translate}}"
                                                                    [items]="s.listadoServicioBuffer" 
                                                                    bindLabel="nombre" 
                                                                    bindValue="idServicio"
                                                                    (change)="caja_venta_servicios_actualizarCostoPorServicio(s, $event, $index);"

                                                                    (click)="resetInfScroll('CajaVentaServicio', $index)"
                                                                    (blur)="resetDdl()"
                                                                    [virtualScroll]="true"
                                                                    (keyup)="buscarEnScroll('CajaVentaServicio', 'servicioDDLServicio' + $index, $index, null)"
                                                                    (scroll)="onScroll('CajaVentaServicio', $event, $index)">
                                                                </ng-select>
                                                            </div>

                                                            <div style="width: 20%; display: flex;">
                                                                <div class="divider"></div>
                                                                <label class="payment-company-currency">$</label>
                                                                <input id="{{'servicioInputCosto'+$index}}" class="form-control borderAzul" maxlength="10"
                                                                    theme="select2"
                                                                    (input)="caja_venta_servicios_cambiarCostoServicio(s, $index)"
                                                                    (blur)="caja_venta_servicios_cambiarCostoServicio(s, $index)"
                                                                    [(ngModel)]="s.costoElegido"                                                       
                                                                    placeholder="{{s.costoMinimo}} - {{s.costoMaximo}}"
                                                                    style="width: 86.5%; padding-left: 8px; padding-top: 3px" decimals-only />
                                                            </div>

                                                            <div style="width: 5%; text-align: center;">
                                                                <div *ngIf="s.mostrarBotonDescuento">
                                                                    <mat-icon svgIcon="iconPorcentaje" class="iconosBookipp ms-2 cursorPointer" (click)="caja_venta_servicios_mostrarDescuento(s)" style="width: 24px; display: inline-table;"></mat-icon>
                                                                </div>
                                                            </div>

                                                            <div style="width: 5%; text-align: center;">
                                                                <!--MAGP 25/03/2022-->
                                                                <mat-icon svgIcon="iconCruzCuadrado" class="iconosBookipp ms-2 cursorPointer" (click)="caja_venta_servicios_removerServicio($index)" style="width: 24px; display: inline-table;"></mat-icon>
                                                            </div>

                                                        </div>

                                                        <!--Descuentos-->
                                                        <div style="width: 100%; display: flex;" *ngIf="s.mostrarDescuento">

                                                            <div style="margin-top: 5px; width: 70%;">
                                                                <div>
                                                                    {{'agendaTranslate.descuento' | translate}}
                                                                </div>
                                                                <div style="display: flex; width: 100%">
                                                                    <input class="form-control borderAzul" maxlength="10" [(ngModel)]="s.descuentoP"
                                                                        (input)="caja_venta_servicios_calcularDescuentoServicio(s, 1, $index)"
                                                                        (click)="caja_venta_servicios_quitarCerosServicios(s, 1)"
                                                                        (blur)="caja_venta_servicios_ponerCerosServicios(s, 1, $index)"
                                                                        style="width: 46.75%; text-align: right" decimals-only />
                                                                    <label style="margin-top: 8px;">%</label>
                                                                    <div class="divider"></div>
                                                                    <label style="margin-top: 8px;">$</label>
                                                                    <input class="form-control borderAzul" maxlength="10" [(ngModel)]="s.descuentoF"
                                                                        (input)="caja_venta_servicios_calcularDescuentoServicio(s, 2, $index)"
                                                                        (click)="caja_venta_servicios_quitarCerosServicios(s, 2)"
                                                                        (blur)="caja_venta_servicios_ponerCerosServicios(s, 2, $index)"
                                                                        style="width: 46.75%;" decimals-only />
                                                                </div>
                                                            </div>
                                                            <div style="margin-top: 5px; width: 30%;">
                                                                <div>
                                                                    Total con descuento
                                                                </div>
                                                                <div style="display: flex;">
                                                                    <div class="divider"></div>
                                                                    <label class="payment-company-currency">$</label>
                                                                    <input maxlength="50" currency-mask placeholder="" [(ngModel)]="s.costoDescuento" class="form-control borderAzul" style="cursor: auto; width: 58%; height: 34px; padding-left: 8px" disabled />
                                                                </div>
                                                            </div>
                                                        </div>

                                                    </div>

                                                    <!-- Servicio con prepago -->
                                                    <div *ngIf="s.idPagoClienteDetalle != null" style="width: 100%;">

                                                        <div *ngIf="caja.venta.servicios.titulosConPrepago" style="width: 100%; display: flex;">
                                                            <div style="width:100%; display:flex;">
                                                                <div style="width: 30%; text-align: left;"> Personal </div>
                                                                <div style="width: 30%; text-align: left;"> Servicio </div>
                                                                <div style="width: 15%; text-align: center;"> Prepagado </div>
                                                                <div style="width: 15%; text-align: center;"> Faltante </div>
                                                            </div>
                                                        </div>

                                                        <!--Servicio-->
                                                        <div style="width: 100%; display: flex;">

                                                            <div style="width: 30%;">
                                                                <ng-select id="{{'servicioDDLPersonal' + $index}}" 
                                                                        style="width: 95% !important;"                                                                                                               
                                                                        [multiple]="false" 
                                                                        [dropdownPosition]="'bottom'"
                                                                        appendTo="#{{'servicioDDLPersonal' + $index}}" 
                                                                        [searchable]="true"
                                                                        [(ngModel)]="s.idPersonal" 
                                                                        [clearable]="false"
                                                                        placeholder="{{'agendaTranslate.placeholderPersonal'| translate}}"
                                                                        [items]="caja.venta.listadoPersonal" 
                                                                        bindLabel="nombre" 
                                                                        bindValue="idPersonal"
                                                                        (change)="caja_venta_servicios_consultarServiciosPorPersonal(s)">
                                                                </ng-select>
                                                            </div>

                                                            <div style="width: 30%;">
                                                                <ng-select id="{{'servicioDDLServicio'+$index}}" 
                                                                    style="width: 95% !important;"
                                                                    [multiple]="false" 
                                                                    [dropdownPosition]="'bottom'"
                                                                    appendTo="#{{'servicioDDLServicio'+$index}}" 
                                                                    [searchable]="true"
                                                                    [(ngModel)]="s.idServicio" 
                                                                    [clearable]="false"
                                                                    placeholder="{{'agendaTranslate.placeholderServicio'| translate}}"
                                                                    [items]="s.listadoServicioBuffer" 
                                                                    bindLabel="nombre" 
                                                                    bindValue="idServicio"

                                                                    (click)="resetInfScroll('CajaVentaServicio', $index)"
                                                                    (blur)="resetDdl()"
                                                                    [virtualScroll]="true"
                                                                    (keyup)="buscarEnScroll('CajaVentaServicio', 'servicioDDLServicio' + $index, $index, null)"
                                                                    (scroll)="onScroll('CajaVentaServicio', $event, $index)">
                                                                </ng-select>
                                                            </div>

                                                            <div style="width: 15%; display: flex;">
                                                                <div class="divider"></div>
                                                                <label class="payment-company-currency">$</label>
                                                                <input id="{{'servicioMontoPagado'+$index}}" class="form-control borderAzul" maxlength="10"
                                                                    theme="select2"
                                                                    [(ngModel)]="s.montoPrepagado"
                                                                    [disabled]="true"
                                                                    style="width: 86.5%; padding-left: 8px; padding-top: 3px" decimals-only />
                                                            </div>

                                                            <div style="width: 20%; display: flex;">
                                                                <div class="divider"></div>
                                                                <label class="payment-company-currency">$</label>
                                                                <input id="Text23" class="form-control borderAzul" maxlength="10"
                                                                    theme="select2"
                                                                    (input)="caja_venta_servicios_cambiarCostoServicio(s, $index)"
                                                                    (blur)="caja_venta_servicios_cambiarCostoServicio(s, $index)"
                                                                    [(ngModel)]="s.costoElegido"
                                                                    placeholder="{{s.costoMinimo}} - {{s.costoMaximo}}"
                                                                    style="width: 86.5%; padding-left: 8px; padding-top: 3px" decimals-only />
                                                            </div>

                                                        </div>

                                                    </div>

                                                </div>

                                                <!-- Servicio de cita perteneciente a paquete -->
                                                <div *ngIf="s.idPaqueteSucursalCliente != null" style="width: 100%;">

                                                    <div style="width: 100%;">

                                                        <div style="width: 100%; display: flex;">
                                                            <div style="width: 35%;">
                                                                <ng-select id="{{'servicioDDLPersonal' + $index}}" 
                                                                        style="width: 95% !important;"                                                                                                               
                                                                        [multiple]="false" 
                                                                        [dropdownPosition]="'bottom'"
                                                                        appendTo="#{{'servicioDDLPersonal' + $index}}" 
                                                                        [searchable]="true"
                                                                        [(ngModel)]="s.idPersonal" 
                                                                        [clearable]="false"
                                                                        placeholder="{{'agendaTranslate.placeholderPersonal'| translate}}"
                                                                        [items]="caja.venta.listadoPersonal" 
                                                                        bindLabel="nombre" 
                                                                        bindValue="idPersonal">
                                                                </ng-select>
                                                            </div>

                                                            <div style="width: 35%;">
                                                                <ng-select id="{{'servicioDDLServicio'+$index}}" 
                                                                    style="width: 95% !important;"
                                                                    [multiple]="false" 
                                                                    [dropdownPosition]="'bottom'"
                                                                    appendTo="#{{'servicioDDLServicio'+$index}}" 
                                                                    [searchable]="true"
                                                                    [(ngModel)]="s.idServicio" 
                                                                    [clearable]="false"
                                                                    placeholder="{{'agendaTranslate.placeholderServicio'| translate}}"
                                                                    [items]="s.listadoServicioBuffer" 
                                                                    bindLabel="nombre" 
                                                                    bindValue="idServicio"
                                                                    (change)="caja_venta_servicios_actualizarCostoPorServicio(s, $event, $index);"

                                                                    (click)="resetInfScroll('CajaVentaServicio', $index)"
                                                                    (blur)="resetDdl()"
                                                                    [virtualScroll]="true"
                                                                    (keyup)="buscarEnScroll('CajaVentaServicio', 'servicioDDLServicio' + $index, $index, null)"
                                                                    (scroll)="onScroll('CajaVentaServicio', $event, $index)"
                                                                    
                                                                    [disabled]="true">
                                                                </ng-select>
                                                            </div>

                                                            <div style="width: 20%; display: flex;">
                                                                <div class="divider"></div>
                                                                <label class="payment-company-currency">$</label>
                                                                <input id="Text19" class="form-control borderAzul" maxlength="10"
                                                                    theme="select2"
                                                                    value="0"
                                                                    [disabled]="true"
                                                                    style="width: 86.5%; padding-left: 8px; padding-top: 3px"/>
                                                            </div>

                                                        </div>
                                                    </div>
                                                </div>

                                            </div>

                                            <!---- Sección de cuentas por cobrar de servicio ---->
                                            <div *ngIf="s.esCuentaPagar" style="width:100%; display:flex;">

                                                <div style="width:35%;">
                                                    <input id="Text1" class="form-control borderAzul" [(ngModel)]="s.nombrePersonal" style="width: 95%; height: 100%;" [disabled]="true"/>
                                                </div>

                                                <div style="width:35%;">
                                                    <input id="Text5" class="form-control borderAzul" [(ngModel)]="s.nombreServicio" style="width: 95%; height: 100%;" [disabled]="true"/>
                                                </div>

                                                <div style="width:20%; display:flex;">
                                                    <div class="divider"></div>
                                                    <label class="payment-company-currency">$</label>

                                                    <input id="Text2" class="form-control borderAzul" value="{{s.costoElegido | currency}}" style="width: 100%; height: 100%;" [disabled]="true"/>
                                                </div>

                                                <div style="width:5%; text-align:center;">
                                                    
                                                </div>
                                                <div style="width:5%; text-align:center;">
                                                    <mat-icon svgIcon="iconCruzCuadrado" class="iconosBookipp ms-2 cursorPointer" (click)="caja_venta_servicios_removerServicio($index)" style="width: 24px; display: inline-table;"></mat-icon>
                                                </div>
                                
                                            </div>

                                            <!---- Barra delimitadora de servicio ---->
                                            <div style="width:100%;">
                                                <div style="margin-top: 10px !important; width: 95%; text-align: center;">
                                                    <hr style="background-color: #357EC1; height: 1px;">
                                                </div>
                                            </div>

                                        </div>

                                    </div>

                                </div>
                                
                                <!--Lista de paquetes -->
                                <div class="col-lg-12">
                                    <div id="Div6" style="width:100%; font-size: 15px; margin-bottom: 15px;">
                                        <b> Paquetes </b>
                                        <mat-icon svgIcon="iconAgregar" class="iconosBookipp ms-2 cursorPointer" (click)="caja_venta_paquetes_agregarPaquetes()" style="width: 24px; display: inline-table;"></mat-icon>
                                    </div>

                                    <div id="Div4" style="display:inline-block; width:100%">
                                        <div *ngIf="caja.venta.paquetes.listaPaquetesPorCobrar.length != 0" style="width: 100%; display: flex; padding-left: 15px; padding-right: 15px;">
                                            <div style="width: 35%;"> Personal </div>
                                            <div style="width: 35%;"> Paquete </div>
                                            <div style="width: 20%; text-align: center;">{{'configurarTicketTranslate.total' | translate}}</div>
                                        </div>

                                        <div *ngFor="let p of caja.venta.paquetes.listaPaquetesPorCobrar; let $index = index;" style="width:100%; margin-bottom:5px; padding-left: 15px; padding-right: 15px;">
                                            <!---- Sección de venta de paquete ---->
                                            <div *ngIf="p.esVenta" style="width:100%;">
                                                <div style="width:100%; display: flex; ">
                                                    <div style="width:35%;">
                                                        <!-- <ui-select id="Ui-select2" class="modal-personal campo-modal"
                                                            search-enabled="!mobileBrowser" [(ngModel)]="p.idPersonal"
                                                            theme="select2" style="width: 95%;float:left;">
                                                            <ui-select-match placeholder="{{'agendaTranslate.placeholderPersonal'| translate}}">{{$select.selected.nombre}}</ui-select-match>
                                                            <ui-select-choices repeat="per.idPersonal as per in caja.venta.listadoPersonal | filter: {nombre: $select.search}">
                                                                <span ng-bind-html="per.nombre"></span>
                                                            </ui-select-choices>
                                                        </ui-select> -->
                                                        <ng-select id="Ui-select2" 
                                                                style="width: 95%;" 
                                                                [dropdownPosition]="'bottom'"                                                    
                                                                [multiple]="false" 
                                                                appendTo="#Ui-select2" 
                                                                [searchable]="true"
                                                                [(ngModel)]="p.idPersonal" 
                                                                [clearable]="false"
                                                                placeholder="{{'agendaTranslate.placeholderPersonal'| translate}}"
                                                                [items]="caja.venta.listadoPersonal" 
                                                                bindLabel="nombre" 
                                                                bindValue="idPersonal">
                                                        </ng-select>
                                                    </div>
                                                    <div style="width: 35%;">
                                                        <!--MAGP 04/04/2022 deshabilitar el select si ya se aplicaron paquetes para que no pueda modificarse -->
                                                        <!-- <ui-select id="{{'paqueteDDLPaquete'+$index}}" search-enabled="true" [disabled]="caja.venta.paquetes.paqueteAplicado"
                                                            [(ngModel)]="p.idPaqueteSucursal" ng-change="caja.venta.paquetes.elegirPaquete(p, $select.selected)"
                                                            theme="select2" style="width: 95%">
                                                            <ui-select-match placeholder="">{{$select.selected.nombre}}</ui-select-match>
                                                            <ui-select-choices repeat="paq.idPaqueteSucursal as paq in caja.venta.listadoPaquetes | filter: $select.search">
                                                                <span ng-bind-html="paq.nombre"></span>
                                                            </ui-select-choices>
                                                        </ui-select> -->
                                                        <ng-select id="{{'paqueteDDLPaquete'+$index}}" 
                                                                style="width: 95%;" 
                                                                [dropdownPosition]="'bottom'"                                                    
                                                                [multiple]="false" 
                                                                appendTo="#{{'paqueteDDLPaquete'+$index}}" 
                                                                [searchable]="true"
                                                                [(ngModel)]="p.idPaqueteSucursal" 
                                                                [clearable]="false"
                                                                placeholder=""
                                                                [items]="caja.venta.listadoPaquetes" 
                                                                bindLabel="nombre" 
                                                                bindValue="idPaqueteSucursal"
                                                                (change)="caja_venta_paquetes_elegirPaquete(p, $event)"
                                                                [disabled]="caja.venta.paquetes.paqueteAplicado">
                                                        </ng-select>

                                                    </div>
                                                    <div style="width: 20%; display: flex;">
                                                        <div class="divider"></div>
                                                            <label class="payment-company-currency">$</label>
                                                        <input id="Text4" maxlength="50" placeholder="" [(ngModel)]="p.costoElegido" class="form-control borderAzul" 
                                                            (input)="caja_venta_paquetes_cambiarCostoPaquete(p)"
                                                            (blur)="caja_venta_paquetes_prevenirCostoVacio(p)"
                                                            style="cursor: auto; width: 100%; height: 34px;" [disabled]="!p.costoElegidoEditable" decimals-only/>
                                                    </div>
                                                    <div style="width:5%; text-align:center;">
                                                        <div *ngIf="p.mostrarBotonDescuento">
                                                            <mat-icon svgIcon="iconPorcentaje" class="iconosBookipp ms-2 cursorPointer" (click)="caja_venta_paquetes_mostrarDescuento(p)" style="width: 24px; display: inline-table;"></mat-icon>
                                                            <!-- <i class="fa fa-percent" (click)="caja_venta_paquetes_mostrarDescuento(p)" style="font-size: 15px; cursor: pointer; margin-top:8px;"></i> -->
                                                        </div>
                                                    </div>
                                                    <!--MAGP 28/03/2022 si se aplicó paquete ya no se puede borrar-->
                                                    <div style="width:5%; text-align:center;">
                                                        <mat-icon svgIcon="iconCruzCuadrado" class="iconosBookipp ms-2 cursorPointer" (click)="caja_venta_paquetes_removerPaquetes($index)" *ngIf="p.esVenta && !caja.venta.paquetes.paqueteAplicado" style="width: 24px; display: inline-table;"></mat-icon>
                                                    </div>
                                                    </div>
                                                    <!--MAGP 26/03/2022 Aplicar Paquetes-->
                                                    <div style="margin-top:5px; width:100%; display: flex;" *ngIf="p.idPaqueteSucursal && p.idPaqueteSucursalCliente == null">
                                                        <div style="width:30%;">
                                                            <button type="button" class="buttonEstiloBlanco" style="width: 100%;" (click)="caja_venta_paquetes_aplicarPaqueteVenta(p,$index)"> Aplicar Paquete </button>
                                                        </div>
                                                    </div>

                                                

                                                <div style="width:100%; display: flex;" *ngIf="p.mostrarDescuento">

                                                    <div style="margin-top:5px; width:70%;">
                                                        <div>
                                                            {{'agendaTranslate.descuento'| translate}}
                                                        </div>
                                                        <div style="display:flex; width:100%">
                                                            <input class="form-control borderAzul" maxlength="10" [(ngModel)]="p.descuentoP" 
                                                                (input)="caja_venta_paquetes_calcularDescuento(p, 1)" 
                                                                (click)="caja_venta_paquetes_quitarCeros(p, 1)" 
                                                                (blur)="caja_venta_paquetes_ponerCeros(p, 1)" 
                                                                style="width: 46.75%; text-align:right" decimals-only/>
                                                            <label style="margin-top: 8px;">%</label>
                                                            <div class="divider"></div>
                                                            <label style="margin-top: 8px;">$</label>
                                                            <input class="form-control borderAzul" maxlength="10" [(ngModel)]="p.descuentoF" 
                                                                (input)="caja_venta_paquetes_calcularDescuento(p, 2)"
                                                                (click)="caja_venta_paquetes_quitarCeros(p, 2)" 
                                                                (blur)="caja_venta_paquetes_ponerCeros(p, 2)"
                                                                style="width: 46.75%;" decimals-only/>
                                                        </div>
                                                    </div>
                                                    <div style="margin-top:5px; width:30%;">
                                                        <div>
                                                            Total con descuento
                                                        </div>
                                                        <div style="display:flex;">
                                                            <div class="divider"></div>
                                                            <label class="payment-company-currency">$</label>
                                                            <input maxlength="50" currency-mask placeholder="" [(ngModel)]="p.costoDescuento" class="form-control borderAzul" style="cursor: auto; width: 58%; height: 34px; padding-left: 8px" disabled/>
                                                        </div>
                                                    </div>
                                                </div>

                                            </div>

                                            <!---- Sección de cuentas por cobrar de paquete-->
                                            <div *ngIf="p.esCuentaPagar" style="width:100%; display: flex;">
                                                <div style="width:35%;">
                                                    <input id="Text11" class="form-control borderAzul" [(ngModel)]="p.nombrePersonal" style="width: 95%; height: 100%;" [disabled]="true"/>
                                                </div>

                                                <div style="width:35%;">
                                                    <input id="Text12" class="form-control borderAzul" [(ngModel)]="p.nombrePaquete" style="width: 95%; height: 100%;" [disabled]="true"/>
                                                </div>

                                                <div style="width:20%; display: flex;">
                                                    <div class="divider"></div>
                                                    <label class="payment-company-currency">$</label>
                                                    <input id="Text15" class="form-control borderAzul" [(ngModel)]="p.costoElegido" style="width: 100%; height: 100%;" [disabled]="true"/>
                                                </div>

                                                <div style="width:5%; text-align:center;">
                                                    
                                                </div>
                                                <div style="width:5%; text-align:center;">
                                                    <mat-icon svgIcon="iconCruzCuadrado" class="iconosBookipp ms-2 cursorPointer" (click)="caja_venta_paquetes_removerPaquetes($index)" *ngIf="p.idCita == null" style="width: 24px; display: inline-table;"></mat-icon>
                                                </div>
                                            </div>

                                            <div style="margin-top: 10px !important; width: 95%; text-align: center;">
                                                <hr style="background-color: #357EC1; height: 1px;">
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!--Lista de productos -->
                                <div class="col-lg-12">
                                    <div id="Div2" style="width:100%; font-size: 15px; margin-bottom: 15px;">
                                        <b> Productos </b>
                                        <mat-icon svgIcon="iconAgregar" class="iconosBookipp ms-2 cursorPointer" (click)="caja_venta_productos_agregarProductos()" style="width: 24px; display: inline-table;"></mat-icon>
                                    </div>

                                    <div id="Div3" style="display:inline-block; width:100%">
                                        <div *ngIf="caja.venta.productos.listaProductosPorCobrar.length != 0" style="width: 100%; display: flex; padding-left: 15px; padding-right: 15px;">
                                            <div style="width: 25%;"> Personal </div>
                                            <div style="width: 25%;">{{'producto.producto' | translate}}</div>
                                            <div style="width: 10%; text-align: center"><div style="width: 95%;">{{'agregarOrdenCompraTranslate.cantidad' | translate}}</div></div>
                                            <div style="width: 15%; text-align: center;"><div style="width: 95%;">{{'configurarTicketTranslate.iva' | translate}}</div></div>
                                            <div style="width: 15%; text-align: center;">{{'configurarTicketTranslate.total' | translate}}</div>
                                        </div>

                                        <div *ngFor="let p of caja.venta.productos.listaProductosPorCobrar; let $index = index;" style="width:100%; margin-bottom:5px; padding-left: 15px; padding-right: 15px;">
                                            <!---- Sección de venta de producto en caja-->
                                            <div *ngIf="p.esVenta" style="width:100%;">
                                                <div style="width:100%; display: flex; ">
                                                    <div style="width:25%;">
                                                        <!-- <ui-select id="Ui-select1" class="modal-personal campo-modal"
                                                            search-enabled="!mobileBrowser" [(ngModel)]="p.idPersonal"
                                                            theme="select2" style="width: 95%;float:left;">
                                                            <ui-select-match placeholder="{{'agendaTranslate.placeholderPersonal'| translate}}">{{$select.selected.nombre}}</ui-select-match>
                                                            <ui-select-choices repeat="per.idPersonal as per in caja.venta.listadoPersonal | filter: {nombre: $select.search}">
                                                                <span ng-bind-html="per.nombre"></span>
                                                            </ui-select-choices>
                                                        </ui-select> -->
                                                        <ng-select id="Ui-select1" 
                                                                style="width: 95%;" 
                                                                [dropdownPosition]="'bottom'"                                                    
                                                                [multiple]="false" 
                                                                appendTo="#Ui-select1" 
                                                                [searchable]="true"
                                                                [(ngModel)]="p.idPersonal" 
                                                                [clearable]="false"
                                                                placeholder="{{'agendaTranslate.placeholderPersonal'| translate}}"
                                                                [items]="caja.venta.listadoPersonal" 
                                                                bindLabel="nombre" 
                                                                bindValue="idPersonal">
                                                        </ng-select>
                                                    </div>
                                                    <div style="width: 25%;">
                                                        <!-- <ui-select id="{{'productoDDLPresentacion'+$index}}" search-enabled="true" 
                                                            [(ngModel)]="p.idInventarioPresentacion" ng-change="caja.venta.productos.elegirPresentacion(p, $select.selected, $index)"
                                                            theme="select2" style="width: 95%">
                                                            <ui-select-match placeholder="">{{$select.selected.nombreProducto}}</ui-select-match>
                                                            <ui-select-choices repeat="produc.idInventarioPresentacion as produc in p.listadoPresentaciones | filter: $select.search">
                                                                <span ng-bind-html="produc.nombreProducto"></span>
                                                            </ui-select-choices>
                                                        </ui-select> -->
                                                        <ng-select id="{{'productoDDLPresentacion'+$index}}"
                                                                #productoDDLPresentacion
                                                                style="width: 95%;" 
                                                                [dropdownPosition]="'bottom'"                                                    
                                                                [multiple]="false" 
                                                                appendTo="#{{'productoDDLPresentacion'+$index}}" 
                                                                [searchable]="true"
                                                                [(ngModel)]="p.idInventarioPresentacion" 
                                                                [clearable]="false"
                                                                placeholder=""
                                                                [items]="p.listadoPresentacionesBuffer" 
                                                                bindLabel="nombreProducto" 
                                                                bindValue="idInventarioPresentacion"
                                                                (change)="caja_venta_productos_elegirPresentacion(p, $event, $index)"
                                                                
                                                                (click)="resetInfScroll('CajaVentaProducto', $index)"
                                                                (blur)="resetDdl()"
                                                                [virtualScroll]="true"
                                                                (keyup)="buscarEnScroll('CajaVentaProducto', 'productoDDLPresentacion' + $index, $index, productoDDLPresentacion)"
                                                                (scroll)="onScroll('CajaVentaProducto', $event, $index)">
                                                        </ng-select>
                                                    </div>
                                                    <div style="width: 10%;">
                                                        <input id="{{'cantidadP'+$index}}" type="number" class="form-control borderAzul" style="width: 95%; text-align: right;" 
                                                            [(ngModel)]="p.cantidad" 
                                                            (input)="caja_venta_productos_calcularCostoPorCantidad(p)"
                                                            (blur)="caja_venta_productos_prevenirValorCantidad(p)" 
                                                            min="1" max="{{p.cantidadMaxima}}" [disabled]="p.idInventarioPresentacion == ''"/>
                                                    </div>
                                                    <div style="width: 15%;">
                                                        <input id="{{'ivaP'+$index}}" maxlength="50" currency-mask placeholder="" [(ngModel)]="p.iva" class="form-control borderAzul" 
                                                            style="cursor: default; width: 95%; height: 34px;" disabled />
                                                    </div>
                                                    <div style="width: 15%; display: flex;">
                                                        <div class="divider"></div>
                                                        <label class="payment-company-currency">$</label>
                                                        <input id="{{'totalP'+$index}}" maxlength="50" placeholder="" [(ngModel)]="p.costoElegido" class="form-control borderAzul" 
                                                            (input)="caja_venta_productos_cambiarCostoProducto(p)"
                                                            (blur)="caja_venta_productos_prevenirCostoVacio(p)"
                                                            style="cursor: auto; width: 100%; height: 34px;" [disabled]="!p.cantidad" decimals-only/>
                                                    </div>
                                                    <div style="width:5%; text-align:center;">
                                                        <div *ngIf="p.mostrarBotonDescuento">
                                                            <mat-icon svgIcon="iconPorcentaje" class="iconosBookipp ms-2 cursorPointer" (click)="caja_venta_productos_mostrarDescuento(p)" style="width: 24px; display: inline-table;"></mat-icon>
                                                            <!-- <i class="fa fa-percent" (click)="caja_venta_productos_mostrarDescuento(p)" style="font-size: 15px; cursor: pointer; margin-top:8px;"></i> -->
                                                        </div>
                                                    </div>
                                                    <div style="width:5%; text-align:center;">
                                                        <mat-icon svgIcon="iconCruzCuadrado" class="iconosBookipp ms-2 cursorPointer" (click)="caja_venta_productos_removerProducto($index)" *ngIf="p.esVenta" style="width: 24px; display: inline-table;"></mat-icon>
                                                    </div>
                                                </div>

                                                <div style="width:100%; display: flex;" *ngIf="p.mostrarDescuento">

                                                    <div style="margin-top:5px; width:70%;">
                                                        <div>
                                                            {{'agendaTranslate.descuento'| translate}}
                                                        </div>
                                                        <div style="display:flex; width:100%">
                                                            <input class="form-control borderAzul" maxlength="10" [(ngModel)]="p.descuentoP" 
                                                                (input)="caja_venta_productos_calcularDescuento(p, 1)" 
                                                                (click)="caja_venta_productos_quitarCeros(p, 1)" 
                                                                (blur)="caja_venta_productos_ponerCeros(p, 1)" 
                                                                style="width: 46.75%; text-align:right" decimals-only/>
                                                            <label style="margin-top: 8px;">%</label>
                                                            <div class="divider"></div>
                                                            <label style="margin-top: 8px;">$</label>
                                                            <input class="form-control borderAzul" maxlength="10" [(ngModel)]="p.descuentoF" 
                                                                (input)="caja_venta_productos_calcularDescuento(p, 2)"
                                                                (click)="caja_venta_productos_quitarCeros(p, 2)" 
                                                                (blur)="caja_venta_productos_ponerCeros(p, 2)"
                                                                style="width: 46.75%;" decimals-only/>
                                                        </div>
                                                    </div>
                                                    <div style="margin-top:5px; width:30%;">
                                                        <div>
                                                            Total con descuento
                                                        </div>
                                                        <div style="display:flex;">
                                                            <div class="divider"></div>
                                                            <label class="payment-company-currency">$</label>
                                                            <input maxlength="50" currency-mask placeholder="" [(ngModel)]="p.costoDescuento" class="form-control borderAzul" style="cursor: auto; width: 58%; height: 34px; padding-left: 8px" disabled/>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div style="width:100%;  color:red;" *ngIf="p.idInventarioPresentacion != '' && p.cantidad" [hidden]="caja.ocultaravisoinventario">
                                                    <div style="width:100%;  color:red; text-align:right;" *ngIf="p.cantidadMaxima - p.cantidad == 0">
                                                        No quedarán unidades
                                                    </div>
                                                    <div style="width:100%;  color:red; text-align:right;" *ngIf="p.cantidadMaxima - p.cantidad == 1">
                                                        Quedará 1 unidad
                                                    </div>
                                                    <div style="width:100%;  color:red; text-align:right;" *ngIf="p.cantidadMaxima - p.cantidad > 1 && p.cantidadMaxima - p.cantidad < 6">
                                                        Quedarán  {{ p.cantidadMaxima - p.cantidad }}  unidades
                                                    </div>
                                                </div>
                                            </div>

                                            <!---- Sección de cuentas por cobrar de producto-->
                                            <div *ngIf="p.esCuentaPagar" style="width:100%; display: flex;">
                                                <div style="width:25%;">
                                                    <input id="Text6" class="form-control borderAzul" [(ngModel)]="p.nombrePersonal" style="width: 95%; height: 100%;" [disabled]="true"/>
                                                </div>

                                                <div style="width:25%;">
                                                    <input id="Text7" class="form-control borderAzul" [(ngModel)]="p.nombrePresentacion" style="width: 95%; height: 100%;" [disabled]="true"/>
                                                </div>

                                                <div style="width:10%;">
                                                    <input id="Text9" class="form-control borderAzul" [(ngModel)]="p.cantidad" style="width: 95%; height: 100%;" [disabled]="true"/>
                                                </div>

                                                <div style="width:15%;">
                                                    <input id="Text10" class="form-control borderAzul" [(ngModel)]="p.iva" style="width: 95%; height: 100%;" [disabled]="true"/>
                                                </div>

                                                <div style="width:15%;">
                                                    <input id="Text8" class="form-control borderAzul" value="{{p.costoElegido | currency}}" style="width: 100%; height: 100%;" [disabled]="true"/>
                                                </div>

                                                <div style="width:5%; text-align:center;">
                                                    
                                                </div>
                                                <div style="width:5%; text-align:center;">
                                                    <mat-icon svgIcon="iconCruzCuadrado" class="iconosBookipp ms-2 cursorPointer" (click)="caja_venta_productos_removerProducto($index)" style="width: 24px; display: inline-table;"></mat-icon>
                                                </div>
                                            </div>

                                            <div style="margin-top: 10px !important; width: 95%; text-align: center;">
                                                <hr style="background-color: #357EC1; height: 1px;">
                                            </div>

                                        </div>
                                    </div>
                                </div>

                                <!--Lista de cargos -->
                                <div class="col-lg-12">
                                    <div id="Div1" style="width:100%; font-size: 15px; margin-bottom: 15px;">
                                        <b> Cargos </b>
                                        <mat-icon svgIcon="iconAgregar" class="iconosBookipp ms-2 cursorPointer" (click)="caja_venta_cargos_agregarCargo()" style="width: 24px; display: inline-table;"></mat-icon>
                                    </div>

                                    <div id="Div7" style="display:inline-block; width:100%">
                                        <div *ngIf="caja.venta.cargos.listaCargosPorCobrar.length != 0" style="width: 100%; display: flex; padding-left: 15px; padding-right: 15px;">
                                            <div style="width: 70%;"> Cargo </div>
                                            <div style="width: 20%; text-align: center;">{{'configurarTicketTranslate.total' | translate}}</div>
                                        </div>
                                        <div *ngFor="let c of caja.venta.cargos.listaCargosPorCobrar;let $index = index;" style="width:100%; margin-bottom:5px; padding-left: 15px; padding-right: 15px;">

                                            <!---- Sección de venta de cargo en caja-->
                                            <div *ngIf="c.esVenta" style="width:100%;">
                                                <div style="width:100%; display: flex; ">
                                                    <div style="width:70%;">
                                                        <input id="{{'cargosInputDescripcion'+$index}}" class="form-control borderAzul" [(ngModel)]="c.descripcion" style="width: 95%; height: 100%;"/>
                                                    </div>
                                                    <div style="width: 20%; display: flex;">
                                                        <div class="divider"></div>
                                                            <label class="payment-company-currency">$</label>
                                                        <input id="Text13" maxlength="50" placeholder="" [(ngModel)]="c.costoElegido" class="form-control borderAzul" 
                                                            (input)="caja_venta_cargos_cambioCosto(c)"
                                                            (blur)="caja_venta_cargos_prevenirCostoVacio(c)"
                                                            style="cursor: auto; width: 100%; height: 34px;" uiCurrency/>
                                                    </div>
                                                    <div style="width:5%; text-align:center;">
                                                        
                                                    </div>
                                                    <div style="width:5%; text-align:center;">
                                                        <mat-icon svgIcon="iconCruzCuadrado" class="iconosBookipp ms-2 cursorPointer" (click)="caja_venta_cargos_removerCargo($index)" *ngIf="c.esVenta" style="width: 24px; display: inline-table;"></mat-icon>
                                                        <!-- <img (click)="caja_venta_cargos_removerCargo($index)" *ngIf="c.esVenta" class="iconosBookipp ms-2 cursorPointer" src="../../assets/icons/outline/outline-cross-round.svg" style="width: 24px" alt="user" /> -->
                                                    </div>
                                                </div>

                                            </div>

                                            <!---- Sección de cuentas por cobrar de paquete-->
                                            <div *ngIf="c.esCuentaPagar" style="width:100%; display: flex;">

                                                <div style="width:70%;">
                                                    <input id="Text16" class="form-control borderAzul" [(ngModel)]="c.descripcion" style="width: 95%; height: 100%;" [disabled]="true"/>
                                                </div>

                                                <div style="width:20%;">
                                                    <input id="Text17" class="form-control borderAzul" value="{{c.costoElegido | currency}}" style="width: 100%; height: 100%;" [disabled]="true"/>
                                                </div>

                                                <div style="width:5%; text-align:center;">
                                                        
                                                </div>
                                                <div style="width:5%; text-align:center;">
                                                    <img (click)="caja_venta_cargos_removerCargo($index)" class="iconosBookipp ms-2 cursorPointer" src="../../assets/icons/outline/outline-cross-round.svg" style="width: 24px" alt="user" />
                                                </div>
                                            </div>

                                            <div style="margin-top: 10px !important; width: 95%; text-align: center;">
                                                <hr style="background-color: #357EC1; height: 1px;">
                                            </div>
                                        </div>
                                    </div>

                                </div>

                                <!--Lista de certificados de regalo -->
                                <div class="col-lg-12">
                                    <div id="Div24" style="width:100%; font-size: 15px; margin-bottom: 15px;">
                                        <b> Certificados de Regalo </b>
                                        <mat-icon svgIcon="iconAgregar" class="iconosBookipp ms-2 cursorPointer" (click)="caja_venta_certificadoRegalo_agregarCertificados()" style="width: 24px; display: inline-table;"></mat-icon>
                                        <!-- <img (click)="caja_venta_certificadoRegalo_agregarCertificados()" class="iconosBookipp ms-2 cursorPointer" src="../../assets/icons/outline/outline-plus-circle.svg" style="width: 24px" alt="user" /> -->
                                    </div>

                                    <div id="Div25" style="display:inline-block; width:100%">
                                        <div *ngIf="caja.venta.certificadoRegalo.listaCertificadosPorCobrar.length != 0" style="width: 100%; display: flex; padding-left: 15px; padding-right: 15px;">
                                            <div style="width: 30%;"> Personal </div>
                                            <div style="width: 30%;"> Certificado Regalo</div>
                                            <div style="width: 33%; text-align: center;">{{'configurarTicketTranslate.total' | translate}}</div>
                                        </div>
                                        <div *ngFor="let c of caja.venta.certificadoRegalo.listaCertificadosPorCobrar;let $index = index;" style="width:100%; margin-bottom:5px; padding-left: 15px; padding-right: 15px;">

                                            <!---- Sección de venta de producto en caja-->
                                            <div *ngIf="c.esVenta" style="width:100%;">
                                                <div style="width:100%; display: flex; ">
                                                    <div style="width:30%;">
                                                        <!-- <ui-select id="Ui-select3" class="modal-personal campo-modal"
                                                            search-enabled="!mobileBrowser" [(ngModel)]="c.idPersonal"
                                                            theme="select2" style="width: 95%;float:left;">
                                                            <ui-select-match placeholder="{{'agendaTranslate.placeholderPersonal'| translate}}">{{$select.selected.nombre}}</ui-select-match>
                                                            <ui-select-choices repeat="per.idPersonal as per in caja.venta.listadoPersonal | filter: {nombre: $select.search}">
                                                                <span ng-bind-html="per.nombre"></span>
                                                            </ui-select-choices>
                                                        </ui-select> -->
                                                        <ng-select id="Ui-select3" 
                                                                style="width: 95%;" 
                                                                [dropdownPosition]="'bottom'"                                                    
                                                                [multiple]="false" 
                                                                appendTo="#Ui-select3" 
                                                                [searchable]="true"
                                                                [(ngModel)]="c.idPersonal" 
                                                                [clearable]="false"
                                                                placeholder="{{'agendaTranslate.placeholderPersonal'| translate}}"
                                                                [items]="caja.venta.listadoPersonal" 
                                                                bindLabel="nombre" 
                                                                bindValue="idPersonal">
                                                        </ng-select>
                                                    </div>
                                                    <div style="width: 30%;">
                                                        <!-- <ui-select id="{{'certificadoRegaloDDLcertificadoRegalo'+$index}}" search-enabled="true" 
                                                            [(ngModel)]="c.idCertificadoRegalo" ng-change="caja.venta.certificadoRegalo.elegirCertificados(c, $select.selected, $index)"
                                                            theme="select2" style="width: 95%">
                                                            <ui-select-match placeholder="">{{$select.selected.nombre}}</ui-select-match>
                                                            <ui-select-choices repeat="certificado.idCertificadoRegalo as certificado in c.listadoCertificados | filter: $select.search">
                                                                <span ng-bind-html="certificado.nombre"></span>
                                                            </ui-select-choices>
                                                        </ui-select> -->
                                                        <ng-select id="{{'certificadoRegaloDDLcertificadoRegalo'+$index}}" 
                                                                style="width: 95%;" 
                                                                [dropdownPosition]="'bottom'"                                                    
                                                                [multiple]="false" 
                                                                appendTo="#{{'certificadoRegaloDDLcertificadoRegalo'+$index}}" 
                                                                [searchable]="true"
                                                                [(ngModel)]="c.idCertificadoRegalo" 
                                                                [clearable]="false"
                                                                placeholder=""
                                                                [items]="c.listadoCertificados" 
                                                                bindLabel="nombre" 
                                                                bindValue="idCertificadoRegalo"
                                                                (change)="caja_venta_certificadoRegalo_elegirCertificados(c, $event, $index)">
                                                        </ng-select>
                                                    </div>
                                                    
                                                    <div style="width: 35%; display: flex;">
                                                        <div class="divider"></div>
                                                        <label class="payment-company-currency">$</label>
                                                        <input id="{{'certificadoRegaloDDLcertificadoRegaloCosto'+$index}}" maxlength="50" placeholder="" [(ngModel)]="c.costoElegido" class="form-control borderAzul" 
                                                            (input)="caja_venta_certificadoRegalo_cambiarCostoCertificado(c,$index)"
                                                            (blur)="caja_venta_certificadoRegalo_prevenirCostoVacio(c)"
                                                            style="cursor: auto; width: 100%; height: 34px;" [disabled]="!c.idCertificadoRegalo" decimals-only/>
                                                    </div>
                                                    <div style="width:5%; text-align:center;">
                                                        <mat-icon svgIcon="iconCruzCuadrado" class="iconosBookipp ms-2 cursorPointer"(click)="caja_venta_certificadoRegalo_removerCertificado(c,$index)" *ngIf="c.esVenta" style="width: 24px; display: inline-table;"></mat-icon>
                                                    </div>
                                                </div>
                                                    <div style="width:100%; display: flex;">

                                                    <div style="margin-top:5px; width:50%;">
                                                        <div>
                                                            Código
                                                        </div>
                                                        <div style="display:flex; width:100%">
                                                            <input  id="{{'certificadoRegaloDDLcertificadoRegaloCodigo'+$index}}"type="text" class="form-control borderAzul"  [(ngModel)]="c.codigo" (blur)="caja_venta_certificadoRegalo_validarCodigo(c,$index)"/>
                                                            <div class="divider"></div>
                                                        </div>
                                                    </div>
                                                        <div style="margin-top: 5px; width: 50%;">
                                                            <div>
                                                                Vigencia
                                                            </div>
                                                            <div style="display: flex; width: 100%">
                                                                <!-- <input id="{{'certificadoRegaloDDLcertificadoRegaloVigencia'+$index}}" type="text" class="form-control borderAzul" [(ngModel)]="c.vigencia"
                                                                    style="width: 90%" name="date" date-format="dd/MM/yyyy" bs-datepicker content="”body”" ondragstart="return false" autoclose="true" autocomplete="off"
                                                                    onkeypress="javascript:return valFecha(event)" maxlength="10" (blur)="caja.venta.certificadoRegalo.quitarValidacion($index)" /> -->
                                                                <input id="{{'certificadoRegaloDDLcertificadoRegaloVigencia'+$index}}" 
                                                                    style="width: 90%;"
                                                                    class="form-control borderAzul" type="date"
                                                                    required min="01-01-1930"
                                                                    [(ngModel)]="c.vigencia" />
                                                            </div>
                                                        </div>
                                                </div>
                                                
                                                <div style="width:100%;  color:red;" *ngIf="c.idCertificadoRegalo">
                                                    <div style="width:100%;  color:red; text-align:right;" *ngIf="c.cantidadDisponible == 0">
                                                        No quedarán Certificados de Regalo
                                                    </div>
                                                    <div style="width:100%;  color:red; text-align:right;" *ngIf="c.cantidadDisponible == 1">
                                                        Quedará 1 Certificado de Regalo
                                                    </div>
                                                    <div style="width:100%;  color:red; text-align:right;" *ngIf="c.cantidadDisponible > 1 && c.cantidadDisponible < 6">
                                                        Quedarán  {{ c.cantidadDisponible }}  Certificados de Regalo
                                                    </div>
                                                </div>
                                            </div>

                                            <!---- Sección de cuentas por cobrar de certioficado de regalo (Actualmente no esta permitido que se ingrese)-->
                                            <div *ngIf="c.esCuentaPagar" style="width:100%; display: flex;">
                                                <div style="width:25%;">
                                                    <input id="Text24" class="form-control borderAzul" [(ngModel)]="c.nombrePersonal" style="width: 95%; height: 100%;" [disabled]="true"/>
                                                </div>

                                                <div style="width:25%;">
                                                    <input id="Text25" class="form-control borderAzul" [(ngModel)]="c.nombreCertificado" style="width: 95%; height: 100%;" [disabled]="true"/>
                                                </div>

                                                <div style="width:10%;">
                                                    <input id="Text26" class="form-control borderAzul" [(ngModel)]="c.cantidad" style="width: 95%; height: 100%;" [disabled]="true"/>
                                                </div>

                                                <div style="width:15%;">
                                                    <input id="{{'certificadoRegaloDDLcertificadoCostoElegido'+$index}}" class="form-control borderAzul" value="{{c.costoElegido | currency}}" style="width: 100%; height: 100%;" [disabled]="true"/>
                                                </div>

                                                <div style="width:5%; text-align:center;">
                                                    
                                                </div>
                                                <div style="width:5%; text-align:center;">
                                                    <mat-icon svgIcon="iconCruzCuadrado" class="iconosBookipp ms-2 cursorPointer" (click)="caja_venta_certificadoRegalo_removerCertificado(c,$index)" style="width: 24px; display: inline-table;"></mat-icon>
                                                </div>
                                            </div>

                                            <div style="margin-top: 10px !important; width: 95%; text-align: center;">
                                                <hr style="background-color: #357EC1; height: 1px;">
                                            </div>

                                        </div>
                                    </div>

                                </div>

                                <!--Lista de promociones -->
                                <!-- <div class="col-lg-12" *ngIf="caja.venta.promociones.listaPromocionesAplicadas.length != 0"> -->
                                <div class="col-lg-12">
                                    <div id="Div9" style="width:100%; font-size: 15px; margin-bottom: 15px; display: flex;">
                                        <b> Promociones </b>
                                        <mat-icon svgIcon="iconEditar" class="iconosBookipp ms-2 cursorPointer" (click)="caja_venta_promocionesNuevas_abrirModalEdicionPromociones()" style="width: 24px; display: inline-table;"></mat-icon>
                                    </div>

                                    <div id="Div8" style="display:inline-block; width:100%; color: red;">
                                        <div *ngFor="let p of caja.venta.promocionesNuevas.promocionesAplicadas" [hidden]="p.pago < 1" style="width:100%; margin-bottom:5px; padding-left: 15px; padding-right: 15px; display:flex;">
                                            <div style="width:70%;">
                                                {{p.descripcion}}
                                            </div>
                                            <div style="width: 20%; text-align: center;">
                                                    - {{p.pago | currency}}
                                            </div>
                                            <div style="width:5%; text-align:center;">
                                                            
                                            </div>
                                            <div style="width:5%; text-align:center;">
                                                <mat-icon svgIcon="iconCruzCuadrado" class="iconosBookipp ms-2 cursorPointer" (click)="caja_venta_promocionesNuevas_eliminarPromocionAplicada(p.id)" style="width: 24px; display: inline-table;"></mat-icon>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                            </div>

                            <!--Promoción por código y Descuento General-->
                            <div class="col-lg-12" style=" margin-top: 15px;">
                                <div class="row">
                                    <div class="col-lg-6" style=" margin-bottom: 5px; display: flex; margin-top: 25px;">
                                        <div class="row">
                                            <div class="col-lg-6" style="margin: auto;">
                                                <button type="button" class="buttonEstiloBlanco" style="width: 100%; height: 52px;"
                                                    (click)="caja_venta_promocionesNuevas_aplicarPromociones(); caja_venta_calcularTotales()"> 
                                                    Aplicar Código Promoción 
                                                </button>
                                            </div>

                                            <div class="col-lg-6" style="margin: auto;">
                                                <input id="cajaInputCodigoDescuento" [(ngModel)]="caja.venta.promocionesNuevas.codigo" class="form-control borderAzul" style="width: 100%;"/>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-lg-6" style=" display:flex;  margin-bottom: 5px; margin-top: 25px;">
                                        <div class="row">
                                            <div class="col-lg-4" style="margin: auto; min-width: 150px; margin-top:8px; text-align:right;">
                                                Descuento General
                                            </div>
                                            <div class="col-lg-6" style="margin: auto; display: flex; ">
                                                <input class="form-control borderAzul" maxlength="10"
                                                    [(ngModel)]="caja.venta.totales.descuentoP"
                                                    (input)="caja_venta_calcularTotales(1)"
                                                    (click)="caja_venta_quitarCerosTotalDescuento(1)" 
                                                    (blur)="caja_venta_ponerCerosTotalDescuento(1)"
                                                    style="width: 46.75%; text-align:right" decimals-only/>
                                                <label style="margin-top: 8px;">%</label>
                                                <div class="divider"></div>
                                                <label style="margin-top: 8px;">$</label>
                                                <input class="form-control borderAzul" maxlength="10"
                                                    [(ngModel)]="caja.venta.totales.descuentoF"
                                                    (input)="caja_venta_calcularTotales(2)"
                                                    (click)="caja_venta_quitarCerosTotalDescuento(2)" 
                                                    (blur)="caja_venta_ponerCerosTotalDescuento(2)"
                                                    style="width: 46.75%;" decimals-only/>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                
                            </div>

                        </div>

                        <!--Métodos de pago-->
                        <div class="col-lg-9" *ngIf="caja.venta.parte == 2" style="margin-bottom: 10px;">

                            <div style="height: 582px; overflow-y: auto;">
                                <!--Pagos -->
                                <div style="height: 450px; overflow-y: auto;">

                                    <div id="Div10" style="width: 100%; font-size: 15px; margin-bottom: 15px;">
                                        <b>Forma de Pago </b>
                                        <mat-icon svgIcon="iconAgregar" class="iconosBookipp ms-2 cursorPointer" (click)="caja_venta_agregarMetodoDePago()" style="width: 24px; display: inline-table;"></mat-icon>
                                    </div>

                                    <div id="Div12">
                                        <div id="pagar-pagos" style="display: inline-block; width: 100%;">
                                            <div id="metodoPagoDiv-{{$index}}" *ngFor="let mp of caja.venta.metodosDePago;let $index = index;" style="display: flex; margin-bottom: 5px;">

                                                <div style="width: 40%; margin-left: 10px;">
                                                <!-- <ui-select id="{{'DDMetododePagoSelect'+$index}}" class="form-control borderAzul" [(ngModel)]="mp.idMetodoPagoSucursal"
                                                        ng-change="caja.venta.cambiarPagoTerminar(mp,$index, $select.selected)" theme="select2" style="width: 98%;">
                                                    <ui-select-match placeholder="{{'agendaTranslate.placeholderMetodo'| translate}}">{{$select.selected.descripcion}}</ui-select-match>
                                                    <ui-select-choices repeat="dm.idMetodoPagoSucursal as dm in caja.venta.dataMetodoPago">
                                                        <span ng-bind-html="dm.descripcion"></span>
                                                    </ui-select-choices>
                                                </ui-select> -->
                                                    <ng-select id="{{'DDMetododePagoSelect'+$index}}" 
                                                            style="width: 98%;" 
                                                            [dropdownPosition]="'bottom'"                                                    
                                                            [multiple]="false" 
                                                            appendTo="#{{'DDMetododePagoSelect'+$index}}" 
                                                            [searchable]="true"
                                                            [(ngModel)]="mp.idMetodoPagoSucursal" 
                                                            [clearable]="false"
                                                            placeholder="{{'agendaTranslate.placeholderMetodo'| translate}}"
                                                            [items]="caja.venta.dataMetodoPago" 
                                                            bindLabel="descripcion" 
                                                            bindValue="idMetodoPagoSucursal"
                                                            (change)="caja_venta_cambiarPagoTerminar(mp,$index, $event)">
                                                    </ng-select>
                                                    <div class="col-lg-12" style="color: red;"></div>
                                                </div>
                                                
                                                <div style="width: 20%;">
                                                    <div style="display: flex;">
                                                        <div class="divider"></div>
                                                        <label class="payment-company-currency">$</label>
                                                        <input id="camptipocambio2"class="form-control borderAzul" maxlength="10" placeholder="0" [(ngModel)]="mp.monto"
                                                            (blur)="caja_venta_prevenirCobroVacio(mp)" (input)="caja_venta_cambiarCobro(mp,$index)" decimals-only
                                                            style="width: 85% !important;" />
                                                    </div>
                                                </div>

                                                <!-- Tipo de Cambio -->
                                                <div id="TipoCambio" style="width: 20%; display:none">
                                                    <div style="display: flex;" *ngIf="!caja.campoTipoCambio">
                                                        <div class="divider"></div>
                                                        <label class="payment-company-currency">US$</label>
                                                        <input id="camptipocambio" class="form-control borderAzul" maxlength="10" placeholder="0"
                                                            (change)="caja_venta_convertirpesos()" decimals-only [disabled]="true"
                                                            style="width: 85% !important; " />
                                                    </div>
                                                </div>

                                                <div id="Comision" style="width: 20%;">
                                                    <div style="display: flex;" *ngIf="!caja.campoTipoCambio">
                                                        <div class="divider"></div>
                                                        <!--<label class="payment-company-currency">$</label>-->
                                                        <input value="{{ mp.pagoComision | currency }}" style="width: 85% !important;"  type="text" class="form-control borderAzul" [disabled]="true"/>
                                                    </div>
                                                </div>

                                                <div style="width: 15%;">
                                                    <input class="form-control borderAzul" maxlength="100" placeholder="{{'clienteTranslate.nota'| translate}}" [(ngModel)]="mp.digitos" />
                                                </div>
                                                <div style="width: 5%; text-align: center;" *ngIf="mp.idSucursal == null">
                                                    <mat-icon class="iconosBookippStroke ms-2 cursorPointer" svgIcon="iconEditar" (click)="caja_venta_cambiarCodigoCertificadoPagar(mp,$index)" style="width: 24px; display: inline-table;"></mat-icon>
                                                </div>
                                                <div style="width: 5%; text-align: center;" *ngIf="caja.venta.metodosDePago.length > 1">
                                                    <mat-icon class="iconosBookippStroke ms-2 cursorPointer" svgIcon="iconCruzCuadrado" (click)="caja_venta_eliminarMetodoDePago(mp,$index)" style="width: 24px; display: inline-table;"></mat-icon>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!--Propinas -->
                                    <div id="Div15" style="width: 100%; font-size: 15px; margin-bottom: 15px; margin-top: 15px;">
                                        <b>Propinas </b>
                                        <mat-icon svgIcon="iconAgregar" class="iconosBookipp ms-2 cursorPointer" (click)="caja_venta_agregarPropina()" style="width: 24px; display: inline-table;"></mat-icon>
                                    </div>

                                    <div id="Div13" style="padding: 1px;">
                                        <div id="Div14" style="display: inline-block; width: 100%;">
                                            <div id="propina{{$index}}" *ngFor="let p of caja.venta.propinas;let $index = index;" style="margin-bottom: 5px;">

                                                <div style="width: 100%; display: flex; margin-top: 10px;">
                                                    <div style="width: 30%;">
                                                        <!-- <ui-select id="propinaPersonal{{$index}}" class="modal-personal campo-modal"
                                                            search-enabled="!mobileBrowser" [(ngModel)]="p.idPersonal"
                                                            theme="select2" style="width: 98%; float: left;">
                                                            <ui-select-match placeholder="{{'agendaTranslate.placeholderPersonal'| translate}}">{{$select.selected.nombre}}</ui-select-match>
                                                            <ui-select-choices repeat="per.idPersonal as per in caja.venta.listadoPersonal | filter: {nombre: $select.search}">
                                                                <span ng-bind-html="per.nombre"></span>
                                                            </ui-select-choices>
                                                        </ui-select> -->
                                                        <ng-select id="propinaPersonal{{$index}}" 
                                                                style="width: 98%;" 
                                                                [dropdownPosition]="'bottom'"                                                    
                                                                [multiple]="false" 
                                                                appendTo="#propinaPersonal{{$index}}" 
                                                                [searchable]="true"
                                                                [(ngModel)]="p.idPersonal" 
                                                                [clearable]="false"
                                                                placeholder="{{'agendaTranslate.placeholderPersonal'| translate}}"
                                                                [items]="caja.venta.listadoPersonal" 
                                                                bindLabel="nombre" 
                                                                bindValue="idPersonal">
                                                        </ng-select>
                                                    </div>

                                                    <div style="width: 25%;">
                                                        <div style="display: flex; width: 95%">
                                                            <input id="propinaDescuentoP{{$index}}" class="form-control borderAzul" maxlength="10" [(ngModel)]="p.descuentoP"
                                                                (input)="caja_venta_calcularPropina(p, 1)"
                                                                style="width: 46.75%; text-align: right" decimals-only />
                                                            <label style="margin-top: 8px;">%</label>
                                                            <div class="divider"></div>
                                                            <label style="margin-top: 8px;">$</label>
                                                            <input id="propinaDescuentoF{{$index}}" class="form-control borderAzul" maxlength="10" [(ngModel)]="p.descuentoF"
                                                                (input)="caja_venta_calcularPropina(p, 2)"
                                                                style="width: 46.75%;" decimals-only />
                                                        </div>
                                                    </div>

                                                    <div style="width: 20%;">
                                                        <div style="display: flex;">
                                                            <div class="divider" style="width: 2px;"></div>
                                                            <label class="payment-company-currency">$</label>
                                                            <input id="Text14" maxlength="50" currency-mask placeholder="" value="{{ p.total | currency }}" class="form-control borderAzul" style="cursor: auto; width: 95%; height: 34px; padding-left: 8px" disabled />
                                                        </div>
                                                    </div>

                                                    <div style="width: 20%;">
                                                        <div style="display: flex;">
                                                            <div class="divider"></div>
                                                            <label class="payment-company-currency">$</label>
                                                            <input id="Text21" maxlength="50" value="{{ p.propinaComision | currency }}" class="form-control borderAzul" style="cursor: auto; width: 95%; height: 34px; padding-left: 8px" disabled />
                                                        </div>
                                                    </div>

                                                    <div style="width: 5%; text-align: center;">
                                                        <mat-icon class="iconosBookippStroke ms-2 cursorPointer" svgIcon="iconCruzCuadrado" (click)="caja_venta_removerPropina($index)" style="width: 24px; display: inline-table;"></mat-icon>
                                                    </div>
                                                </div>

                                                <div style="width: 100%; display: flex; margin-top: 10px;">
                                                    <div style="width: 30%;">
                                                        <!-- <ui-select id="propinaMetodoPago{{$index}}" [(ngModel)]="p.idMetodoPagoSucursal"
                                                            theme="select2" style="width: 98%; float: left;" ng-change="caja.venta.calcularCambioComisionPropina(p)">
                                                            <ui-select-match placeholder="{{'agendaTranslate.placeholderMetodo'| translate}}">{{$select.selected.descripcion}}</ui-select-match>
                                                            <ui-select-choices repeat="dm.idMetodoPagoSucursal as dm in caja.venta.dataMetodoPagoPropinas">
                                                                <span ng-bind-html="dm.descripcion"></span>
                                                            </ui-select-choices>
                                                        </ui-select> -->
                                                        <ng-select id="propinaMetodoPago{{$index}}" 
                                                                style="width: 98%;" 
                                                                [dropdownPosition]="'bottom'"                                                    
                                                                [multiple]="false" 
                                                                appendTo="#propinaMetodoPago{{$index}}" 
                                                                [searchable]="true"
                                                                [(ngModel)]="p.idMetodoPagoSucursal" 
                                                                [clearable]="false"
                                                                placeholder="{{'agendaTranslate.placeholderMetodo'| translate}}"
                                                                [items]="caja.venta.dataMetodoPagoPropinas" 
                                                                bindLabel="descripcion" 
                                                                bindValue="idMetodoPagoSucursal"
                                                                (change)="caja_venta_calcularCambioComisionPropina(p)">
                                                        </ng-select>
                                                    </div>
                                                </div>
                                                
                                            </div>
                                        </div>

                                    </div>
                                </div>

                                <!--Totales -->
                                <div id="Div11">

                                    <div style="border-top:1px solid #ccc; margin-top:5px;padding-top:10px">
                                        <span style="margin-left:20px"><b> Total Cobrado </b></span>
                                        <span style="float: right; margin-right: 80px"> {{ caja.venta.totales.totalCobro | currency }} </span>
                                    </div>

                                    <div style="margin-top:15px;padding-top:10px">
                                        <span style="margin-left:20px"><b> Cambio de Efectivo </b></span>
                                        <span style="float: right; margin-right: 80px">{{ caja.venta.totales.feriaEfectivo | currency }}</span>
                                    </div>

                                    <div style="margin-top:15px;padding-top:10px; color: red;" *ngIf="(caja.venta.totales.totalCobro < (caja.venta.totales.total - caja.venta.totales.totalDescuentoGeneral)) && caja.venta.consultaMetodosPagoHecha">
                                        * Alguno/s Servicios, Productos, Paquetes o Cargos se irán a cuentas por cobrar porque falta completar ( {{ (caja.venta.totales.total - caja.venta.totales.totalCobro - caja.venta.totales.totalDescuentoGeneral) | currency }} )
                                    </div>
                                </div>
                            </div>
                            <!--Footer-->
                            <div>
                                
                                <div>
                                    <div class="col-lg-3" style=" margin-top: 12px;">
                                        <div class="col-lg-12" style="margin: auto; ">
                                            <button type="button" class="buttonEstiloBlanco" style="width: 100%; height: 40px !important;" (click)="caja_venta_regresarACuentas()"> 
                                                Regresar 
                                            </button>
                                        </div>
                                    </div>
                                    
                                </div>

                            </div>

                        </div>

                        <!--Totales-->
                        <div class="col-lg-3">
                            <div class="row" style="margin: auto;">

                                <div class="col-lg-12" style="border: gray solid 2px; min-height: 555px; font-size: 15px;"> 

                                    <div id="Div23" style="width: 100%; margin-top: 10px;">
                                        <!-- <input id="txtFechaPago" type="text" class="form-control borderAzul" 
                                            [(ngModel)]="caja.venta.fechaPago"
                                            (blur)="caja_venta_prevenirFechaPago()"
                                            style="width: 100%" name="date" date-format="dd/MM/yyyy" bs-datepicker content="”body”" ondragstart="return false" autoclose="true" autocomplete="off"
                                            onkeypress="javascript:return valFecha(event)" maxlength="10" /> -->
                                        <input id="txtFechaPago" class="form-control borderAzul" 
                                            type="date"
                                            style="width: 100%"
                                            required min="01-01-1930"                                             
                                            [(ngModel)]="caja.venta.fechaPago" 
                                            (blur)="caja_venta_prevenirFechaPago()"/>
                                    </div>

                                    <div class="col-lg-12" style="height: 34px; margin-top: 10px; ">
                                        <input id="Text3" class="form-control borderAzul" [(ngModel)]="caja.venta.nombreCliente" [disabled]="true" style="cursor: default !important;"/>
                                    </div>

                                    <div class="col-lg-12" style="min-height: 130px;">
                                        <!-- <div class="row"> -->
                                            <div class="col-lg-12" style="margin-top: 15px; padding:0; text-align: left;">
                                                <b> VENTA </b>
                                            </div>
                                            <div class="col-lg-12" style="margin-top: 20px; padding:0; display: flex;">
                                                <div class="col-lg-7" style="padding:0;">
                                                    Venta:
                                                </div>
                                                <div class="col-lg-5" style="padding:0; text-align: right;">
                                                    {{caja.venta.totales.totalVenta | currency}}
                                                </div>
                                            </div>
                                            <div class="col-lg-12" style="margin-top: 15px; text-align: center;">
                                                <!--<b> PAGO </b>-->
                                            </div>
                                            <div class="col-lg-12" style="margin-top: 20px; padding:0; display: flex;">
                                                <div class="col-lg-7" style="padding:0;">
                                                    Adeudos a Pagar:
                                                </div>
                                                <div class="col-lg-5" style="padding:0; text-align: right;">
                                                    {{caja.venta.totales.totalPago | currency}}
                                                </div>
                                            </div>
                                        <!-- </div> -->
                                    </div>

                                    <div class="col-lg-12" style="height: 230px; border-top: solid black 1px;">
                                        <div class="col-lg-12" style="margin-top: 20px; padding:0; display: flex;">
                                            <div class="col-lg-7" style="padding:0;">
                                                Subtotal:
                                            </div>
                                            <div class="col-lg-5" style="padding:0; text-align: right;">
                                                {{caja.venta.totales.subtotal | currency}}
                                            </div>
                                        </div>
                                        <div class="col-lg-12" style="margin-top: 20px; padding:0; display: flex;">
                                            <div class="col-lg-7" style="padding:0;">
                                                Promocion:
                                            </div>
                                            <div class="col-lg-5" style="padding:0; text-align: right;">
                                                - {{caja.venta.totales.totalPromocion | currency}}
                                            </div>
                                        </div>
                                        <div class="col-lg-12" style="margin-top: 20px; padding:0; display: flex;">
                                            <div class="col-lg-7" style="padding:0;">
                                                Descuento:
                                            </div>
                                            <div class="col-lg-5" style="padding:0; text-align: right;">
                                                - {{caja.venta.totales.totalDescuentoGeneral | currency}}
                                            </div>
                                        </div>
                                        <div class="col-lg-12" style="margin-top: 20px; padding:0; display: flex;">
                                            <div class="col-lg-7" style="padding:0;">
                                                Propina:
                                            </div>
                                            <div class="col-lg-5" style="padding:0; text-align: right;">
                                                {{caja.venta.totales.propina  | currency}}
                                            </div>
                                        </div>
                                        <div class="col-lg-12" style="margin-top: 20px; padding:0; display: flex;">
                                            <div class="col-lg-7" style="padding:0;">
                                                Comisiones:
                                            </div>
                                            <div class="col-lg-5" style="padding:0; text-align: right;">
                                                {{ caja.venta.totales.comisionPropina + caja.venta.totales.comisionCobro | currency}}
                                            </div>
                                        </div>

                                        <div class="col-lg-12" style="margin-top: 20px; padding:0; display: flex; margin-bottom: 15px; font-weight: bold;">
                                            <div class="col-lg-7" style="padding:0;">
                                                Total:
                                            </div>
                                            <div class="col-lg-5" style="padding:0; text-align: right;">
                                                {{  caja.venta.totales.total
                                                    - caja.venta.totales.totalDescuentoGeneral
                                                    + caja.venta.totales.propina 
                                                    + caja.venta.totales.comisionPropina 
                                                    + caja.venta.totales.comisionCobro | currency}}
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-lg-12" style=" margin-top: 27px;">

                                    

                                    <div class="col-lg-12" style=" margin-top: 12px;" *ngIf="caja.venta.parte == 1">
                                        <div class="col-lg-12" style="margin: auto; ">
                                            <button type="button" class="buttonEstiloBlanco" style="width: 100%; height: 40px !important;" (click)="caja_venta_pasarAPagar()"> Pasar a Pagar </button>
                                        </div>
                                    </div>

                                    <div class="col-lg-12" style=" margin-top: 12px;" *ngIf="caja.venta.parte == 2">
                                        <div class="col-lg-12" style="margin: auto; ">
                                            <button type="button" class="buttonEstiloBlanco" style="width: 100%; height: 40px !important;" (click)="caja_venta_pagar()"> Pagar </button>
                                        </div>
                                    </div>

                                    <div id="GuardarCaja" class="col-lg-12" style=" margin-top: 5px;" *ngIf="caja.venta.parte == 1 && !caja.ocultarguardarcaja">
                                        <div class="col-lg-12" style="margin: auto; ">
                                            <button type="button" class="buttonEstiloBlanco" style="width: 100%; height: 24px !important; padding: 0 !important;" (click)="caja_venta_guardarPago()"> 
                                                Guardar 
                                            </button>
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </mat-tab>

            <mat-tab label="Retiro de Efectivo" style="width: 25%;" *ngIf="accesosPantalla.caja.retiroEfectivo == 1">
                <div id="tabRetiro" class="tab-pane" style="padding: 0px 2px;">                    
                    <div class="row">
                        <div class="col-lg-12" style="margin-top: 15px;">                        
                            <div class="row">
                                <div class="col-lg-2"></div>
                                <div class="col-lg-8" style="text-align: center;">
                                    {{this.caja.retiroEfectivo.msgUsuarioRetiro}} - ({{this.caja.retiroEfectivo.date | date:'dd/MM/yyyy hh:mm'}})
                                </div>
                            </div>
                        </div>

                        <div class="col-lg-12" style="margin-top: 25px;">
                            <div class="row">
                                <div class="col-lg-2"></div>
                                <div class="col-lg-2">
                                    Motivo
                                </div>
                                <div class="col-lg-6">
                                    <textarea tabindex="5" id="txtMotivoRetiro" class="form-control borderAzul" maxlength="200"
                                        style="width: 100%; resize: none;" [(ngModel)]="this.caja.retiroEfectivo.motivoRetiro"></textarea>
                                    <div class="col-lg-12" style="color: red;">
        
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Se agrega funcion:OAG(LIS) -->
                        <div class="col-lg-12" style="margin-top: 15px;">
                            <div class="row">
                                <div class="col-lg-2"></div>
                                <div class="col-lg-2">
                                    Monto
                                </div>
                                <div class="col-lg-6">
                                    <input tabindex="5" id="txtMontoRetiro" class="form-control borderAzul" maxlength="10"
                                        type="text" style="width: 100%;" [(ngModel)]="this.caja.retiroEfectivo.montoRetiro" 
                                        (blur)="this.caja_retiroEfectivo_validarMonto()" 
                                        currencyMask [options]="{ allowNegative: false, prefix: '', nullable: true, inputMode: 1 }"
                                        decimals-only> 
                                    <span style="position:relative; right:-11px; top:-27px;">$</span>
                                    <div class="col-lg-12" style="color: red;">
                                        
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-lg-12" style="margin-top: 15px;">
                            <div class="row">
                                <div class="col-lg-2"></div>
                                <div class="col-lg-10" style="margin-top: 10px;">
                                    Autorización
                                </div>
                                <div class="col-lg-2"></div>
                                <div class="col-lg-4" style="margin-top: 10px;">
                                    <div class="col-lg-12" style="padding: 0;">
                                        <input id="txtUsuarioFirmaRetiro" maxlength="100" type="text" placeholder="{{'loginTranslate.usuarioph'| translate}}" [(ngModel)]="this.caja.retiroEfectivo.UsuarioFirma" name="username" class="form-control borderAzul">
                                    </div>
                                    <div class="col-lg-12" style="color: red; padding: 0;">
                                        {{this.caja.retiroEfectivo.msgUsuarioFirmaRetiro}}
                                    </div>
                                </div>
                                <div class="col-lg-4" style="margin-top: 10px;">
                                    <div class="col-lg-12" style="padding: 0;">
                                        <input id="txtContraFirmaRetiro" maxlength="100" type="password" placeholder="{{'loginTranslate.contrasenaph'| translate}}" [(ngModel)]="this.caja.retiroEfectivo.ContraFirma" name="password" class="form-control borderAzul" autocomplete="new-password">
                                    </div>
                                    <div class="col-lg-12" style="color: red; padding: 0;">
                                        {{this.caja.retiroEfectivo.msgContraFirmaRetiro}}
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="Div19" class="col-lg-12" style="margin-top: 15px; text-align: center;">
                            <button id="btnFirmaAutorizacion" class="buttonEstiloBlanco" type="button" (click)="this.caja_retiroEfectivo_FirmaAutorizacion()" style="border: none; cursor: pointer; margin-right: 10px; pointer-events: visible; width: 200px;">
                                <label>Retirar</label>
                                <mat-icon class="iconosBookippStroke ms-2 cursorPointer" svgIcon="iconCheckCirculo" style="width: 24px; display: inline-table;"></mat-icon>
                            </button>
                        </div>
                    </div>

                </div>
            </mat-tab>

            <mat-tab label="Corte de Caja" style="width: 25%;" *ngIf="accesosPantalla.caja.corteCaja == 1">
                <div id="tabCorte" class="tab-pane" style="margin-top: 20px; padding: 0px 2px;">
                    <div class="row">
                        <div class="col-lg-12">
                            <div class="row">
                                <div class="col-lg-6" style="min-height: 34px;">
                                    <div class="row">
                                        <div class="col-lg-4" style="margin-top: 6px; font-size: 15px; display: flex;">
                                            <label> Fecha de Corte </label>
                                        </div>

                                        <div class="col-lg-6">
                                            <!-- <input type="text" class="form-control borderAzul" 
                                                ng-model="this.caja.corte.fechaAltaCorte"
                                                ng-blur="this.caja.corte.prevenirFechaCorte()"
                                                ng-change="this.caja.corte.pasarCorteCaja()"
                                                ng-disabled="this.accesosPantalla.caja.corteCajaDiasAnteriores == 0"
                                                style="width: 90%" name="date" date-format="dd/MM/yyyy" bs-datepicker content="”body”" ondragstart="return false" autoclose="true" autocomplete="off"
                                                onkeypress="javascript:return valFecha(event)" maxlength="10" /> -->
                                            <input id="cajaCNFechaNacimiento" class="form-control borderAzul" 
                                                type="date" required min="01-01-1930" style="width: 90%"
                                                [(ngModel)]="this.caja.corte.fechaAltaCorte"
                                                (blur)="this.caja_corte_prevenirFechaCorte()"
                                                (input)="this.caja_corte_pasarCorteCaja()"
                                                [disabled]="this.accesosPantalla.caja.corteCajaDiasAnteriores == 0" />
                                        </div>
                                    </div>
                                </div>

                                <div class="col-lg-6" style="text-align: right;">
                                    <a class="nwLink2" href="javascript:void(0);" (click)="this.caja_corte_abrirHistorial()" *ngIf="this.accesosPantalla.caja.corteCajaHistorial == 1">
                                        Historial
                                    </a>
                                </div>
                            </div>
                        </div>

                        <div class="col-lg-12" style=" margin-top: 8px;">
                            <div class="row">
                                <div id="cajaTipoCorte" class="col-lg-6" style="min-height: 34px;" *ngIf="this.caja.corte.dataTipoCorte.length != 0 && this.caja.corte.primeraConsultaHecha">
                                    <div class="row">
                                        <div class="col-lg-4" style="margin-top: 6px; font-size: 15px; display: flex;">
                                            <label> Tipo de Corte </label>
                                        </div>

                                        <div class="col-lg-6">
                                            <!-- <ui-select id="ddlTipoCorte" style="width: 90%;" search-enabled="true" theme="select2"  
                                                ng-model="this.caja.corte.tipoCorte" 
                                                (click)="this.resetInfScroll('uiSelectChoicesTipoCorte')" 
                                                ng-change="this.caja.corte.consultaUsuarios()">
                                                <ui-select-match placeholder="Tipo de Corte">
                                                    {{$select.selected.descripcion}}
                                                </ui-select-match>
                                                <ui-select-choices id="uiSelectChoicesTipoCorte" repeat="tipo.idCajaCorteTipo as tipo in this.caja.corte.dataTipoCorte | filter: $select.search | limitTo: this.infiniteScroll.currentItems track by $index"
                                                    infinite-scroll="this.addMoreItems()" infinite-scroll-distance="2" style="z-index: 1;"> 
                                                    <span ng-bind-html="tipo.descripcion"></span>
                                                </ui-select-choices>
                                            </ui-select> -->
                                            <ng-select id="ddlTipoCorte" 
                                                    style="width: 90%;" 
                                                    [dropdownPosition]="'bottom'"                                                    
                                                    [multiple]="false" 
                                                    appendTo="#ddlTipoCorte" 
                                                    [searchable]="true"
                                                    [(ngModel)]="this.caja.corte.tipoCorte" 
                                                    [clearable]="false"
                                                    placeholder="Tipo de Corte"
                                                    [items]="this.caja.corte.dataTipoCorte" 
                                                    bindLabel="descripcion" 
                                                    bindValue="idCajaCorteTipo"
                                                    (change)="this.caja_corte_consultaUsuarios()">
                                            </ng-select>
                                        </div>
                                    </div>
                                </div>

                                <div id="Div22" class="col-lg-6" style="min-height: 34px;" *ngIf="this.caja.corte.dataTipoCorte.length == 0 && this.caja.corte.primeraConsultaHecha">
                                    <div class="row">
                                        <div class="col-lg-12" style="min-height: 34px; color: red;">
                                            Ya sé realizó en el día un Corte de Caja
                                        </div>
                                    </div>
                                </div>

                                <div id="cajaUsuario" class="col-lg-6" style="min-height: 34px;" *ngIf="this.caja.corte.tipoCorte == 1 || this.caja.corte.tipoCorte == 2">
                                    <div class="row">
                                        <div class="col-lg-4" style="margin-top: 6px; font-size: 15px; display: flex; min-width: 100px;">
                                            <label> Usuario </label>
                                        </div>

                                        <div class="col-lg-8">
                                            <!-- <ui-select id="ddlCorteUsuario" style="width: 90%;" search-enabled="true" theme="select2"  
                                                ng-model="this.caja.corte.usuario" 
                                                (click)="this.resetInfScroll('uiSelectChoicesTipoCorte')" 
                                                ng-change="this.caja.corte.consultaMovimientosUsuario()">
                                                <ui-select-match placeholder="Usuario">
                                                    {{$select.selected.nombre}}
                                                </ui-select-match>
                                                <ui-select-choices id="Ui-select-choices1" repeat="u.idUsuarioSucursal as u in this.caja.corte.dataUsuario | filter: $select.search | limitTo: this.infiniteScroll.currentItems track by $index"
                                                    infinite-scroll="this.addMoreItems()" infinite-scroll-distance="2" style="z-index: 1;"> 
                                                    <span ng-bind-html="u.nombre"></span>
                                                </ui-select-choices>
                                            </ui-select> -->
                                            <ng-select id="ddlCorteUsuario" 
                                                    style="width: 90%;" 
                                                    [dropdownPosition]="'bottom'"                                                    
                                                    [multiple]="false" 
                                                    appendTo="#ddlCorteUsuario" 
                                                    [searchable]="true"
                                                    [(ngModel)]="this.caja.corte.usuario" 
                                                    [clearable]="false"
                                                    placeholder="Usuario"
                                                    [items]="this.caja.corte.dataUsuario" 
                                                    bindLabel="nombre" 
                                                    bindValue="idUsuarioSucursal"
                                                    (change)="this.caja_corte_consultaMovimientosUsuario()"
                                                    [disabled]="!caja.venta.permitirCambioCliente">
                                            </ng-select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-lg-12" style="margin-top: 10px; ">
                            <div class="row">
                                <div id="Div16" class="col-lg-4" style="height: 580px;">
                                    <div class="row" style="margin:auto">
                                        <div class="col-lg-12" style="height: 580px; border: solid gray 1px;">
                                            <div class="row">
                                                <div class="col-lg-12" style="height: 350px; overflow-y: auto; border-bottom: 1px solid gray;">
                                                    <div class="row">
                                                        <div class="col-lg-12" style="font-size: 15px; margin-top: 10px;">
                                                            Métodos de Pago
                                                        </div>

                                                        <div class="col-lg-12" style=" margin-top: 7px; font-size: 15px;" *ngFor="let mov of this.caja.corte.dataMovimientos;let $index = index;">
                                                            <div class="row">
                                                                <div class="col-lg-4" style="margin-top: 7px;">
                                                                    <label> {{ mov.descripcion }} </label>
                                                                </div>
                                                                <div class="col-lg-8" *ngIf="mov.isEfectivo">
                                                                    <input value="{{ mov.sumaPago - this.caja.corte.totalRetirosEfectivo | currency }}" style="width: 100%;" type="text" class="form-control borderAzul" [disabled]="true" />
                                                                </div>
                                                                <div class="col-lg-8" *ngIf=" !mov.isEfectivo">
                                                                    <input value="{{ mov.sumaPago | currency }}" style="width: 100%;" type="text" class="form-control borderAzul" [disabled]="true" />
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="col-lg-12" style="height: 65px;">
                                                    <div class="row">
                                                        <div class="col-lg-12" style="font-size: 15px; margin-top: 10px;">
                                                            Propinas
                                                        </div>

                                                        <div class="col-lg-12" style=" margin-top: 7px; font-size: 15px;">
                                                            <div class="col-lg-12">
                                                                <input value="{{ this.caja.corte.totalPropinas | currency }}" style="width: 100%;" type="text" class="form-control borderAzul" [disabled]="true" />
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="col-lg-12" style="height: 65px;">
                                                    <div class="row">
                                                        <div class="col-lg-12" style="font-size: 15px; margin-top: 10px;">
                                                            Retiros de Efectivo
                                                        </div>

                                                        <div class="col-lg-12" style=" margin-top: 7px; font-size: 15px;">
                                                            <div class="col-lg-12">
                                                                <input value="{{ this.caja.corte.totalRetirosEfectivo | currency }}" style="width: 100%;" type="text" class="form-control borderAzul" [disabled]="true" />
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="col-lg-12" style="height: 65px;">
                                                    <div class="row">
                                                        <div class="col-lg-12" style="font-size: 15px; margin-top: 10px;">
                                                            Devoluciones
                                                        </div>

                                                        <div class="col-lg-12" style=" margin-top: 7px; font-size: 15px;">
                                                            <div class="col-lg-12">
                                                                <input value="{{ this.caja.corte.totalDevoluciones | currency }}" style="width: 100%;" type="text" class="form-control borderAzul" [disabled]="true" />
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div id="Div17" class="col-lg-4" style="height: 580px;">
                                    <div class="row" style="margin:auto">
                                        <div class="col-lg-12" style="height: 580px; border: solid gray 1px;">
                                            <div class="row">
                                                <div class="col-lg-12" style="font-size: 15px; margin-top: 10px;">
                                                    Ingresos
                                                </div>

                                                <div class="col-lg-12" style=" margin-top: 7px; font-size: 15px;" 
                                                    *ngFor="let me of this.caja.corte.montosEfectivo;let $index = index;">
                                                    <div class="row">
                                                        <div class="col-lg-4" style="margin-top: 7px; text-align: right;">
                                                            <label> {{ me.monto | currency }} </label>
                                                        </div>
                                                        <div class="col-lg-6">
                                                            <input [(ngModel)]="me.cantidad" 
                                                                (click)="this.caja_corte_quitarCerosMontoEfectivo(me)" 
                                                                (input)="this.caja_corte_calcularTotalMontoEfectivo(me)" 
                                                                (blur)="this.caja_corte_ponerCerosMontoEfectivo(me)"
                                                                style="width: 100%;" class="form-control borderAzul" decimals-only/>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="col-lg-12" style="margin-top: 15px; font-size: 15px; display: flex;">
                                                    <div class="col-lg-4">                                                    
                                                    </div>
                                                    <div class="col-lg-6" style="height: 34px; border-top: 1px solid gray; text-align: center; padding-top: 5px;">
                                                        <b> {{ this.caja.corte.totalMontoEfectivo | currency }} </b>
                                                    </div>
                                                </div>

                                                <div class="col-lg-12" style=" margin-top: 7px; font-size: 15px; display: flex;">
                                                    <div class="col-lg-4" style="margin-top: 7px;">
                                                        <label> Total Voucher </label>
                                                    </div>
                                                    <div class="col-lg-6">
                                                        <input id="Text18" [(ngModel)]="this.caja.corte.totalVoucher" 
                                                            (click)="this.caja_corte_quitarCerosTotalVoucher()" 
                                                            (input)="this.caja_corte_validarTotalVoucher()" 
                                                            (blur)="this.caja_corte_ponerCerosTotalVoucher()"
                                                            style="width: 100%;" class="form-control borderAzul" maxlength="40" decimals-only />
                                                    </div>
                                                </div>

                                                <div class="col-lg-12" style="margin-top: 15px; font-size: 15px; display: flex;">
                                                    <div class="col-lg-4">
                                                        <label> Gran Total </label>
                                                    </div>
                                                    <div class="col-lg-6" style="height: 34px; border-top: 1px solid gray; text-align: center; padding-top: 5px;">
                                                        <b> {{ this.caja.corte.totalIngresos | currency }} </b>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div id="Div18" class="col-lg-4" style="height: 580px;">
                                    <div class="row" style="margin:auto">
                                        <div class="col-lg-12" style="height: 580px; border: solid gray 1px;">
                                            <div class="row" style="margin:auto">
                                                <div class="col-lg-12" style="font-size: 15px; margin-top: 10px;">
                                                    Indicadores
                                                </div>

                                                <div class="col-lg-12" style="margin-top: 7px; height: 280px;">
                                                    <div class="row">
                                                        <div class="col-lg-12" style=" margin-top: 7px; font-size: 15px; min-height: 34px; display: flex;">
                                                            <div class="row">
                                                                <div class="col-lg-6" style="margin-top: 7px;">
                                                                    <label style="padding-top: 6px;"> Fondo Caja </label>
                                                                </div>
                                                                <div class="col-lg-5" style="margin-top: 7px;">
                                                                    <!--{{ this.caja.corte.totalFondoCaja | currency }}-->
                                                                    <input maxlength="10" [(ngModel)]="this.caja.corte.totalFondoCaja" class="form-control borderAzul" 
                                                                        (click)="this.caja_corte_quitarCeroFondoCaja()"
                                                                        (input)="this.caja_corte_cambiarFondoCaja()"
                                                                        (blur)="this.caja_corte_prevenirCeroFondoCaja()"
                                                                        [disabled]="!this.caja.corte.considerarFondo"
                                                                        style="cursor: auto; width: 100%; height: 34px;" decimals-only/>
                                                                </div>
                                                                <div class="col-lg-1" style="margin-top: 7px;">
                                                                    <input style="margin-top: 10px;" type="checkbox" [(ngModel)]="this.caja.corte.considerarFondo" (change)="this.caja_corte_cambiarConsideracionFondoCaja()">
                                                                </div>
                                                            </div>
                                                        </div>

                                                        <div class="col-lg-12" style=" margin-top: 7px; font-size: 15px; min-height: 34px;">
                                                            <div class="row">
                                                                <div class="col-lg-6" style="margin-top: 7px;">
                                                                    <a class="nwLink2" href="javascript:void(0);" (click)="this.caja_corte_abrirModalCortePromociones()">
                                                                        Promociones
                                                                    </a>
                                                                </div>
                                                                <div class="col-lg-6" style="margin-top: 7px;">
                                                                    {{ this.caja.corte.totalPromociones | currency }}
                                                                </div>
                                                            </div>
                                                        </div>

                                                        <div class="col-lg-12" style=" margin-top: 7px; font-size: 15px; min-height: 34px;">
                                                            <div class="row">
                                                                <div class="col-lg-6" style="margin-top: 7px;">
                                                                    <label> Diferencia en Caja </label>
                                                                </div>
                                                                <div class="col-lg-6" style="margin-top: 7px;">
                                                                    {{ this.caja.corte.totalDiferenciaCaja | currency }}
                                                                </div>
                                                            </div>
                                                        </div>

                                                        <div class="col-lg-12" style=" margin-top: 7px; font-size: 15px; min-height: 34px;" *ngIf="this.caja.corte.totalDiferenciaCaja < 0">
                                                            <div class="row">
                                                                <div class="col-lg-12" style="margin-top: 7px;">
                                                                    <!-- <ui-select id="uiSelectCorteTipoAccion" style="width: 100%;" search-enabled="true" theme="select2"  
                                                                        ng-model="this.caja.corte.tipoAccion">
                                                                        <ui-select-match placeholder="Tipo de Acción">
                                                                            {{$select.selected.descripcion}}
                                                                        </ui-select-match>
                                                                        <ui-select-choices id="uiSelectChoicesCorteTipoAccion" repeat="accion.id as accion in this.caja.corte.dataTiposAccion | filter: $select.search | limitTo: this.infiniteScroll.currentItems track by $index"
                                                                            infinite-scroll="this.addMoreItems()" infinite-scroll-distance="2" style="z-index: 1;"> 
                                                                            <span ng-bind-html="accion.descripcion"></span>
                                                                        </ui-select-choices>
                                                                    </ui-select> -->
                                                                    <ng-select id="uiSelectCorteTipoAccion" 
                                                                            style="width: 95%;" 
                                                                            [dropdownPosition]="'bottom'"                                                    
                                                                            [multiple]="false" 
                                                                            appendTo="#uiSelectCorteTipoAccion"
                                                                            [searchable]="true"
                                                                            [(ngModel)]="caja.corte.tipoAccion" 
                                                                            [clearable]="false"
                                                                            placeholder="Tipo de Acción"
                                                                            [items]="caja.corte.dataTiposAccion" 
                                                                            bindLabel="descripcion" 
                                                                            bindValue="id">
                                                                    </ng-select>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="col-lg-12" style="border: gray 1px solid;">
                                                    <div class="row" style="margin: auto;">
                                                        <div class="col-lg-12" style=" margin-top: 7px; font-size: 18px;">
                                                            <div class="row">
                                                                <div class="col-lg-8" style="padding: 1px;">
                                                                    <b> Ingresos: </b>
                                                                </div>
                                                                <div class="col-lg-4" style="padding: 1px;">    
                                                                    <b> {{ this.caja.corte.totalIngresos | currency }} </b>
                                                                </div>
                                                            </div>                                                            
                                                        </div>

                                                        <div class="col-lg-12" style=" margin-top: 7px; font-size: 18px;">
                                                            <div class="row">
                                                                <div class="col-lg-8" style="padding: 1px;">
                                                                    <b> Descuentos: </b>
                                                                </div>
                                                                <div class="col-lg-4" style="padding: 1px;">    
                                                                    <b> {{ this.caja.corte.totalPromociones | currency }} </b>
                                                                </div>
                                                            </div>
                                                        </div>

                                                        <div class="col-lg-12" style=" margin-top: 7px; font-size: 18px; margin-bottom: 7px;">
                                                            <div class="row">
                                                                <div class="col-lg-8" style="padding: 1px;">
                                                                    <b> Faltante: </b>
                                                                </div>
                                                                <div class="col-lg-4" style="padding: 1px;">    
                                                                    <b> {{ this.caja.corte.totalFaltante | currency }} </b>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="col-lg-12" style="margin-top: 10px;">
                                                    <button type="button" class="buttonEstiloBlanco" style="width: 100%; height: 32px;" (click)="this.caja_corte_pasarARealizarCorte()"> Realizar Corte </button>
                                                </div>
                                            </div>    
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </mat-tab>

            <mat-tab label="Movimientos" style="width: 25%;" *ngIf="accesosPantalla.caja.movimientos == 1">
                <div id="tabMovimientos" class="tab-pane" style="margin-top: 20px; padding: 0px 2px;">
                    <div class="row mx-auto mt-3" style="margin: auto;">                        
                        <div class="col-lg-12">
                            <div class="row">
                                <div class="col-lg-8">
                                    <div class="calendario">
                                        <div class="contenedor">
                                            <!-- <i class="glyphicon glyphicon-calendar"></i>
                                            <input id="reportrange" class="pull-left" type="text" readonly="readonly" name="dateRangeMovimientos"
                                                ng-model="this.caja.movimientos.fechas" options="daterangeOptions" on="eventObject" ng-change="this.caja.movimientos.cambioFecha()">
                                            <span class="subcontenedor"><i class=" fa fa-caret-down"></i></span> -->
                                            <i class="fa-solid fa-calendar position-absolute text-white"
                                                style="font-size: 20px !important; position: absolute; margin: 9px 0px 0px 9px; padding-left: 20px; color: white;">
                                            </i>
                                            <mat-icon class="iconosBookipp" svgIcon="iconCalendarioEditar" matListIcon style="position: absolute; margin: 8px 0px 0px 30px;"></mat-icon>
                                            <input type="text"
                                                ngxDaterangepickerMd
                                                class="borderAzul"
                                                style="cursor: pointer; height: 40px; width: 350px; padding-left: 90px; border-radius: 1.5rem;"
                                                [(ngModel)]="caja.movimientos.fechas"
                                                (ngModelChange)="caja_movimientos_cambioFecha()"
                                                [showCustomRangeLabel]="true"
                                                [alwaysShowCalendars]="true"
                                                [ranges]="this.ranges"
                                                [linkedCalendars]="true"
                                                [isInvalidDate] = "isInvalidDate"
                                                [showClearButton]="false"
                                                [locale]="this.locale"
                                                [showDropdowns]="true"
                                            />
                                            <mat-icon class="iconosBookipp" svgIcon="iconFlechaAbajo" matListIcon style="position: absolute; margin: 8px 0px 0px -60px;"></mat-icon>
                                            <!-- <input type="text"
                                                ngxDaterangepickerMd
                                                style="cursor: pointer; height: 40px; width: 350px; padding-left: 90px; color: white; background-color: rgba(8, 99, 119, 0.72); border: #064a59; border-radius: 0.4rem;"
                                                [(ngModel)]="this.caja.movimientos.fechas"
                                                (ngModelChange)="this.caja_movimientos_cambioFecha()"
                                                [showCustomRangeLabel]="true"
                                                [alwaysShowCalendars]="false"
                                                [ranges]="ranges"
                                                [linkedCalendars]="true"
                                                [locale]="{ format: 'DD/MM/YYYY' }"
                                                [isInvalidDate]="isInvalidDate"
                                                [showClearButton]="false"
                                                placeholder="Select please..."
                                                class="inputCalenderSelect"/>
                                            <i class="fa-solid fa-caret-down position-absolute text-white"
                                            style="cursor: pointer; font-size: 17px !important; position: absolute; margin: 10px 0px 0px 9px; left: 315px; color: white;"></i> -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-lg-12" style="margin-top: 15px;">
                            <div class="row">
                                <div class="col-lg-1">
                                </div>
                                <div class="col-lg-10" style="background-color: #777; border-radius: 10px;">
                                    <table style="width: 100%; min-width: 300px; border-radius: 7px;">
                                        <tbody>
                                            <tr class="espacioTabla" style="text-align:center; font-size:medium">
                                                <td style="padding-left: 4px; padding-top: .5em; padding-bottom: .5em;color: #809fff;padding:10px" class="ng-binding">Movimientos</td>
                                                <td style=" padding-right: 4px;color: #85e085;padding:10px" class="td2 ng-binding">Devoluciones</td>
                                                <td style=" padding-right: 4px;color: #ff8080;padding:10px" class="td2 ng-binding">Cancelaciones de Venta</td>
                                                <td style=" padding-right: 4px;color: darkturquoise;padding:10px" class="td2 ng-binding">Cantidad de Retiro de Efectivo</td>
                                                <td style=" padding-right: 4px;color: darkturquoise;padding:10px" class="td2 ng-binding">Monto de Retiro de Efectivo</td>
                                                <td style=" padding-right: 4px;color: #aaff80;padding:10px" class="td2 ng-binding">Total de Ingresos</td>
                                            </tr>

                                            <tr class="espacioTabla" style="text-align:center; font-size:medium">
                                                <td style="padding-left: 4px; padding-top: .5em; padding-bottom: .5em;color: #809fff;padding:10px" class="ng-binding">{{this.caja.movimientos.totalMovimientos}}</td>
                                                <td style=" padding-right: 4px;color: #85e085;padding:10px" class="td2 ng-binding">{{ this.caja.movimientos.devoluciones }}</td>
                                                <td style=" padding-right: 4px;color: #ff8080;padding:10px" class="td2 ng-binding">{{ this.caja.movimientos.canceladas }}</td>
                                                <td style=" padding-right: 4px;color: darkturquoise;padding:10px" class="td2 ng-binding">{{ this.caja.movimientos.retiros }}</td>
                                                <td style=" padding-right: 4px;color: darkturquoise;padding:10px" class="td2 ng-binding">{{ this.caja.movimientos.montosRetiros | currency }}</td>
                                                <td style=" padding-right: 4px;color: #aaff80;padding:10px" class="td2 ng-binding">{{ this.caja.movimientos.totalIngresos | currency }}</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <div class="col-lg-1">
                                </div>
                            </div>
                        </div>

                        <div class="col-lg-12" style="margin-top: 15px;">
                            <div class="row">
                                <div class="col-lg-5">
                                    <!-- <span style="color: #337dc0; position: absolute; margin-left: 13px; margin-top: 5px;">
                                        <i class="glyphicon glyphicon-search" style="color: #337dc0 !important; font-size: 15px !important; z-index: 1"></i>
                                    </span>
                                    <input style="height: 30px; padding-left: 35px; padding-right: initial;" type="text" ng-model="this.caja.movimientos.pruebaNombre" class="form-control borderAzul" ng-change="this.caja.movimientos.busquedaTabla()"
                                        placeholder="{{'consultaClienteTranslate.buscar' | translate}}" /> -->
                                    <mat-icon class="iconosBookipp" svgIcon="iconBuscar" style="font-size: 15px !important; position: absolute; margin: 5px 0px 0px 9px;"></mat-icon>
                                    <!-- <i class="fa-solid fa-magnifying-glass iconosBookipp" style="font-size: 15px !important; position: absolute; margin: 9px 0px 0px 9px;"></i> -->
                                    <input id="inputNombres"class="form-control borderAzul" 
                                        style="height: 100%; padding-left: 35px;" type="text" 
                                        placeholder="{{'consultaClienteTranslate.buscar' | translate}}"
                                        [(ngModel)]="this.caja.movimientos.pruebaNombre" 
                                        (input)="this.caja_movimientos_busquedaTabla()"/>
                                </div>
                                <div class="col-lg-7">
                                    <span (click)="this.caja_movimientos_exportToExcel()" style="color: #337dc0;">
                                        <mat-icon class="iconosBookipp" svgIcon="iconExcel" style="cursor: pointer; float: right; font-size: 26px; overflow: visible;"></mat-icon>
                                        <!-- <img src="./assets/images/system/iconoExcel.png" style="font-size: 30px !important; z-index: 500001; height: 35px;" /> -->
                                    </span>
                                </div>
                            </div>
                        </div>

                        <div id="auux" class="col-lg-12" style="margin-top: 15px;">
                            <!-- <div style="background-color:white; border:solid 1px black; height: 400px;" ui-grid="this.caja.movimientos.gridOptions" class="grid" ui-grid-auto-resize ui-grid-pagination>
                            </div> -->                            
                            <div class="col-lg-12 overflow-auto">
                                <div class="mat-elevation-z8 my-2" style="min-width: 700px;">
                                    <table mat-table [dataSource]="dataSourceMovimientos" matSort style="width: 100%;">   
                                        <ng-container matColumnDef="acciones">
                                            <th mat-header-cell *matHeaderCellDef style="text-align: center;">Acciones</th>
                                            <td mat-cell *matCellDef="let element" style="text-align: center;" style="text-align: center;">
                                                <div *ngIf="element.montoTotalPagoPaypal == 0">
                                                    <!-- Icono Editar -->
                                                    <i *ngIf="element.estado != 0 && element.estado != 3 && element.Cantidad > 0 && element.datoSaldo <=0"
                                                        (click)="caja_movimientos_abrirModalDevolucionProducto(element.datoFolioVenta,element.datoSaldo,undefined)"
                                                        class="fa-solid fa-history"
                                                        style="font-size: 1.2em; cursor:pointer; width:29px;color:#85e085;">
                                                    </i>
                                                    <i *ngIf="element.estado == 0 || element.estado == 3 || element.Cantidad == 0 || element.datoSaldo > 0"                                                    
                                                        class="fa-solid fa-history"
                                                        style="font-size: 1.2em; cursor:pointer; width:29px;color:gainsboro;">
                                                    </i>

                                                    <i *ngIf="element.estado != 0 && element.estado != 3 && element.estado != 4 && element.devolucion <= 0 "
                                                        (click)="caja_movimientos_preparacionCancelarCita(element.datoFolioPago,element.devolucion)"
                                                        class="fa-solid fa-ban"
                                                        style="font-size: 1.2em; cursor:pointer; width:29px;color:#ff8080;">
                                                    </i>
                                                    <i *ngIf="element.estado == 0 || element.estado == 3 || element.estado == 4 || element.devolucion > 0"
                                                        class="fa-solid fa-ban"
                                                        style="font-size: 1.2em; cursor:pointer; width:29px;color:gainsboro;">
                                                    </i>

                                                </div>                                                                                
                                            </td>
                                        </ng-container>
            
                                        <ng-container matColumnDef="datoFecha">
                                            <th mat-header-cell mat-sort-header *matHeaderCellDef style="text-align: center;">Fecha</th>
                                            <td mat-cell *matCellDef="let element" style="text-align: center;">                                                        
                                                {{element.datoFecha  | date : 'dd/MM/yyyy hh:mm a' }}
                                            </td>
                                        </ng-container>

                                        <ng-container matColumnDef="datoFolioVenta">
                                            <th mat-header-cell mat-sort-header *matHeaderCellDef style="text-align: center;">Folio Venta</th>
                                            <td mat-cell *matCellDef="let element" style="text-align: center;">                                                                                                        
                                                <a class="nwLink2"
                                                    href="javascript:void(0);" *ngIf="element.estado == 4"
                                                    (click)="_ticketService.caja_movimientos_mostrarTicketFolioRetiroEfectivo(element.datoFolioVenta)">R-{{element.folioVentaFormato}}</a>
                                                <a class="nwLink2" 
                                                    href="javascript:void(0);" *ngIf="element.estado != 4"
                                                    (click)="_ticketService.caja_movimientos_mostrarTicketFolioVenta(element.datoFolioVenta)">
                                                    {{element.folioVentaFormato}}
                                                </a>
                                            </td>
                                        </ng-container>
                                                    
                                        <ng-container matColumnDef="datoFolioPago">
                                            <th mat-header-cell mat-sort-header *matHeaderCellDef style="text-align: center;">Folio Pago</th>
                                            <td mat-cell *matCellDef="let element" style="text-align: center;">                                                                                                        
                                                <a class="nwLink2"
                                                    href="javascript:void(0);" 
                                                    *ngIf="element.estado != 0 && element.estado != 3 && element.estado != 4"
                                                    (click)="_ticketService.caja_movimientos_mostrarTicketFolioPago(element.datoFolioPago)">
                                                    {{element.folioPagoFormato}}
                                                </a>
                                                <a *ngIf="element.estado == 0  || element.estado == 4">
                                                    {{element.folioPagoFormato}}
                                                </a>
                                                <a class="nwLink2" 
                                                    *ngIf=" element.estado == 3"
                                                    (click)="_ticketService.caja_movimientos_mostrarTicketFolioRetiroEfectivo(element.datoFolioPago)">
                                                </a>
                                            </td>
                                        </ng-container>
                                                    
                                        <ng-container matColumnDef="datoEstatus">
                                            <th mat-header-cell mat-sort-header *matHeaderCellDef style="text-align: center;">Estatus</th>
                                            <td mat-cell *matCellDef="let element" style="text-align: center;">                                                        
                                                {{element.datoEstatus}}
                                            </td>
                                        </ng-container>
                                                    
                                        <ng-container matColumnDef="datoCliente">
                                            <th mat-header-cell mat-sort-header *matHeaderCellDef style="text-align: center;">Cliente</th>
                                            <td mat-cell *matCellDef="let element" style="text-align: center;">                                                        
                                                {{element.datoCliente}}
                                            </td>
                                        </ng-container>
                                                    
                                        <ng-container matColumnDef="datoCargo">
                                            <th mat-header-cell mat-sort-header *matHeaderCellDef style="text-align: center;">Cargo</th>
                                            <td mat-cell *matCellDef="let element">                                                        
                                                {{element.datoCargo | currency}}
                                            </td>
                                        </ng-container>
                                                    
                                        <ng-container matColumnDef="datoAbono">
                                            <th mat-header-cell mat-sort-header *matHeaderCellDef style="text-align: center;">Abono</th>
                                            <td mat-cell *matCellDef="let element">                                                        
                                                {{element.datoAbono | currency}}
                                            </td>
                                        </ng-container>
                                                    
                                        <ng-container matColumnDef="datoSaldo">
                                            <th mat-header-cell mat-sort-header *matHeaderCellDef style="text-align: center;">Saldo</th>
                                            <td mat-cell *matCellDef="let element">                                                        
                                                {{element.datoSaldo | currency}}
                                            </td>
                                        </ng-container>
                                                    
                                        <tr mat-header-row *matHeaderRowDef="displayedColumnsMovimientos"></tr>
                                        <tr mat-row *matRowDef="let row; columns: displayedColumnsMovimientos;" ></tr>
                                    </table>  
                                </div>
                                <mat-paginator 
                                    [pageSizeOptions]="[10, 25, 50, 100, 200, 7676]" 
                                    showFirstLastButtons 
                                    aria-label="Facebook">
                                </mat-paginator>
                            </div>                            

                            <div id="excelTable" [hidden]="true">
                            </div>
                        </div>                        
                    </div>
                </div>
            </mat-tab>            
        </mat-tab-group>
    </mat-card-content>
</mat-card>

<!-----------------------------------------------------------------VENTA ------------------------------------------------------------------>

<!------------------------------------------------ MODAL CERTIFICADO DE REGALO INGRESAR CODIGO ---------------------------------------------->
<div id="mdlCertifidicadoRegaloCodigoIngresar" tabindex="-1" role="dialog" aria-hidden="true" class="modal fade" style="overflow: scroll;">
    <div class="modal-dialog">
        <div class="modal-content" style="margin: 0 auto; font-weight: 400; min-width: 400px; border: 0;">
            <div class="modal-header" style="border-bottom: none;margin: 0px;">
                <span> Certificado de Regalo </span>
                <mat-icon class="iconosBookipp" svgIcon="iconCruzCirculo" data-bs-dismiss="modal" style="cursor: pointer; float: right; font-size: 16px;"></mat-icon>
            </div>        
            <div class="row modal-body">
                <!-- <div class="row"> -->
                    <div class="col-lg-12 form-group">
                        <div class="row" style="margin: 0px;">
                            <div class="col-lg-12" style="padding-bottom: 5px;">
                                <div class="row">
                                    <div class="col-lg-2">
                                    </div>
                                    <div class="col-lg-3">
                                        <label style="font-size: 15px"> Certificado Regalo </label>
                                    </div>
                                    <div class="col-lg-6">
                                        <!-- <ui-select id="Ui-select5" search-enabled="true"
                                            ng-model="this.caja.venta.metodosDePago[this.caja.venta.certificadoRegalo.indexMetodoPagoCR].idCertificadoRegalo"
                                            theme="select2" style="width: 95%">
                                            <ui-select-match placeholder="">{{$select.selected.nombre}}</ui-select-match>
                                            <ui-select-choices repeat="certificadosRegalo.idCertificadoRegalo as certificadosRegalo in this.caja.venta.certificadoRegalo.catalogoCertificadosRegalo | filter: $select.search">
                                                <span ng-bind-html="certificadosRegalo.nombre"></span>
                                            </ui-select-choices>
                                        </ui-select> -->
                                        <ng-select id="Ui-select5" 
                                                style="width: 95%;" 
                                                [dropdownPosition]="'bottom'"                                                    
                                                [multiple]="false" 
                                                appendTo="#Ui-select5" 
                                                [searchable]="true"
                                                [(ngModel)]="caja.venta.metodosDePago[this.caja.venta.certificadoRegalo.indexMetodoPagoCR].idCertificadoRegalo" 
                                                [clearable]="false"
                                                placeholder=""
                                                [items]="caja.venta.certificadoRegalo.catalogoCertificadosRegalo" 
                                                bindLabel="nombre" 
                                                bindValue="idCertificadoRegalo">
                                        </ng-select>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-12" style="padding-bottom: 5px;">
                                <div class="row">
                                    <div class="col-lg-2">
                                    </div>
                                    <div class="col-lg-3">
                                        <label style="font-size: 15px">Código</label>
                                    </div>
                                    <div class="col-lg-6">
                                        <input id="codigoCanjeable" type="text" class="form-control borderAzul" 
                                            [(ngModel)]="this.caja.venta.metodosDePago[this.caja.venta.certificadoRegalo.indexMetodoPagoCR].codigoRegalo" 
                                            [disabled]="!this.caja.venta.metodosDePago[this.caja.venta.certificadoRegalo.indexMetodoPagoCR].idCertificadoRegalo" />
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                <!-- </div> -->
                <!-- <div class="row"> -->
                    <div class="modal-footer">
                        <div class="col-lg-3">
                            <button type="button" class="buttonEstiloBlanco" style="width: 100%; height: 40px !important;" (click)="this.caja_venta_certificadoRegalo_canjearCodigoCertificadoRegalo(this.caja.venta.metodosDePago[this.caja.venta.certificadoRegalo.indexMetodoPagoCR])">Usar </button>
                        </div>
                    </div>
                <!-- </div> -->
            </div>
        </div>
    </div>
</div>

<!------------------------------------ CUENTAS POR COBRAR ------------------------------------>
<div id="modalServiciosCobrar" class="modal fade modalServiciosCobrar" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog" style="max-width: 1200px">
        <div class="modal-content" style="margin: 0 auto; font-weight: 400; width: 100%">
            <div class="modal-header" style="border-bottom: none; margin: 0px;">
                <span class="col-lg-12" style="width: 98%;">Historial de Ventas de Cliente </span>
                <mat-icon class="iconosBookipp" svgIcon="iconCruzCirculo" data-bs-dismiss="modal" style="cursor: pointer; float: right; font-size: 16px;"></mat-icon>
            </div>        
            <div class="row modal-body" >
                <div class="row">
                    <div class="col-lg-12 form-group">
                        <div class="row">
                            <div class="col-lg-7">
                                <div class="calendario">
                                    <div class="contenedor">
                                        <!-- <i class="glyphicon glyphicon-calendar"></i>
                                        <input id="reportrange" class="pull-left" 
                                            type="text" readonly="readonly" name="calendarioClienteHistorial"
                                            ng-model="this.caja.venta.clienteHistorial.fechaCalendario" 
                                            on="eventObject" 
                                            ng-change="this.caja.venta.clienteHistorial.consultaClienteHistorial()">
                                        <span class="subcontenedor"><i class=" fa fa-caret-down"></i></span> -->
                                        <mat-icon class="iconosBookipp" svgIcon="iconCalendarioEditar" style="position: absolute; margin: 8px 0px 0px 30px;"></mat-icon>
                                        <input type="text"
                                            ngxDaterangepickerMd
                                            class="borderAzul"
                                            style="cursor: pointer; height: 40px; width: 350px; padding-left: 90px; border-radius: 1.5rem;"
                                            [(ngModel)]="caja.venta.clienteHistorial.fechaCalendario"
                                            (ngModelChange)="caja_venta_clienteHistorial_consultaClienteHistorial()"
                                            [showCustomRangeLabel]="true"
                                            [alwaysShowCalendars]="true"
                                            [ranges]="this.ranges"
                                            [linkedCalendars]="true"
                                            [isInvalidDate] = "isInvalidDate"
                                            [showClearButton]="false"
                                            [locale]="this.locale"
                                            [showDropdowns]="true"
                                            placeholder="Select please..."
                                        />
                                        <mat-icon class="iconosBookipp" svgIcon="iconFlechaAbajo" matListIcon style="position: absolute; margin: 8px 0px 0px -60px;"></mat-icon>

                                        <!-- <i class="fa-solid fa-calendar position-absolute text-white"
                                            style="font-size: 20px !important; position: absolute; margin: 9px 0px 0px 9px; padding-left: 20px; color: white;">
                                        </i>
                                        <input type="text"
                                            ngxDaterangepickerMd
                                            style="cursor: pointer; height: 40px; width: 350px; padding-left: 90px; color: white; background-color: rgba(8, 99, 119, 0.72); border: #064a59; border-radius: 0.4rem;"
                                            [(ngModel)]="this.caja.venta.clienteHistorial.fechaCalendario"
                                            (ngModelChange)="this.caja_venta_clienteHistorial_consultaClienteHistorial()"
                                            [showCustomRangeLabel]="true"
                                            [alwaysShowCalendars]="false"
                                            [ranges]="ranges"
                                            [linkedCalendars]="true"
                                            [locale]="{ format: 'DD/MM/YYYY' }"
                                            [isInvalidDate]="isInvalidDate"
                                            [showClearButton]="false"
                                            placeholder="Select please..."
                                            class="inputCalenderSelect"/>
                                        <i class="fa-solid fa-caret-down position-absolute text-white"
                                            style="cursor: pointer; font-size: 17px !important; position: absolute; margin: 10px 0px 0px 9px; left: 315px; color: white;"></i> -->
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-5" style="height: 34px; padding: 0;">
                                <input id="Text22" class="form-control borderAzul" [(ngModel)]="this.caja.venta.nombreCliente" [disabled]="true" style="cursor: default !important; width: 95%;"/>
                            </div>
                        </div>
                    </div>
                </div>

                <mat-tab-group id="tabsClienteHistorial" #tabGroup dynamicHeight="true" mat-align-tabs="center" preserveContent="true">
                    <mat-tab id="navCuentasCobrar" label="Cuentas Por Cobrar" style="width: 50%;">
                        <div class="row mx-auto mt-3">
                            <div id="tabCuentasCobrar" class="tab-pane active in">
                                <!-- <div class="col-lg-12" style="padding-bottom: 15px;"> -->
                                    <!-- <div style="background-color: white; border: solid 1px black; height: 315px;" ui-grid="this.caja.venta.clienteHistorial.gridOptionsCuentasPorCobrar" class="grid" ui-grid-auto-resize ui-grid-pagination>
                                    </div> -->
                                <!-- </div> -->
                                <div class="mat-elevation-z8 my-2" style="min-width: 700px;">
                                    <table mat-table [dataSource]="dataSourceCuentasPorCobrar" matSort style="width: 100%;">
                            
                                        <ng-container matColumnDef="tipoCuenta">
                                            <th mat-header-cell mat-sort-header *matHeaderCellDef style="text-align: center;">Tipo</th>
                                            <td mat-cell *matCellDef="let element" style="text-align: center;">                                                        
                                                <div style="margin-top: 6px;"
                                                    *ngIf="element.tipoCuenta == 1 && element.idServicio_idInventarioPresentacion_idPaqueteSucursal != null">
                                                    Servicio </div>
                                                <div style="margin-top: 6px;"
                                                    *ngIf="element.tipoCuenta == 1 && element.idServicio_idInventarioPresentacion_idPaqueteSucursal == null">
                                                    Cargo </div>
                                                <div style="margin-top: 6px;" *ngIf="element.tipoCuenta == 2"> Producto </div>
                                                <div style="margin-top: 6px;" *ngIf="element.tipoCuenta == 3"> Paquete </div>
                                            </td>
                                        </ng-container>
                                                    
                                        <ng-container matColumnDef="folio_caja">
                                            <th mat-header-cell mat-sort-header *matHeaderCellDef style="text-align: center;">Folio de Venta</th>
                                            <td mat-cell *matCellDef="let element" style="text-align: center;">                                                        
                                                {{element.folio_caja}}
                                            </td>
                                        </ng-container>
                                                    
                                        <ng-container matColumnDef="nombreCuenta">
                                            <th mat-header-cell mat-sort-header *matHeaderCellDef style="text-align: center;">Descripcion</th>
                                            <td mat-cell *matCellDef="let element" style="text-align: center;">                                                        
                                                {{element.nombreCuenta}}
                                            </td>
                                        </ng-container>
                                                    
                                        <ng-container matColumnDef="fecha">
                                            <th mat-header-cell mat-sort-header *matHeaderCellDef style="text-align: center;">Fecha</th>
                                            <td mat-cell *matCellDef="let element" style="text-align: center;">                                                        
                                                {{element.fecha | date : 'dd/MM/yyyy hh:mm a' }}
                                            </td>
                                        </ng-container>
                                                    
                                        <ng-container matColumnDef="monto">
                                            <th mat-header-cell mat-sort-header *matHeaderCellDef style="text-align: center;">Monto</th>
                                            <td mat-cell *matCellDef="let element" style="text-align: center;">                                                        
                                                {{element.monto | currency}}
                                            </td>
                                        </ng-container>
                                                    
                                        <ng-container matColumnDef="porPagar">
                                            <th mat-header-cell mat-sort-header *matHeaderCellDef style="text-align: center;">Pagar</th>
                                            <td mat-cell *matCellDef="let element" style="text-align: center;">                                                        
                                                <div class="ui-grid-cell-contents" style="color:#337dc0;"> 
                                                    <input type="checkbox" style="margin-top: 4px;"
                                                        [(ngModel)]="element.porPagar" [disabled]="element.bloqueado" /> 
                                                </div>
                                            </td>
                                        </ng-container>
                                                    
                                        <tr mat-header-row *matHeaderRowDef="displayedColumnsCuentasPorCobrar"></tr>
                                        <tr mat-row *matRowDef="let row; columns: displayedColumnsCuentasPorCobrar;" ></tr>
                            
                                    </table>  
                                </div>
                                <mat-paginator #paginacionCuentasPorCobrar [pageSizeOptions]="[10, 25, 50, 100, 200]" showFirstLastButtons aria-label="Facebook">
                                </mat-paginator>
        
                                <div class="col-lg-12">
                                    <div class="col-lg-2" style="float: none; margin: auto;">
                                        <button type="button" class="buttonEstiloBlanco" (click)="this.caja_venta_clienteHistorial_agregarCuentasPorCobrar()">Agregar </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </mat-tab>

                    <mat-tab id="navClienteHistorial" label="Ventas" style="width: 50%;">
                        <div id="tabClienteHistorial" class="tab-pane">
                            <!-- <div class="col-lg-12" style="padding-bottom: 15px;"> -->
                                <!-- <div style="background-color: white; border: solid 1px black; height: 315px;" ui-grid="this.caja.venta.clienteHistorial.gridOptionsClienteHistorialVentas" class="grid" ui-grid-auto-resize ui-grid-pagination>
                                </div>
                            </div> -->
                            <div class="row mx-auto mt-3">
                                <div class="col-lg-12 overflow-auto" style="padding-bottom: 15px;">
                                    <div class="mat-elevation-z8 my-2" style="min-width: 700px;">
                                        <table mat-table [dataSource]="dataSourceClienteHistorialVentas" matSort style="width: 100%;">
                                                            
                                            <ng-container matColumnDef="acciones">
                                                <th mat-header-cell *matHeaderCellDef style="text-align: center;">Acciones</th>
                                                <td mat-cell *matCellDef="let element" style="text-align: center;" style="text-align: center;">                                                                

                                                    <div class="ui-grid-cell-contents" style="color:#337dc0;">
                                                        <mat-icon class="iconosBookipp ms-2 cursorPointer" svgIcon="iconBasura" 
                                                            *ngIf="this.accesosPantalla.caja.ventaEliminar && element.montoTotalPagoPaypal == 0" 
                                                            (click)="this.caja_venta_clienteHistorial_confirmacionEliminarVenta(element)" style="width: 24px;">
                                                        </mat-icon>
                                                    </div>
                                                        
                                                </td>
                                            </ng-container>
                                
                                            <ng-container matColumnDef="folio_caja">
                                                <th mat-header-cell mat-sort-header *matHeaderCellDef style="text-align: center;">Folio de Venta</th>
                                                <td mat-cell *matCellDef="let element" style="text-align: center;">                                                        
                                                    <a class="nwLink2"
                                                        href="javascript:void(0);"
                                                        (click)="_ticketService.caja_movimientos_mostrarTicketFolioVenta(element.folio_caja_original)">
                                                        {{element.folio_caja}}
                                                    </a>
                                                </td>
                                            </ng-container>
                                                        
                                            <ng-container matColumnDef="fechaPago">
                                                <th mat-header-cell mat-sort-header *matHeaderCellDef style="text-align: center;">Fecha Venta</th>
                                                <td mat-cell *matCellDef="let element" style="text-align: center;">                                                        
                                                    {{element.fechaPago | date : 'dd/MM/yyyy hh:mm a'}}
                                                </td>
                                            </ng-container>
                                                        
                                            <ng-container matColumnDef="montoTotal">
                                                <th mat-header-cell mat-sort-header *matHeaderCellDef style="text-align: center;">Monto</th>
                                                <td mat-cell *matCellDef="let element" style="text-align: center;">                                                        
                                                    {{element.montoTotal | currency}}
                                                </td>
                                            </ng-container>
                                                             
                                            <tr mat-header-row *matHeaderRowDef="displayedColumnsClienteHistorialVentas"></tr>
                                            <tr mat-row *matRowDef="let row; columns: displayedColumnsClienteHistorialVentas;" ></tr>
                                
                                        </table>  
                                    </div>
                                    <mat-paginator #paginacionClienteHistorialVentas [pageSizeOptions]="[10, 25, 50, 100, 200]" showFirstLastButtons aria-label="Facebook">
                                    </mat-paginator>
                                </div>
                            </div>
                        </div>
                    </mat-tab>

                </mat-tab-group>
            </div>
        </div>
    </div>
</div>

<!------------------------------------- MÉTODOS DE PAGO -------------------------------------->
<div id="modalMetodoPago" tabindex="-1" role="dialog" aria-hidden="true" class="modal fade" style="overflow: scroll;">
    <div class="modal-dialog modal-lg" style=" min-width: 1000px;">
        <div class="modal-content" style="margin: 0 auto; font-weight: 400; min-width: 360px; border: 0;">
            <div class="modal-header" style="border-bottom:none;">
                <span>{{'agendaTranslate.metodosPagoMayus'| translate}}</span>
                <mat-icon class="iconosBookipp" svgIcon="iconCruzCirculo" data-bs-dismiss="modal" (click)="this.caja_venta_metodoPago_salirModalMetodoPagos()" style="cursor: pointer; float: right; font-size: 16px;"></mat-icon>
            </div>        
            <div class="row modal-body" >
                <div class="col-lg-12" style="text-align:center;">
                    <!-- <div style="background-color:white; border:solid 1px black; height: 350px;" ui-grid="this.caja.venta.gridMetodosPago" ui-grid-edit class="grid"  ui-grid-auto-resize>
                    </div> -->
                    <div class="mat-elevation-z8 my-2" style="min-width: 700px;">
                        <table mat-table [dataSource]="dataSourceMetodoPago" matSort style="width: 100%;">
                                            
                            <ng-container matColumnDef="acciones">
                                <th mat-header-cell *matHeaderCellDef style="text-align: center;">Acciones</th>
                                <td mat-cell *matCellDef="let element" style="text-align: center;" style="text-align: center;">                
                                    <!-- Icono Editar -->
                                    <!-- <i *ngIf="element.estado != 0 && element.estado != 3 && element.Cantidad > 0 && element.datoSaldo <=0"
                                        (click)="caja_movimientos_abrirModalDevolucionProducto(element.datoFolioVenta,element.datoSaldo,undefined)"
                                        class="fa-solid fa-history"
                                        style="font-size: 1.2em; cursor:pointer; width:29px;color:#85e085;">
                                    </i> -->

                                    <div class="ui-grid-cell-contents" *ngIf="element.descripcion" style="text-align:center; color:#337dc0;">
                                        <mat-icon svgIcon="iconEditar" class="iconosBookipp ms-2 cursorPointer" *ngIf="!this.caja.venta.metodoPago.mostrarActualizarMetodoPago" (click)="this.caja_venta_metodoPago_cargarMetodoPago(element)" style="width: 24px; display: inline-table;"></mat-icon>
                                        <mat-icon svgIcon="iconTiposCambio" class="iconosBookipp ms-2 cursorPointer" (click)="this.caja_venta_metodoPago_metodoEsEfectivo(element)" style="width: 24px; display: inline-table;"></mat-icon>
                                        <mat-icon svgIcon="iconBasura" class="iconosBookipp ms-2 cursorPointer" *ngIf="!element.isEfectivo" (click)="this.caja_venta_metodoPago_preparacionBorrarMetodoPago(element)" style="width: 24px; display: inline-table;"></mat-icon>
                                        <i *ngIf="element.isEfectivo" style="font-size: 1.5em; cursor:pointer; width: 15.33px; display: inline-block;">
                                        </i>
                                    </div>

                                    <div class="ui-grid-cell-contents" *ngIf="!element.descripcion" style="text-align:center; color:#337dc0;">
                                        <div *ngIf="!this.caja.venta.metodoPago.mostrarNuevoMetodoPago && element.nuevo && !this.caja.venta.metodoPago.mostrarActualizarMetodoPago">
                                            <mat-icon svgIcon="iconAgregar" class="iconosBookipp ms-2 cursorPointer" (click)="caja_venta_metodoPago_mostrarAgregar()" style="width: 24px; display: inline-table;"></mat-icon>
                                        </div>
                                        <div *ngIf="this.caja.venta.metodoPago.mostrarActualizarMetodoPago&&!element.nuevo">
                                            <mat-icon svgIcon="iconDeshacer" class="iconosBookipp ms-2 cursorPointer" (click)="caja_venta_metodoPago_cerrarAgregar()" style="width: 24px; display: inline-table;"></mat-icon>
                                            <mat-icon svgIcon="iconGuardar" class="iconosBookipp ms-2 cursorPointer" (click)="caja_venta_metodoPago_actualizarMetodoPago(element)" style="width: 24px; display: inline-table;"></mat-icon>
                                        </div>
                                        <div *ngIf="this.caja.venta.metodoPago.mostrarNuevoMetodoPago">
                                            <mat-icon svgIcon="iconDeshacer" class="iconosBookipp ms-2 cursorPointer" (click)="caja_venta_metodoPago_cerrarAgregar()" style="width: 24px; display: inline-table;"></mat-icon>
                                            <mat-icon svgIcon="iconGuardar" class="iconosBookipp ms-2 cursorPointer" (click)="caja_venta_metodoPago_agregarMetodoPago()" style="width: 24px; display: inline-table;"></mat-icon>
                                        </div>
                                    </div>
                                        
                                </td>
                            </ng-container>
                
                            <ng-container matColumnDef="descripcion">
                                <th mat-header-cell mat-sort-header *matHeaderCellDef style="text-align: center;">Métodos de Pago</th>
                                <td mat-cell *matCellDef="let element" style="text-align: center;">                                                        
                                    <div style="margin-top: 5px;" *ngIf="element.descripcion">
                                        {{element.descripcion}}
                                    </div>
                                    <div style="width: 100%; height:100%;" *ngIf="!element.descripcion">
                                        <div style="margin:2px; width: 100%; height:100%;" *ngIf="this.caja.venta.metodoPago.mostrarActualizarMetodoPago">
                                            <input id="txtDescripcionMetodoPago" *ngIf="!element.nuevo"
                                                [(ngModel)]="this.caja.venta.metodoPago.descripcionMetodoPago"
                                                style="width: 98.5%; height:85%; margin:1px; padding-left: 10px; padding-right: 10px;" type="text"
                                                class="form-control borderAzul" maxlength="100" />
                                        </div>
                                        <div style="margin:2px; width: 100%; height:100%;" *ngIf="this.caja.venta.metodoPago.mostrarNuevoMetodoPago">
                                            <input id="txtDescripcionMetodoPago" [(ngModel)]="this.caja.venta.metodoPago.descripcionMetodoPago"
                                                style="width: 98.5%; height:85%; margin:1px; padding-left: 10px; padding-right: 10px;" type="text"
                                                class="form-control borderAzul" maxlength="100" />
                                        </div>
                                    </div>
                                </td>
                            </ng-container>
                                        
                            <ng-container matColumnDef="comision">
                                <th mat-header-cell mat-sort-header *matHeaderCellDef style="text-align: center;">Comisión Fija</th>
                                <td mat-cell *matCellDef="let element" style="text-align: center;">                                                        
                                    <div style="margin-top: 5px;" *ngIf="element.mostrarComision">
                                        {{element.comision | currency }}
                                    </div>
                                    <div style="width: 100%; height:100%;" *ngIf="!element.mostrarComision">
                                        <div style="margin:2px; width: 100%; height:100%;" *ngIf="this.caja.venta.metodoPago.mostrarActualizarMetodoPago">
                                            <input id="txtComisionMetodoPago" *ngIf="!element.nuevo"
                                                [(ngModel)]="this.caja.venta.metodoPago.comisionMetodoPago"
                                                (input)="this.caja_venta_metodoPago_actualizarComision(1)"
                                                style="width: 95.5%; height:85%; margin:1px; padding-left: 10px; padding-right: 10px;" type="text"
                                                class="form-control borderAzul" maxlength="100" />
                                        </div>
                                        <div style="margin:2px; width: 100%; height:100%;" *ngIf="this.caja.venta.metodoPago.mostrarNuevoMetodoPago">
                                            <input id="txtComisionMetodoPago" [(ngModel)]="this.caja.venta.metodoPago.comisionMetodoPago"
                                                (input)="this.caja_venta_metodoPago_actualizarComision(1)"
                                                style="width: 95.5%; height:85%; margin:1px; padding-left: 10px; padding-right: 10px;" type="text"
                                                class="form-control borderAzul" maxlength="8" decimals-only />
                                        </div>
                                    </div>
                                </td>
                            </ng-container>
                                        
                            <ng-container matColumnDef="comisionPorcentual">
                                <th mat-header-cell mat-sort-header *matHeaderCellDef style="text-align: center;">Comisión Porcentual</th>
                                <td mat-cell *matCellDef="let element" style="text-align: center;">                                                        
                                    <div style="margin-top: 5px;" *ngIf="element.mostrarComision">
                                        {{ element.comisionPorcentual }} %
                                    </div>
                                    <div style="width: 100%; height:100%;" *ngIf="!element.mostrarComision">
                                        <div style="margin:2px; width: 100%; height:100%;" *ngIf="this.caja.venta.metodoPago.mostrarActualizarMetodoPago">
                                            <input id="txtComisionPorcentualMetodoPago" *ngIf="!element.nuevo"
                                                [(ngModel)]="this.caja.venta.metodoPago.comisionPorcentualMetodoPago"
                                                (input)="this.caja_venta_metodoPago_actualizarComision(2)"
                                                style="width: 95.5%; height:85%; margin:1px; padding-left: 10px; padding-right: 10px;" type="text"
                                                class="form-control borderAzul" maxlength="100" />
                                        </div>
                                        <div style="margin:2px; width: 100%; height:100%;" *ngIf="this.caja.venta.metodoPago.mostrarNuevoMetodoPago">
                                            <input id="txtComisionPorcentualMetodoPago" [(ngModel)]="this.caja.venta.metodoPago.comisionPorcentualMetodoPago"
                                                (input)="this.caja_venta_metodoPago_actualizarComision(2)"
                                                style="width: 95.5%; height:85%; margin:1px; padding-left: 10px; padding-right: 10px;" type="text"
                                                class="form-control borderAzul" maxlength="8" decimals-only />
                                        </div>
                                    </div>
                                </td>
                            </ng-container>
                                        
                            <ng-container matColumnDef="efectivo">
                                <th mat-header-cell mat-sort-header *matHeaderCellDef style="text-align: center;">Efectivo</th>
                                <td mat-cell *matCellDef="let element" style="text-align: center;">                                                        
                                    <div style="margin-top: 5px;" *ngIf="element.isEfectivo">
                                        $
                                    </div>
                                </td>
                            </ng-container>
                                        
                            <tr mat-header-row *matHeaderRowDef="displayedColumnsMetodoPago"></tr>
                            <tr mat-row *matRowDef="let row; columns: displayedColumnsMetodoPago;" ></tr>
                
                        </table>  
                    </div>                    
                </div>
                <mat-paginator #paginacionMetodoPago [pageSizeOptions]="[10, 25, 50, 100, 200]" showFirstLastButtons aria-label="Facebook">
                </mat-paginator>
            </div>
        </div>
    </div>
</div>

<div id="borrarMetodoPago" tabindex="-1" role="dialog" aria-hidden="true" class="modal fade" style="overflow: scroll;">
    <div class="modal-dialog modal-lg" style=" min-width: 800px;">
        <div class="modal-content" style="margin: 0 auto; font-weight: 400; min-width: 360px; border: 0;">
            <div class="modal-body">
                {{'agendaTranslate.borrarMetodoPago'| translate}}
            </div>
            
            <div class="modal-footer">
                <div class="col-lg-3">
                    <button type="button" data-bs-dismiss="modal" (click)="modales.borrarMetodoPago.hide();" class="buttonEstiloBlanco">
                        {{'agendaTranslate.cancelar'| translate}}
                    </button>
                </div>
                <div class="col-lg-3">
                    <button type="button" class="buttonEstiloBlanco" (click)="this.caja_venta_metodoPago_borrarMetodoPago()">
                        {{'agendaTranslate.si'| translate}}
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<!------------------------------------- TICKET DE PAGO --------------------------------------->
<div id="ticketPago" aria-hidden="true" class="modal fade" role="dialog">
    <div class="modal-dialog modal-lg" style="min-width: 800px !important;">
        <div class="modal-content" style="margin: 0 auto; font-weight: 400;">
            <div class="modal-header" style="margin: 0px;">
                <span class="col-lg-12" style="width: 98%;">{{'agendaTranslate.reciboCitaMayus'| translate}}</span>
                <mat-icon class="iconosBookipp" svgIcon="iconCruzCirculo" data-bs-dismiss="modal" style="cursor: pointer; float: right; font-size: 16px;"></mat-icon>
            </div>
            <div class="row modal-body">
                <div class="recibo-pago" style="border: 1px solid #bcbcbc; margin: 10px 20px 20px 20px; padding: 15px 20px 20px 20px;">
                    <p style="font-size: 16px; font-weight: 500; border-bottom: 1px dashed #bcbcbc; padding-bottom: 10px;">{{'agendaTranslate.reciboPago'| translate}}</p>

                    <div style="display: inline-block; width: 100%; border-bottom: 1px dashed #bcbcbc; padding-bottom: 10px;">
                        <div style="float: left; width: 100%">
                            <label style="width: 25%;">{{'agendaTranslate.cliente'| translate}}</label>
                            <span style="width: 75%">{{this.caja.venta.ticket.cliente}}</span>
                        </div>
                        <div style="float: left; width: 100%">
                            <label style="width: 25%;"> Folio Pago </label>
                            <span style="width: 75%">{{this.caja.venta.ticket.folio}}</span>
                        </div>
                        <div style="float: left; width: 100%">
                            <label style="width: 25%;">{{'agendaTranslate.fecha'| translate}}</label>
                            <span style="width: 75%">{{this.caja.venta.ticket.fecha}}</span>
                        </div>
                        <div style="float: left; width: 100%" *ngIf="this.caja.venta.ticket.paquetes.length > 0">
                            <label style="width: 26%;">Paquete</label>
                            <span *ngFor="let c of this.caja.venta.ticket.paquetes" style="overflow: hidden; word-break: keep-all; text-overflow: ellipsis; width: 74%; float: right; margin-bottom: 5px">{{c.pago | currency}} - {{c.descripcion}}</span>
                        </div>
                        <div style="float: left; width: 100%" *ngIf="this.caja.venta.ticket.cargos.length > 0">
                            <label style="width: 26%;">{{'agendaTranslate.cargos'| translate}}</label>
                            <span *ngFor="let c of this.caja.venta.ticket.cargos" style="overflow: hidden; white-space: nowrap; text-overflow: ellipsis; width: 74%; float: right; margin-bottom: 5px">{{c.pago | currency}} - {{c.descripcion}}</span>
                        </div>
                        <div style="float: left; width: 100%" *ngIf="this.caja.venta.ticket.productos.length > 0">
                            <label style="width: 26%;">{{'producto.productos'| translate}}</label>
                            <span *ngFor="let p of this.caja.venta.ticket.productos" style="overflow: hidden; white-space: nowrap; text-overflow: ellipsis; width: 74%; float: right; margin-bottom: 5px">{{p.pago | currency}} - {{p.descripcion}}</span>
                        </div>
                            <div style="float: left; width: 100%" *ngIf="this.caja.venta.ticket.certificadosRegalo.length > 0">
                            <label style="width: 26%;">Certificado Reg.</label>
                            <span *ngFor="let cr of this.caja.venta.ticket.certificadosRegalo" style="overflow: hidden; white-space: nowrap; text-overflow: ellipsis; width: 74%; float: right; margin-bottom: 5px">{{cr.pago | currency}} - {{cr.descripcion}}</span>
                        </div>
                        <div style="float: left; width: 100%" *ngIf="this.caja.venta.ticket.descuento.pago">
                            <label style="width: 26%;">{{'agendaTranslate.descuento'| translate}}</label>
                            <span style="width: 74%; float: right; margin-bottom: 5px">-{{this.caja.venta.ticket.descuento.pago * -1 | currency}}</span>
                        </div>
                        <div style="float: left; width: 100%" *ngIf="this.caja.venta.ticket.promocion.length > 0">
                            <label style="width: 26%;">{{'agendaTranslate.promocion'| translate}}</label>
                            <span *ngFor="let p of this.caja.venta.ticket.promocion" style="overflow: hidden; white-space: nowrap; text-overflow: ellipsis; width: 74%; float: right; margin-bottom: 5px">-{{p.pago | currency}} - {{p.descripcion}}</span>
                        </div>
                        <div style="float: left; width: 100%" *ngIf="this.caja.venta.ticket.propina.pago">
                            <label style="width: 26%;">Propina</label>
                            <span style="width: 74%; float: right; margin-bottom: 5px">{{this.caja.venta.ticket.propina.pago | currency}}</span>
                        </div>
                        <div style="float: left; width: 100%" *ngIf="this.caja.venta.ticket.totalDescuento != 0">
                            <label style="width: 26%;"> Descuento </label>
                            <span style="width: 74%; float: right; margin-bottom: 5px">{{this.caja.venta.ticket.totalDescuento | currency}}</span>
                        </div>
                    </div>

                    <div style="margin-top: 10px; border-bottom: 1px dashed #bcbcbc;height: 27px;">
                        <label style="width: 15%; float: left; text-align: right">{{'agendaTranslate.totalMay'| translate}} </label>
                        <span style="margin-left: 30px">{{this.caja.venta.ticket.total | currency}}</span>
                    </div>

                    <div style="margin-top: 10px">
                        <label style="width: 50%;">{{'pagoTranslate.metodoPago'| translate}}</label>
                    </div>

                    <div *ngFor="let mp of this.caja.venta.ticket.metodoPago" style="display: inline-block; width: 100%;">
                        <label style="width:70%;" *ngIf="mp.digitos">{{ mp.descripcion }} ( {{ mp.digitos }} )</label>
                        <label style="width:70%;" *ngIf="!mp.digitos">{{ mp.descripcion }} </label>
                        <span style="width:25%;margin-bottom: 5px">{{ mp.pago | currency }}</span>
                    </div>

                    <div style="margin-top: 10px; border-top: 1px dashed #bcbcbc; padding-top: 10px;">
                        <label style="width: 15%; float: left; text-align: right"> TOTAL PAGADO </label>
                        <span style="margin-left: 30px">{{this.caja.venta.ticket.totalPagado | currency}}</span>
                    </div>

                </div>
                <!--Se agrega Validacion en Agenda de Acuerdo al Estatus de la Factura -->
                <div class="recibo-print">
                    <!--funcion:this.moduloFactura.factura().se cambio-->
                    <a style="float: left; cursor: pointer; line-height: 2.5;" (click)="_facturacionService.validarestatusfactura(this.caja.venta.ticket.idCliente, this.caja.venta.ticket.folio_pago)" disabled="!esPremium" ng-class="{disabled: !esPremium}">{{'agendaTranslate.factura'| translate}}</a>
                    <div style="float: left" class="premium_feature" *ngIf="!esPremium">
                        {{'agendaTranslate.premium'| translate}}
                        <div style="background-color: #092a38; border-radius: 61px; width: 16px; height: 16px; margin-top: 4px; margin-left: 3px;">
                            <i class="fa-solid fa-magnifying-glass" style="font-size: 8px; margin-top: 3px;"></i>
                        </div>
                    </div>

                    <a id="btnImprimirTicket" style="float: right; cursor: pointer; line-height: 2.5;" (click)="_ticketService.imprimir_control_imprimirTicket()">
                        <mat-icon class="iconosBookipp ms-2 cursorPointer" svgIcon="iconArchivo" style="width: 24px; height: auto;"></mat-icon>
                        {{'agendaTranslate.imprimir'| translate}}
                    </a>

                    <a style="float: right; cursor: pointer; line-height: 2.5; margin-right: 10px;" (click)="_ticketService.imprimir_control_mandarCorreoTicket()">
                        <mat-icon class="iconosBookipp ms-2 cursorPointer" svgIcon="iconCorreo" style="width: 24px; height: auto;"></mat-icon>
                        {{'agendaTranslate.reciboEnviarCorreo'| translate}}
                    </a>
    
                </div>
            </div>
        </div>
    </div>
</div>


<!------------------------------------ TICKET DE VENTA --------------------------------------->       
<div id="ticketVenta" aria-hidden="true" class="modal fade" role="dialog">
    <div class="modal-dialog modal-lg" style="min-width: 800px !important;">
        <div class="modal-content" style="margin: 0 auto; font-weight: 400;">
            <div class="modal-header" style="margin: 0px;">
                <span class="col-lg-12" style="width: 98%;"> RECIBO DE VENTA </span>
                <mat-icon class="iconosBookipp" svgIcon="iconCruzCirculo" data-bs-dismiss="modal" style="cursor: pointer; float: right; font-size: 16px;"></mat-icon>
            </div>
            <div class="row modal-body">
                <div class="recibo-pago" style="border: 1px solid #bcbcbc; margin: 10px 20px 20px 20px; padding: 15px 20px 20px 20px;">

                    <p style="font-size: 16px; font-weight: 500; border-bottom: 1px dashed #bcbcbc; padding-bottom: 10px;"> VENTA </p>

                    <div style="display: inline-block; width: 100%; border-bottom: 1px dashed #bcbcbc; padding-bottom: 10px;">
                        <div style="float: left; width: 100%">
                            <label style="width: 25%;">{{'agendaTranslate.cliente'| translate}}</label>
                            <span style="width: 75%">{{this.caja.venta.ticketVenta.cliente}}</span>
                        </div>
                        <div style="float: left; width: 100%">
                            <label style="width: 25%;"> Folio Venta </label>
                            <span style="width: 75%">{{this.caja.venta.ticketVenta.folioVenta}}</span>
                        </div>
                        <div style="float: left; width: 100%">
                            <label style="width: 25%;">{{'agendaTranslate.fecha'| translate}}</label>
                            <span style="width: 75%">{{this.caja.venta.ticketVenta.fecha}}</span>
                        </div>
                        <div style="float: left; width: 100%" *ngIf="this.caja.venta.ticketVenta.paquetes.length > 0">
                            <label style="width: 26%;">Paquete</label>
                            <span *ngFor="let c of this.caja.venta.ticketVenta.paquetes" style="overflow: hidden; word-break: keep-all; text-overflow: ellipsis; width: 74%; float: right; margin-bottom: 5px">{{c.pago | currency}} - {{c.descripcion}}</span>
                        </div>
                        <div style="float: left; width: 100%" *ngIf="this.caja.venta.ticketVenta.cargos.length > 0">
                            <label style="width: 26%;">{{'agendaTranslate.cargos'| translate}}</label>
                            <span *ngFor="let c of this.caja.venta.ticketVenta.cargos" style="overflow: hidden; white-space: nowrap; text-overflow: ellipsis; width: 74%; float: right; margin-bottom: 5px">{{c.pago | currency}} - {{c.descripcion}}</span>
                        </div>
                        <div style="float: left; width: 100%" *ngIf="this.caja.venta.ticketVenta.productos.length >0">
                            <label style="width: 26%;">{{'producto.productos'| translate}}</label>
                            <span *ngFor="let p of this.caja.venta.ticketVenta.productos" style="overflow: hidden; white-space: nowrap; text-overflow: ellipsis; width: 74%; float: right; margin-bottom: 5px">{{p.pago | currency}} - {{p.descripcion}}</span>
                        </div>
                        <div style="float: left; width: 100%" *ngIf="this.caja.venta.ticketVenta.promocion.length">
                            <label style="width: 26%;">{{'agendaTranslate.promocion'| translate}}</label>
                            <span *ngFor="let p of this.caja.venta.ticketVenta.promocion" style="overflow: hidden; white-space: nowrap; text-overflow: ellipsis; width: 74%; float: right; margin-bottom: 5px">-{{p.pago * -1 | currency}} - {{p.descripcion}}</span>
                        </div>

                        <div style="float: left; width: 100%" *ngIf="this.caja.venta.ticketVenta.certificadosRegalo.length >0">
                            <label style="width: 26%;">Certificado Reg.</label>
                            <span *ngFor="let c of this.caja.venta.ticketVenta.certificadosRegalo" style="overflow: hidden; white-space: nowrap; text-overflow: ellipsis; width: 74%; float: right; margin-bottom: 5px">{{c.pago | currency}} - {{c.descripcion}}</span>
                        </div>
                    </div>
                    <div style="display: inline-block; width: 100%; border-bottom: 1px dashed #bcbcbc; padding-bottom: 10px;" *ngIf="this.caja.venta.ticketVenta.descuento != 0">
                        <div style="float: left; width: 100%; margin-top: 5px">
                            <label style="width: 26%;"> Descuento </label>
                            <span style="overflow: hidden; white-space: nowrap; text-overflow: ellipsis; width: 74%; float: right; margin-bottom: 5px"> {{ this.caja.venta.ticketVenta.descuento | currency}} </span>
                        </div>
                    </div>
                    <div style="display: inline-block; width: 100%; border-bottom: 1px dashed #bcbcbc; padding-bottom: 10px; color:red;" *ngIf="this.caja.venta.ticketVenta.devoluciones.length > 0">
                        <div style="float: left; width: 100%">
                            <label style="width: 26%;">Devoluciones</label>
                            <span *ngFor="let d of this.caja.venta.ticketVenta.devoluciones" style="overflow: hidden; white-space: nowrap; text-overflow: ellipsis; width: 74%; float: right; margin-bottom: 5px">-{{d.montoTotal | currency}} - {{d.descripcion}}</span>
                        </div>
                    </div>
                
                </div>
            </div>
        </div>
    </div>
</div>

<!------------------------------ COMFIRMAR ELIMINACION DE VENTA ------------------------------>
<div id="modalConfirmarEliminarVenta" aria-hidden="true" class="modal fade" role="dialog">
    <div class="modal-dialog modal-lg" style="margin-top: 120px;">
        <div class="modal-content">
            <div class="row modal-body">
                <div style="width: 100%;">
                    ¿Estás seguro que deseas eliminar la venta? Se eliminaran los pagos(abonos) relacionados con la venta, así como los Servicios, Paquetes, Productos y Cargos.
                </div>
                <div style="width: 100%; margin-top: 15px;">
                    Sí está seguro, ingrese el motivo:
                </div>
                <div style="width: 100%; margin-top: 10px;">
                    <textarea tabindex="5" id="textAreaMotivoBaja" class="form-control borderAzul" maxlength="500"
                                style="width: 100%; resize: none;" [(ngModel)]="this.caja.venta.clienteHistorial.motivoBaja"></textarea>
                </div>
            </div>
            
            <div class="modal-footer">
                <div class="col-lg-3">
                    <button type="button" data-bs-dismiss="modal" class="buttonEstiloBlanco" (click)="this.caja_venta_clienteHistorial_cancelarEliminacion(); modales.modalConfirmarEliminarVenta.hide();" style="height: auto;">
                        No
                    </button>
                </div>
                <div class="col-lg-3">
                    <button type="button" class="buttonEstiloBlanco" (click)="this.caja_venta_clienteHistorial_eliminarVenta()" style="height: auto;">
                        Aceptar
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<!------------------------------ Modal Promociones 2019 ------------------------------>
<div id="modalPromociones" tabindex="-1" role="dialog" aria-hidden="true" class="modal fade" style="overflow: scroll;">
    <div class="modal-dialog" style="min-width: 800px;">
        <div class="modal-content" style="margin: 0 auto; font-weight: 400; min-width: 360px; border: 0;">
            <div class="modal-header" style="border-bottom: none;">
                <span> Promociones </span>
                <mat-icon class="iconosBookipp" svgIcon="iconCruzCirculo" data-bs-dismiss="modal" style="cursor: pointer; float: right; font-size: 16px;"></mat-icon>
            </div>
            <div class="modal-body" style="height: 400px;">

                <div id="contenedorModalPromociones" class="col-lg-12" style="padding: 0px;">

                    <div id="promocionesPosibles" class="col-lg-12">
                        <div class="col-lg-12" style="color:#428bca; font-weight: bold; padding-left:0px;">
                            Promociones Posibles
                        </div>
                        <div class="col-lg-12" style="margin-top: -20px; margin-bottom: -20px; padding: 0px; height: 20px;">
                            <hr style="background-color: gray; height: 2px; margin-top: 20px;" />
                        </div>
                    </div>
                    
                    <div id="promocionesPosiblesContenedor" class="col-lg-12" style="margin-top: 8px;">
                        <div *ngFor="let p of this.caja.venta.promocionesNuevas.editarPromociones.promocionesPosibles" class="col-lg-12" style="margin-top: 5px;">
                            <div class="col-lg-12" style="padding: 0px;">
                                <div class="col-lg-4">
                                    <div *ngIf="p.idPromocionSucursalNuevaTipo == 1"> Promoción General - {{p.descripcion}} </div>
                                    <div *ngIf="p.idPromocionSucursalNuevaTipo == 2"> Combo - {{p.descripcion}} </div>
                                    <div *ngIf="p.idPromocionSucursalNuevaTipo == 3"> Visita General - {{p.descripcion}} </div>
                                </div>
                                <div class="col-lg-4" style="text-align: center;">
                                    - {{p.pago | currency}}
                                </div>
                                <div class="col-lg-4" style="display: flex;">
                                    <button type="button" class="buttonEstiloBlanco" style="width: 50%; margin: auto auto; height: auto;" (click)="this.caja.venta.promocionesNuevas.aplicarPromocionElegida(p)"> Aplicar </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="promocionesElegidas" class="col-lg-12" style="margin-top: 25px;">
                        <div class="col-lg-12" style="color:#428bca; font-weight: bold; padding-left:0px;">
                            Promociones Elegidas
                        </div>
                        <div class="col-lg-12" style="margin-top: -20px; margin-bottom: -20px; padding: 0px; height: 20px;">
                            <hr style="background-color: gray; height: 2px; margin-top: 20px;" />
                        </div>
                    </div>

                    <div id="promocionesElegidasContenido" class="col-lg-12" style="margin-top: 8px;">
                        <div *ngFor="let p of this.caja.venta.promocionesNuevas.editarPromociones.promocionesAplicadas" class="col-lg-12" style="margin-top: 5px;">
                            <div class="col-lg-12" style="padding: 0px;">
                                <div class="col-lg-4">
                                    {{p.descripcion}}
                                </div>
                                <div class="col-lg-4" style="text-align: center;">
                                    - {{p.pago | currency}}
                                </div>
                                <div class="col-lg-4" style="display: flex;">
                                    <mat-icon svgIcon="iconAgregar" class="iconosBookipp ms-2 cursorPointer" (click)="this.caja_venta_promocionesNuevas_eliminarPromocionElegida(p)" style="width: 24px; display: inline-table;"></mat-icon>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>

            </div>

            <div class="modal-footer">
                <div class="col-lg-9"></div>
                <div class="col-lg-3">
                    <button type="button" class="buttonEstiloBlanco" (click)="caja_venta_promocionesNuevas_aplicarEnVentaPromocionesActivas(undefined)">
                        Aceptar
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>


<!------------------------------------------------------------RETIRO EFECTIVO ------------------------------------------------------------->
<!------------------------------------ TICKET DE RETIRO -------------------------------------->
<div id="ticket-retiro" aria-hidden="true" class="modal fade" role="dialog">
    <div class="modal-dialog modal-lg" style="min-width: 800px !important;">
        <div class="modal-content" style="margin: 0 auto; font-weight: 400;">
            <div class="modal-header" style="margin: 0px;">
                <span class="col-lg-12" style="width: 98%;">TICKET RETIRO EFECTIVO</span>
                <mat-icon class="iconosBookipp" svgIcon="iconCruzCirculo" data-bs-dismiss="modal" style="cursor: pointer; float: right; font-size: 16px;"></mat-icon>
            </div>
            <div class="row modal-body">
                <div class="recibo-pago" style="border: 1px solid #bcbcbc; margin: 10px 20px 20px 20px; padding: 15px 20px 20px 20px;">
                    <p style="font-size: 16px; font-weight: 500; border-bottom: 1px dashed #bcbcbc; padding-bottom: 10px;">Retiro Efectivo</p>
                    <div style="display: inline-block; width: 100%; border-bottom: 1px dashed #bcbcbc; padding-bottom: 10px;">
                        <div style="float: left; width: 100%">
                            <label style="width: 25%;">Usuario </label>
                            <span style="width: 75%">{{this.caja.retiroEfectivo.ticket.Usuario}}</span>
                        </div>
                        <div style="float: left; width: 100%">
                            <label style="width: 25%;">Folio Retiro</label>
                            <span style="width: 75%">{{this.caja.retiroEfectivo.ticket.Folio}}</span>
                        </div>
                        <div style="float: left; width: 100%">
                            <label style="width: 25%;">Fecha</label>
                            <span style="width: 75%">{{this.caja.retiroEfectivo.ticket.Fecha}}</span>
                        </div>
                        <div style="float: left; width: 100%">
                            <label style="width: 26%;">Motivo Retiro</label>
                            <span style="overflow: hidden; white-space: nowrap; text-overflow: ellipsis; width: 74%; float: right; margin-bottom: 5px">{{ this.caja.retiroEfectivo.ticket.motivoRetiro }}</span>
                        </div>
                    </div>
                    <div style="margin-top: 10px; border-bottom: 1px dashed #bcbcbc;height: 27px;">
                        <label style="width: 15%; float: left; text-align: right">TOTAL: </label>
                        <span style="margin-left: 30px">{{this.caja.retiroEfectivo.ticket.Monto | currency }}</span>
                    </div>
                </div>
                <div class="recibo-print">
                    <div style="float: left" class="premium_feature" *ngIf="!esPremium">
                        {{'agendaTranslate.premium'| translate}}
                        <div style="background-color: #092a38; border-radius: 61px; width: 16px; height: 16px; margin-top: 4px; margin-left: 3px;">
                            <i class="glyphicon glyphicon-lock" style="font-size: 8px; margin-top: 3px;"></i>
                        </div>
                    </div>
                    <a id="A1" style="float: right; cursor: pointer; line-height: 2.5; display: flex;"  (click)="_ticketService.imprimir_control_imprimirTicketRetiroEfectivo()">
                        <mat-icon class="iconosBookipp ms-2 cursorPointer" svgIcon="iconCorreo" style="width: 24px; height: auto;"></mat-icon>
                        Imprimir
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<!--------------------------------------------------------------CORTE CAJA ---------------------------------------------------------------->
<!-------------------------------- APARTADO DE PROMOCIONES ----------------------------------->
<div id="modalCortePromociones" tabindex="-1" role="dialog" aria-hidden="true" class="modal fade" style="overflow: scroll;">
    <div class="modal-dialog modal-lg" style=" min-width: 800px;">
        <div class="modal-content" style="margin: 0 auto; font-weight: 400; min-width: 500px; border: 0;">
            <div class="modal-header" style="border-bottom:none;">
                <span class="col-lg-12" style="width: 96%;"> Promociones</span>
                <mat-icon class="iconosBookipp" svgIcon="iconCruzCirculo" data-bs-dismiss="modal" style="cursor: pointer; float: right; font-size: 16px;"></mat-icon>
            </div>        
            <div class="row modal-body">
                <div class="row mx-auto mt-3">
                    <div class="col-lg-12" style="text-align:center; overflow: auto;">
                        <!-- <div style="background-color:white; border:solid 1px black; height: 450px;" ui-grid="this.caja.corte.gridOptionsCortePromociones" class="grid" ui-grid-auto-resize ui-grid-pagination>
                        </div> -->                    
                        <div class="mat-elevation-z8 my-2" style="min-width: 700px;">
                            <table mat-table [dataSource]="dataSourceCortePromociones" matSort style="width: 100%;">
                        
                                <ng-container matColumnDef="folio_caja">
                                    <th mat-header-cell mat-sort-header *matHeaderCellDef style="text-align: center;">Folio</th>
                                    <td mat-cell *matCellDef="let element" style="text-align: center;">                                                        
                                        {{element.folio_caja}}
                                    </td>
                                </ng-container>
                                
                                <ng-container matColumnDef="fechaAlta">
                                    <th mat-header-cell mat-sort-header *matHeaderCellDef style="text-align: center;">Fecha</th>
                                    <td mat-cell *matCellDef="let element" style="text-align: center;">                                                        
                                        {{element.fechaAlta | date: 'dd/MM/yyyy hh:mm a'}}
                                    </td>
                                </ng-container>
                                
                                <ng-container matColumnDef="nombrePersonal">
                                    <th mat-header-cell mat-sort-header *matHeaderCellDef style="text-align: center;">Personal</th>
                                    <td mat-cell *matCellDef="let element" style="text-align: center;">                                                        
                                        {{element.nombrePersonal}}
                                    </td>
                                </ng-container>
                                
                                <ng-container matColumnDef="nombreCliente">
                                    <th mat-header-cell mat-sort-header *matHeaderCellDef style="text-align: center;">Cliente</th>
                                    <td mat-cell *matCellDef="let element" style="text-align: center;">                                                        
                                        {{element.nombreCliente}}
                                    </td>
                                </ng-container>
                                
                                <ng-container matColumnDef="descripcion">
                                    <th mat-header-cell mat-sort-header *matHeaderCellDef style="text-align: center;">Descripcion</th>
                                    <td mat-cell *matCellDef="let element" style="text-align: center;">                                                        
                                        {{element.descripcion}}
                                    </td>
                                </ng-container>
                                
                                <ng-container matColumnDef="total">
                                    <th mat-header-cell mat-sort-header *matHeaderCellDef style="text-align: center;">Total</th>
                                    <td mat-cell *matCellDef="let element" style="text-align: center;">                                                        
                                        {{element.total | currency}}
                                    </td>
                                </ng-container>
                                
                                <ng-container matColumnDef="pago">
                                    <th mat-header-cell mat-sort-header *matHeaderCellDef style="text-align: center;">Pago</th>
                                    <td mat-cell *matCellDef="let element" style="text-align: center;">                                                        
                                        {{element.pago | currency}}
                                    </td>
                                </ng-container>
                                
                                <ng-container matColumnDef="descuento">
                                    <th mat-header-cell mat-sort-header *matHeaderCellDef style="text-align: center;">Descuento</th>
                                    <td mat-cell *matCellDef="let element" style="text-align: center;">                                                        
                                        {{element.descuento | currency}}
                                    </td>
                                </ng-container>
                                
                                <ng-container matColumnDef="promocion">
                                    <th mat-header-cell mat-sort-header *matHeaderCellDef style="text-align: center;">Promoción</th>
                                    <td mat-cell *matCellDef="let element" style="text-align: center;">                                                        
                                        {{element.promocion | currency}}
                                    </td>
                                </ng-container>
                                
                                <tr mat-header-row *matHeaderRowDef="displayedColumnsCortePromociones"></tr>
                                <tr mat-row *matRowDef="let row; columns: displayedColumnsCortePromociones;" ></tr>
                    
                            </table>  
                        </div>
                    </div>
                    <mat-paginator #paginacionCortePromociones [pageSizeOptions]="[10, 25, 50, 100, 200]" showFirstLastButtons aria-label="Facebook">
                    </mat-paginator>
                </div>
            </div>
        </div>
    </div>

</div>

<!------------------------------------- REALIZAR CORTE --------------------------------------->
<div id="modalRealizarCorte" tabindex="-1" role="dialog" aria-hidden="true" class="modal fade" style="overflow: scroll;">
    <div class="modal-dialog modal-lg" style=" min-width: 800px;">
        <div class="modal-content" style="margin: 0 auto; font-weight: 400; min-width: 500px; border: 0;">
            <div class="modal-header" style="border-bottom:none;">
                <span class="col-lg-12" style="width: 98%;"> Corte de Caja </span>
                <mat-icon class="iconosBookipp" svgIcon="iconCruzCirculo" data-bs-dismiss="modal" style="cursor: pointer; float: right; font-size: 16px;"></mat-icon>
            </div>        
            <div class="row modal-body" style="min-height: 500px;">
                <div class="col-lg-12" style="text-align:center;">
                    <div class="row">
                        <div class="col-lg-12">
                            <div class="row">
                                <div class="col-lg-8" style="margin-top: 6px; font-size: 15px; display: flex;">
                                    <label> Tipo de Corte: {{ this.caja.corte.nombreTipoCorte }} ({{ this.caja.corte.fechaCorte | date:'dd / MM / yyyy - hh:mm a' }}) </label>
                                </div>
                            </div>
                        </div>

                        <div class="col-lg-12">
                            <div class="row">
                                <div class="col-lg-8" style="margin-top: 6px; font-size: 15px; display: flex;" *ngIf="this.caja.corte.nombreUsuario">
                                    <label> Usuario: {{ this.caja.corte.nombreUsuario }} </label>
                                </div>
                            </div>
                        </div> 

                        <div class="col-lg-2"></div> 

                        <div class="col-lg-8" style="border: gray 1px solid;">
                            <div class="row">
                                <div class="col-lg-12" style="padding: 0; margin-top: 7px; font-size: 18px; text-align: center;">                                
                                    <div class="row">
                                        <div class="col-lg-6" style="margin-top: 10px;">
                                            <b> Total Movimientos : </b>
                                        </div>
                                        <div class="col-lg-6" style="margin-top: 10px;">
                                            <b> {{ this.caja.corte.totalDataMovimientos | currency }} </b>
                                        </div>       
                                    </div>                                         
                                </div>

                                <div class="col-lg-12" style="padding: 0; margin-top: 7px; font-size: 18px; text-align: center;">                                
                                    <div class="row">
                                        <div class="col-lg-6" style="margin-top: 10px;">
                                            <b> Ingresos : </b>
                                        </div>
                                        <div class="col-lg-6" style="margin-top: 10px;">
                                            <b> {{ this.caja.corte.totalIngresos | currency }} </b>
                                        </div>                                                 
                                    </div>
                                </div>

                                <div class="col-lg-12" style="padding: 0; margin-top: 7px; font-size: 18px; text-align: center;">
                                    <div class="row">
                                        <div class="col-lg-6" style="margin-top: 10px;">
                                            <b> Descuentos : </b>
                                        </div>
                                        <div class="col-lg-6" style="margin-top: 10px;">
                                            <b> {{ this.caja.corte.totalPromociones | currency }} </b>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-lg-12" style="padding: 0; margin-top: 7px; font-size: 18px; text-align: center; margin-bottom: 7px;">
                                    <div class="row">
                                        <div class="col-lg-6" style="margin-top: 10px;">
                                            <b> Faltante : </b>
                                        </div>
                                        <div class="col-lg-6" style="margin-top: 10px;">
                                            <b> {{ this.caja.corte.totalFaltante | currency }} </b>
                                        </div>       
                                    </div>                                          
                                </div>
                            </div>
                        </div>

                        <!--<div class="col-lg-12" style="margin-top: 10px;">
                            <div class="col-lg-4" style="margin-top: 10px;"></div>
                            <div class="col-lg-4" style="margin-top: 10px;">
                                <button type="button" class="btn" style="width: 100%; height: 32px; background-color: #092a38; color: #ffffff;" (click)="this.caja.corte.mostrarFirmaAutorizacion()"> Firma de Autorización </button>
                            </div>
                        </div>-->

                        <div class="col-lg-12" style="margin-top: 10px;">
                            <div class="row">
                                <div class="col-lg-12" style="margin-top: 10px; text-align: left;">
                                    Autorización
                                </div>
                                <div class="col-lg-6" style="margin-top: 10px;">
                                    <input id="corteUsuario" maxlength="100" type="text" placeholder="{{'loginTranslate.usuarioph'| translate}}" [(ngModel)]="this.caja.corte.autorizacionUsuario" name="username" class="form-control borderAzul">
                                </div>
                                <div class="col-lg-6" style="margin-top: 10px;">
                                    <input id="corteContra" maxlength="100" type="password" placeholder="{{'loginTranslate.contrasenaph'| translate}}" [(ngModel)]="this.caja.corte.autorizacionContra" name="password" class="form-control borderAzul" autocomplete="new-password">
                                </div>                                
                            </div>
                        </div>

                        <div class="col-lg-12" style="margin-top: 10px;">
                            <div class="row">
                                <div class="col-lg-4" style="margin-top: 10px;"></div>
                                <div class="col-lg-4" style="margin-top: 10px;">
                                    <button type="button" class="buttonEstiloBlanco" style="width: 100%; height: 32px;" (click)="this.caja_corte_realizarCorte()"> Realizar Corte </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!---------------------------------- HISTORIAL DE CORTES ------------------------------------->
<div id="modalCorteHistorial" tabindex="-1" role="dialog" aria-hidden="true" class="modal fade" style="overflow: scroll;">
    <div class="modal-dialog modal-lg" style=" min-width: 1000px;">
        <div class="modal-content" style="margin: 0 auto; font-weight: 400;  min-width: 400px;  border: 0;">
            <div class="modal-header" style="border-bottom:none;">
                <span class="col-lg-12" style="width: 96%;"> Historial de Cortes de Caja </span>
                <mat-icon class="iconosBookipp" svgIcon="iconCruzCirculo" data-bs-dismiss="modal" style="cursor: pointer; float: right; font-size: 16px;"></mat-icon>
            </div>
            <div class="row modal-body" style="height: 500px;">
                <div class="row">
                    <div class="col-lg-12 form-group">
                        <div class="col-lg-8">
                            <div class="calendario">
                                <!-- <div class="contenedor">
                                    <i class="glyphicon glyphicon-calendar"></i>
                                    <input id="reportrange" class="pull-left" type="text" readonly="readonly" name="calendarioHistorialCorte"
                                        ng-model="this.caja.corte.historial.fechaCalendario" on="eventObject" ng-change="this.caja.corte.consultaHistorial()">
                                    <span class="subcontenedor"><i class=" fa fa-caret-down"></i></span>
                                </div> -->

                                <mat-icon class="iconosBookipp" svgIcon="iconCalendarioEditar" matListIcon style="position: absolute; margin: 8px 0px 0px 30px;"></mat-icon>
                                <input type="text"
                                    ngxDaterangepickerMd
                                    class="borderAzul"
                                    style="cursor: pointer; height: 40px; width: 350px; padding-left: 90px; border-radius: 1.5rem;"
                                    [(ngModel)]="caja.corte.historial.fechaCalendario"
                                    (ngModelChange)="caja_corte_consultaHistorial()"
                                    [showCustomRangeLabel]="true"
                                    [alwaysShowCalendars]="true"
                                    [ranges]="this.ranges"
                                    [linkedCalendars]="true"
                                    [isInvalidDate] = "isInvalidDate"
                                    [showClearButton]="false"
                                    [locale]="this.locale"
                                    [showDropdowns]="true"
                                    placeholder="Select please..."
                                />
                                <mat-icon class="iconosBookipp" svgIcon="iconFlechaAbajo" matListIcon style="position: absolute; margin: 8px 0px 0px -60px;"></mat-icon>

                                <!-- <i class="fa-solid fa-calendar position-absolute text-white"
                                    style="font-size: 20px !important; position: absolute; margin: 9px 0px 0px 9px; padding-left: 20px; color: white;">
                                </i>
                                <input type="text"
                                    ngxDaterangepickerMd
                                    style="cursor: pointer; height: 40px; width: 350px; padding-left: 90px; color: white; background-color: rgba(8, 99, 119, 0.72); border: #064a59; border-radius: 0.4rem;"
                                    [(ngModel)]="this.caja.corte.historial.fechaCalendario"
                                    (ngModelChange)="this.caja_corte_consultaHistorial()"
                                    [showCustomRangeLabel]="true"
                                    [alwaysShowCalendars]="false"
                                    [ranges]="ranges"
                                    [linkedCalendars]="true"
                                    [locale]="{ format: 'DD/MM/YYYY' }"
                                    [isInvalidDate]="isInvalidDate"
                                    [showClearButton]="false"
                                    placeholder="Select please..."
                                    class="inputCalenderSelect"/>
                                <i class="fa-solid fa-caret-down position-absolute text-white"
                                style="cursor: pointer; font-size: 17px !important; position: absolute; margin: 10px 0px 0px 9px; left: 315px; color: white;"></i> -->
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row mx-auto mt-3">
                    <div class="col-lg-12 overflow-auto" style="padding-bottom: 15px;">                    
                        <!-- <div style="background-color:white; border:solid 1px black; height: 385px;" ui-grid="this.caja.corte.gridHistorial" class="grid" ui-grid-auto-resize ui-grid-pagination>
                        </div> -->
                        <div class="mat-elevation-z8 my-2" style="min-width: 700px; max-height: 310px;">
                            <table mat-table [dataSource]="dataSourceCorteHistorial" matSort style="width: 100%;">                    
                    
                                <ng-container matColumnDef="folioTicket">
                                    <th mat-header-cell mat-sort-header *matHeaderCellDef style="text-align: center;">Folio</th>
                                    <td mat-cell *matCellDef="let element" style="text-align: center;">                                                                                            
                                        <a class="nwLink2"
                                            href="javascript:void(0);"
                                            (click)="this.caja_corte_abrirTicketCorte(element.idCajaCorte)">
                                            {{element.folioTicket}}
                                        </a>
                                    </td>
                                </ng-container>
                                
                                <ng-container matColumnDef="nombreCorteTipo">
                                    <th mat-header-cell mat-sort-header *matHeaderCellDef style="text-align: center;">Tipo de Corte</th>
                                    <td mat-cell *matCellDef="let element" style="text-align: center;">                                                        
                                        {{element.nombreCorteTipo}}
                                    </td>
                                </ng-container>
                                
                                <ng-container matColumnDef="nombreCorteAccion">
                                    <th mat-header-cell mat-sort-header *matHeaderCellDef style="text-align: center;">Acción</th>
                                    <td mat-cell *matCellDef="let element" style="text-align: center;">                                                        
                                        {{element.nombreCorteAccion}}
                                    </td>
                                </ng-container>
                                
                                <ng-container matColumnDef="nombreUsuario">
                                    <th mat-header-cell mat-sort-header *matHeaderCellDef style="text-align: center;">Usuario Corte</th>
                                    <td mat-cell *matCellDef="let element" style="text-align: center;">                                                        
                                        {{element.nombreUsuario}}
                                    </td>
                                </ng-container>
                                
                                <ng-container matColumnDef="fechaAlta">
                                    <th mat-header-cell mat-sort-header *matHeaderCellDef style="text-align: center;">Fecha</th>
                                    <td mat-cell *matCellDef="let element" style="text-align: center;">                                                        
                                        {{element.fechaAlta | date: 'dd/MM/yyyy hh:mm a'}}
                                    </td>
                                </ng-container>
                                
                                <ng-container matColumnDef="fondoCaja">
                                    <th mat-header-cell mat-sort-header *matHeaderCellDef style="text-align: center;">Fondo de Caja</th>
                                    <td mat-cell *matCellDef="let element" style="text-align: center;">                                                        
                                        {{element.fondoCaja | currency}}
                                    </td>
                                </ng-container>
                                
                                <ng-container matColumnDef="montoPromociones">
                                    <th mat-header-cell mat-sort-header *matHeaderCellDef style="text-align: center;">Promociones</th>
                                    <td mat-cell *matCellDef="let element" style="text-align: center;">                                                        
                                        {{element.montoPromociones | currency}}
                                    </td>
                                </ng-container>
                                
                                <ng-container matColumnDef="montoDiferencia">
                                    <th mat-header-cell mat-sort-header *matHeaderCellDef style="text-align: center;">Diferencia</th>
                                    <td mat-cell *matCellDef="let element" style="text-align: center;">                                                        
                                        {{element.montoDiferencia | currency}}
                                    </td>
                                </ng-container>
                                
                                <ng-container matColumnDef="totalRetirosEfectivo">
                                    <th mat-header-cell mat-sort-header *matHeaderCellDef style="text-align: center;">Retiros Efectivo</th>
                                    <td mat-cell *matCellDef="let element" style="text-align: center;">                                                        
                                        {{element.totalRetirosEfectivo | currency}}
                                    </td>
                                </ng-container>
                                
                                <ng-container matColumnDef="totalDevoluciones">
                                    <th mat-header-cell mat-sort-header *matHeaderCellDef style="text-align: center;">Devoluciones</th>
                                    <td mat-cell *matCellDef="let element" style="text-align: center;">                                                        
                                        {{element.totalDevoluciones | currency}}
                                    </td>
                                </ng-container>
                                
                                <ng-container matColumnDef="nombreRealizoAlta">
                                    <th mat-header-cell mat-sort-header *matHeaderCellDef style="text-align: center;">Dió de Alta</th>
                                    <td mat-cell *matCellDef="let element" style="text-align: center;">                                                        
                                        {{element.nombreRealizoAlta}}
                                    </td>
                                </ng-container>
                                
                                <ng-container matColumnDef="nombreVerifico">
                                    <th mat-header-cell mat-sort-header *matHeaderCellDef style="text-align: center;">Autorizó</th>
                                    <td mat-cell *matCellDef="let element" style="text-align: center;">                                                        
                                        {{element.nombreVerifico}}
                                    </td>
                                </ng-container>
                                
                                <tr mat-header-row *matHeaderRowDef="displayedColumnsCorteHistorial"></tr>
                                <tr mat-row *matRowDef="let row; columns: displayedColumnsCorteHistorial;" ></tr>
                    
                            </table>  
                        </div>                        
                    </div>
                    <mat-paginator #paginacionCorteHistorial [pageSizeOptions]="[10, 25, 50, 100, 200]" showFirstLastButtons aria-label="Facebook">
                    </mat-paginator>                    
                </div>

            </div>
        </div>
    </div>
</div>

<!------------------------------------ TICKET DE CORTE --------------------------------------->
<div id="ticketCorteCaja" aria-hidden="true" class="modal fade" role="dialog">
    <div class="modal-dialog modal-lg" style="min-width: 800px !important;">
        <div class="modal-content" style="margin: 0 auto; font-weight: 400;">
            <div class="modal-header" style="margin: 0px;">
                <span class="col-lg-12" style="width: 96%;"> RECIBO CORTE CAJA </span>
                <mat-icon class="iconosBookipp" svgIcon="iconCruzCirculo" data-bs-dismiss="modal" style="cursor: pointer; float: right; font-size: 16px;"></mat-icon>
            </div>
            <div class="row modal-body">
                <div class="recibo-pago" style="border: 1px solid #bcbcbc; margin: 10px 20px 20px 20px; padding: 15px 20px 20px 20px;">
                    <p style="font-size: 16px; font-weight: 500; border-bottom: 1px dashed #bcbcbc; padding-bottom: 10px;">{{'agendaTranslate.reciboPago'| translate}}</p>

                    <div style="display: inline-block; width: 100%; border-bottom: 1px dashed #bcbcbc; padding-bottom: 10px;">

                        <div style="float: left; width: 100%">
                            <label style="width: 30%;"> Folio: </label>
                            <span style="width: 70%">{{ this.caja.corte.ticket.corte.folioTicket }}</span>
                        </div>

                        <div style="float: left; width: 100%">
                            <label style="width: 30%;"> Tipo de Corte: </label>
                            <span style="width: 70%">{{ this.caja.corte.ticket.corte.nombreCorteTipo }}</span>
                        </div>

                        <div style="float: left; width: 100%" *ngIf="this.caja.corte.ticket.corte.nombreUsuarioCorte">
                            <label style="width: 30%;"> Usuario Corte: </label>
                            <span style="width: 70%">{{ this.caja.corte.ticket.corte.nombreUsuarioCorte }}</span>
                        </div>

                        <div style="float: left; width: 100%">
                            <label style="width: 30%;"> Fecha: </label>
                            <span style="width: 70%">{{ this.caja.corte.ticket.corte.fechaAlta }}</span>
                        </div>

                        <div style="float: left; width: 100%">
                            <label style="width: 30%;"> Fondo de Caja: </label>
                            <span style="width: 70%">{{ this.caja.corte.ticket.corte.fondoCaja | currency }}</span>
                        </div>

                        <div style="float: left; width: 100%">
                            <label style="width: 30%;"> Promociones / Descuentos: </label>
                            <span style="width: 70%">{{ this.caja.corte.ticket.corte.montoPromociones | currency }}</span>
                        </div>

                        <div style="float: left; width: 100%">
                            <label style="width: 30%;"> Diferencia: </label>
                            <span style="width: 70%">{{ this.caja.corte.ticket.corte.montoDiferencia | currency }}</span>
                        </div>

                        <div style="float: left; width: 100%">
                            <label style="width: 30%;"> Propinas: </label>
                            <span style="width: 70%">{{ this.caja.corte.ticket.corte.totalPropinas | currency }}</span>
                        </div>

                        <div style="float: left; width: 100%">
                            <label style="width: 30%;"> Retiros Efectivo: </label>
                            <span style="width: 70%">{{ this.caja.corte.ticket.corte.totalRetirosEfectivo | currency }}</span>
                        </div>

                        <div style="float: left; width: 100%">
                            <label style="width: 30%;"> Devoluciones: </label>
                            <span style="width: 70%">{{ this.caja.corte.ticket.corte.totalDevoluciones | currency }}</span>
                        </div>

                        <div style="float: left; width: 100%" *ngIf="this.caja.corte.ticket.corte.nombreCorteAccion">
                            <label style="width: 30%;"> Acción: </label>
                            <span style="width: 70%">{{ this.caja.corte.ticket.corte.nombreCorteAccion }}</span>
                        </div>
                        
                        <div style="float: left; width: 100%">
                            <label style="width: 30%;"> Dio Alta: </label>
                            <span style="width: 70%">{{ this.caja.corte.ticket.corte.nombreRealizoAlta }}</span>
                        </div>

                        <div style="float: left; width: 100%">
                            <label style="width: 30%;"> Autorizó:  </label>
                            <span style="width: 70%">{{ this.caja.corte.ticket.corte.nombreUsuarioVerificacion }}</span>
                        </div>

                    </div>

                    <div style="margin-top: 10px">
                        <label style="width: 50%;"> Detalle </label>
                    </div>

                    <div style="border-bottom: 1px dashed #bcbcbc; padding-bottom: 10px;">
                        <div *ngFor="let mp of this.caja.corte.ticket.corte.metodosPago">

                            <label style="width: 100%;" *ngIf="mp.nombreMetodoPago"> {{ mp.nombreMetodoPago }} </label>
                            <label style="width: 100%;" *ngIf="!mp.nombreMetodoPago"> Voucher </label>

                            <label style="width: 60%; margin-left: 10%;"> Monto Ingreso </label>
                            <span style="width:30%;margin-bottom: 5px"> {{ mp.montoIngreso | currency }} </span>

                            <label style="width: 60%; margin-left: 10%;"> Monto Caja </label>
                            <span style="width:30%;margin-bottom: 5px"> {{ mp.montoCaja | currency }} </span>

                        </div>
                    </div>
                    
                    <div style="margin-top: 10px" *ngIf="this.caja.corte.ticket.corte.ingresos.length != 0">
                        <label style="width: 50%;"> Ingresos </label>
                    </div>

                    <div style="border-bottom: 1px dashed #bcbcbc; padding-bottom: 10px;">
                        <div *ngFor="let i of this.caja.corte.ticket.corte.ingresos">

                            <label style="width: 60%; margin-left: 10%;"> {{ i.valor | currency }} </label>
                            <span style="width:30%;margin-bottom: 5px"> {{ i.cantidad }} </span>

                        </div>
                    </div>

                    <div>

                        <div style="margin-top: 5px;">
                            <label style="width: 70%;"> <b> Total Monto Ingreso </b> </label>
                            <span style="width:30%;margin-bottom: 5px"> {{ this.caja.corte.ticket.corte.totalMontoIngresos | currency }} </span>
                        </div>

                        <div style="margin-top: 5px;">
                            <label style="width: 70%;"> <b> Total Monto Caja </b> </label>
                            <span style="width:30%;margin-bottom: 5px"> {{ this.caja.corte.ticket.corte.totalMontoCaja | currency }} </span>
                        </div>

                    </div>

                </div>
                <div class="recibo-print">

                    <a id="A2" style="float: right; cursor: pointer; line-height: 2.5; align-items: center; display: flex;" (click)="mandarDataTicket(1)">
                        <mat-icon class="iconosBookipp ms-2 cursorPointer" svgIcon="iconArchivo" style="width: 24px; height: auto;"></mat-icon>
                        {{'agendaTranslate.imprimir'| translate}}
                    </a>
                    <a id="btnImprimirTicketCorteCaja" style="float: right; cursor: pointer; line-height: 2.5; margin-right: 10px; align-items: center; display: flex;" (click)="mandarDataTicket(2)">
                        <mat-icon class="iconosBookipp ms-2 cursorPointer" svgIcon="iconCorreo" style="width: 24px; height: auto;"></mat-icon>
                        {{'agendaTranslate.reciboEnviarCorreo'| translate}}
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>


<!--------------------------------------------------------------- MOVIMIENTOS --------------------------------------------------------------->
<div id="modalDevoluciones" tabindex="-1" role="dialog" aria-hidden="true" class="modal fade" style="overflow: scroll;">
    <div class="modal-dialog modal-lg" style="min-width:  800px !important;">
        <div class="modal-content" style="margin: 0 auto; font-weight: 400; border: 0;">
            <div class="modal-header" style="height: 60px !important; margin: 0px;">
                <span class="col-lg-12" style="width: 96%;"> Devolución Productos </span>
                <mat-icon class="iconosBookipp" svgIcon="iconCruzCirculo" data-bs-dismiss="modal" style="cursor: pointer; float: right; font-size: 16px;"></mat-icon>
            </div>
            <div class="row modal-body">
                <div id="Div20" class="tab-content" style="border: 0px solid; padding-bottom: 0px">
                    <div class="row" style="padding-left: 30px; padding-right: 30px">
                        <div class="col-lg-12" style="padding: 0;">
                        </div>
                    </div>
                    <!-- <div> -->
                    <div class="row" style="padding-top: 10px;padding-left:5px;padding-right:5px;font-size:15px">
                        <div class="col-lg-3" style="padding: 5px;">
                            <label id="Label2" class="control-label" style="padding-top: 0; text-align: center">
                                Producto
                            </label>
                        </div>
                        <div class="col-lg-1" style="padding: 5px;">
                            <label id="Label3" class="control-label" style="padding-top: 0; text-align: center">Cantidad</label>
                        </div>
                        <div class="col-lg-2" style="padding: 5px;padding-left: 15px;">
                            <label id="Label4" class="control-label" style="padding-top: 0; text-align: center">Precio</label>
                        </div>
                        <div class="col-lg-2" style="padding: 5px;padding-left: 15px;">
                            <label id="Label8" class="control-label" style="padding-top: 0; text-align: center">Monto</label>
                        </div>
                        <div class="col-lg-3" style="padding: 5px;">
                            <label id="Label7" class="control-label" style="padding-top: 0; text-align: center">Tipo</label>
                        </div>
                            <div class="col-lg-1" style="padding: 5px;text-align: center">
                            <label id="Label5" class="control-label" style="padding-top: 0; ">Devolver</label>
                        </div>
                    </div>
                    <div class="row" *ngFor="let productos of this.caja.movimientos.Productos" style="padding-left: 10px; padding-right: 10px;">
                        <div class="col-lg-3" style="padding: 2px;">
                            <label>{{productos.nombre}}</label> 
                        </div>
                        <div class="col-lg-1" style="padding: 2px;">
                            <!-- <ui-select id="ddlDevolucionCantidadProducto{{productos.idProducto}}" ng-disabled="productos.Visible == 0"  search-enabled="true" 
                                ng-model="productos.Valor"
                                ng-change="this.caja.movimientos.cambiarCantidadProductoADevolver(productos.Valor)" 
                                theme="select2" style="width: 100%">
                                <ui-select-match placeholder="0">{{$select.selected.Valor}}</ui-select-match>
                                <ui-select-choices repeat="Cantidades.idValor as Cantidades in productos.Cantidad| filter: {'Valor': $select.search}">
                                    <span ng-bind-html="Cantidades.Valor"></span>
                                </ui-select-choices>
                            </ui-select> -->
                            <ng-select id="ddlDevolucionCantidadProducto{{productos.idProducto}}" 
                                    style="width: 100%; height: 36px;" class="borderAzul"
                                    [dropdownPosition]="'bottom'"                                                    
                                    [multiple]="false" 
                                    appendTo="#ddlDevolucionCantidadProducto{{productos.idProducto}}" 
                                    [searchable]="true"
                                    [(ngModel)]="productos.Valor.idValor" 
                                    [clearable]="false"
                                    placeholder="0"
                                    [items]="productos.Cantidad" 
                                    bindLabel="Valor" 
                                    bindValue="idValor"
                                    (change)="this.caja_movimientos_cambiarCantidadProductoADevolver(productos.Valor)"
                                    [disabled]="productos.Visible == 0">
                            </ng-select>
                        </div>
                        <div class="col-lg-2" style="padding: 2px;display:flex">
                            <label class="payment-company-currency">$</label>
                            <input tabindex="5" class="form-control borderAzul" maxlength="100" type="text" style="width: 100%; height: 36px;" [disabled]="true" [(ngModel)]="productos.precio">
                        </div>
                        <div class="col-lg-2" style="padding: 2px;display:flex">
                            <label class="payment-company-currency">$</label>
                            <input tabindex="5" [disabled]="!productos.Devolver" class="form-control borderAzul" maxlength="100" decimals-only style="width: 100%; height: 36px;" 
                                [(ngModel)]="productos.monto" 
                                (click)="this.caja_movimientos_quitarCerosMontoEfectivoDevolucion(productos.idPagoClienteDetalle)" 
                                (blur)="this.caja_movimientos_ponerCerosMontoEfectivoDevolucion(productos.idPagoClienteDetalle)" 
                                (input)="this.caja_movimientos_cambiarMontoProductoADevolver(productos.idPagoClienteDetalle, productos.monto, productos.montoLimite)">
                        </div>
                        <div class="col-lg-3" style="padding: 2px;">
                            <!-- <ui-select id="ddlDevolucionTipo{{productos.idProducto}}" search-enabled="false" readonly="true" ng-model="productos.TipoDevolucion"
                                theme="select2" style="width: 100%" ng-disabled="true">
                                <ui-select-match placeholder="{{'servicioTranslate.costoTipoM'| translate}}">{{$select.selected.descripcion}}</ui-select-match>
                                <ui-select-choices repeat="TipoDevolucion.idTipoDevolucion as TipoDevolucion in this.caja.movimientos.dataCmboCaja  | filter: {descripcion: $select.search}">
                                    <span ng-bind-html="TipoDevolucion.descripcion"></span>
                                </ui-select-choices>
                            </ui-select> -->
                            <ng-select id="ddlDevolucionTipo{{productos.idProducto}}" 
                                    style="width: 100%; height: 36px;" class="borderAzul"
                                    [dropdownPosition]="'bottom'"                                                    
                                    [multiple]="false" 
                                    appendTo="#ddlDevolucionTipo{{productos.idProducto}}" 
                                    [searchable]="true"
                                    [(ngModel)]="productos.TipoDevolucion" 
                                    [clearable]="false"
                                    placeholder="{{'servicioTranslate.costoTipoM'| translate}}"
                                    [items]="this.caja.movimientos.dataCmboCaja" 
                                    bindLabel="descripcion" 
                                    bindValue="idTipoDevolucion"                                        
                                    [disabled]="true">
                            </ng-select>
                        </div>
                            <div class="col-lg-1" style="padding: 2px;display:flex">
                            <input [(ngModel)]="productos.Devolver" type="checkbox" class="" 
                                style="font-size: 13px; height: 18px; width: 18px; margin-top: 7px; margin-left: 50%;" 
                                content="”body”" 
                                (input)="this.caja_movimientos_cambiarEstatusDevolucionProducto(productos.idPagoClienteDetalle)">
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-3" style="padding: 0;"></div>
                        <div class="col-lg-1" style="padding: 5px;"></div>
                        <div class="col-lg-2" style="padding: 5px;"></div>
                        <div class="col-lg-2" style="padding: 5px;display: flex; justify-self: center; padding-left: 45px">
                            <div class="row">
                                <div class="col-lg-12" style="height: 34px; border-top: 1px solid gray; text-align: center; padding-top: 5px;">
                                    <b class="ng-binding"> {{this.caja.movimientos.totalMonto | currency}} </b>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- </div> -->
                </div>
            </div>

            <div class="modal-footer">
                <div class="col-lg-3">
                    <button class="buttonEstiloBlanco" data-bs-dismiss="modal" (click)="modales.modalDevoluciones.hide();" type="button" style="height: auto;">
                        Cancelar
                    </button>
                </div>
                <div class="col-lg-3">
                    <button class="buttonEstiloBlanco" (click)="this.caja_movimientos_validarDevolucion()" type="button" style="height: auto;">
                        Devolver
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="modalCancelarPago" aria-hidden="true" class="modal fade" role="dialog">
    <div class="modal-dialog" style="margin-top: 120px;">
        <div class="modal-content">
            <div class="modal-body">
                ¿Estas seguro que deseas cancelar el Pago?
            </div>
            
            <div class="modal-footer">
                <div class="col-lg-3">
                    <button type="button" data-bs-dismiss="modal" (click)="modales.modalCancelarPago.hide();" class="buttonEstiloBlanco" style="height: auto;">
                        No
                    </button>
                </div>
                <div class="col-lg-3">
                    <button type="button" class="buttonEstiloBlanco" data-bs-dismiss="modal" (click)="this.caja_movimientos_validarFacturaCancelacion(this.caja.movimientos.idFolioCancelar)" style="height: auto;">
                        Aceptar
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="modal-Firma-Autorizacion" aria-hidden="true" class="modal fade" role="dialog"style="z-index: 3000;">
    <div class="modal-dialog modal-lg">
        <div class="modal-content" style="margin: 0 auto; font-weight: 400; min-width:263px;">
            <div class="modal-header" style="height: 60px !important; margin: 0px;">
                <span> Autorización </span>
                <mat-icon class="iconosBookipp" svgIcon="iconCruzCirculo" data-bs-dismiss="modal" style="cursor: pointer; float: right; font-size: 16px;"></mat-icon>
            </div>
            <div class="row modal-body">
                <div id="Div21" class="tab-content" style="margin-left: -15px; margin-right: -15px; border: 0px solid;">
                    <div class="row">
                        <div class="col-lg-12">
                            <div class="form-group">
                                <label id="lbFirma" class="col-lg-12 control-label"style="padding-top: 0; text-align: center; font-size: medium;">
                                </label>
                            </div>
                        </div>
                    </div>
                    <div class="row" style="margin-top: 10px">
                        <div class="col-lg-12">
                            <div class="form-group">
                                <div class="row">
                                    <div class="col-lg-1"></div>
                                    <label id="Label1" class="col-lg-4 control-label" style="padding-top: 0">
                                        Usuario
                                    </label>
                                    <div class="col-lg-6">
                                        <div class="row">
                                            <input tabindex="5" id="txtUsuarioFirma"class="form-control borderAzul" maxlength="100"
                                                type="text" style="width: 100%;" [(ngModel)]="this.caja.movimientos.UsuarioFirma" autocomplete="off">
                                            <div class="col-lg-12" style="color: red;">
                                                {{ this.caja.movimientos.msgUsuarioFirma }}
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-1"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row" style="margin-top: 10px">
                        <div class="col-lg-12">                            
                            <div class="form-group">
                                <div class="row">
                                    <div class="col-lg-1"></div>
                                    <label id="lbContra" class="col-lg-4 control-label"style="padding-top: 0">
                                        Contraseña
                                    </label>
                                    <div class="col-lg-6">
                                        <div class="row">
                                            <input tabindex="5" id="txtContraFirma" class="form-control borderAzul" maxlength="100"
                                                type="password" style="width: 100%;" [(ngModel)]="this.caja.movimientos.ContraFirma" autocomplete="off">
                                            <div class="col-lg-12" style="color: red;">
                                                {{this.caja.movimientos.msgContraFirma}}
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-1"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="modal-footer" style="justify-content: center;">
                <div class="col-3">
                    <button id="btnAceptarFirma" class="buttonEstiloBlanco" type="button"  (click)="this.caja_movimientos_accionAceptarFirma()">
                        Aceptar
                        <i id="I5"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>