<mat-card class="mat-elevation-z8">
    <mat-card-header>
        <div style="width: 100%; display: flex;">
            <mat-card-title> Perfil Usuario </mat-card-title>
            <!-- <li id="btnNuevo" class="fa fa-plus-circle ng-scope" 
                *ngIf="configPerfilUsuarios.verApartadoPerfiles == 0" 
                (click)="configPerfilUsuarios_nuevoPerfilUsuario()" 
                style="font-size: 2em; cursor: pointer; color: #78C4A7; margin-left: 8px; margin-top: 3px;">
            </li> -->
            <mat-icon id="btnNuevo" 
                class="iconosBookipp mx-2" 
                svgIcon="iconAgregar" 
                *ngIf="configPerfilUsuarios.verApartadoPerfiles == 0" 
                (click)="configPerfilUsuarios_nuevoPerfilUsuario()" 
                matListIcon 
                style="cursor: pointer; width: 30px; height: 30px; position: relative; left: -5px;">
            </mat-icon>
        </div>
        <div style="text-align: right; width: 100%;">
            <mat-icon class="iconosBookipp" svgIcon="iconCasa1" (click)="irAAgenda()" style="cursor: pointer; height: auto; position: relative;"></mat-icon>
            <a style="cursor: pointer; color: #20c4e6; top: -6px; position: relative;" (click)="irAAgenda()">{{'consultaClienteTranslate.inicio' | translate}}</a>
            <mat-icon class="iconosBookipp" svgIcon="iconFlecha1DerechaPeque" style="position: relative;"></mat-icon>
            <a *ngIf="configPerfilUsuarios.verApartadoPerfiles == 0" style="color: #20c4e6; top: -6px; position: relative; text-decoration: none;">Perfil Usuario</a>&nbsp;
            <a *ngIf="configPerfilUsuarios.verApartadoPerfiles != 0" (click)="irAPerfilUsuario()" style="cursor: pointer; color: #20c4e6; top: -6px; position: relative; text-decoration: none;">Perfil Usuario</a>&nbsp;
        </div>
    </mat-card-header>
    <mat-divider></mat-divider>

    <mat-card-content style="margin-top: 10px;">

        <div style="width: 100%;">
            <div style="margin: auto">                
                <div id="ConfigPerfilUsuario" class="ng-scope">
                    <div class="col-md-12" style="padding-left: 0px;">
                        <div style="width: 100%; padding-bottom: 0px;">
                            <div style="margin: auto">
                                <div class="modal-body">        
                                    <div>        
                                        <div [hidden]="configPerfilUsuarios.verApartadoPerfiles != 0">
                                            <div>                                                
                                                <div class="row" style="text-align: center;" ng-show="configPerfilUsuarios.perfilesUsuarios.length>0">                                                              
                                                    <div class="col-lg-12 overflow-auto">
                                                        <div class="mat-elevation-z8 my-2" style="min-width: 700px;">
                                                        <table mat-table [dataSource]="dataSource" matSort style="width: 100%;">
                        
                                                            <ng-container matColumnDef="acciones">
                                                                <th mat-header-cell *matHeaderCellDef style="text-align: center;">Acciones</th>
                                                                <td mat-cell *matCellDef="let element" style="text-align: center;" class="auto-width">                                                                    
                                                                    <!-- Icono Editar -->
                                                                    <!-- <i (click)="configPerfilUsuarios_editarPerfilUsuario(element.idPerfilSucursal, element.Nombre)"
                                                                        class="fa-solid fa-pencil colorPrimario" 
                                                                        style="font-size: 1.2em; cursor:pointer; width:29px;">
                                                                    </i> -->
                                                                    <mat-icon svgIcon="iconEditar" 
                                                                        (click)="configPerfilUsuarios_editarPerfilUsuario(element.idPerfilSucursal, element.Nombre)"
                                                                        class="iconosBookipp"     
                                                                        style="font-size: 1.2em; cursor:pointer; width:29px;"
                                                                        matListIcon >
                                                                    </mat-icon>
                                            
                                                                    <!-- <i (click)="configPerfilUsuarios_validarEliminarPerfilUsuario(element.idPerfilSucursal, element.Nombre)"
                                                                        class="fa-solid fa-trash-can colorPrimario"
                                                                        style="font-size: 1.2em; cursor:pointer; width:29px;">
                                                                    </i> -->
                                                                    <mat-icon svgIcon="iconBasura" 
                                                                        (click)="configPerfilUsuarios_validarEliminarPerfilUsuario(element.idPerfilSucursal, element.Nombre)"
                                                                        class="iconosBookipp"     
                                                                        style="font-size: 1.2em; cursor:pointer; width:29px;"
                                                                        matListIcon >
                                                                    </mat-icon>

                                                                </td>
                                                            </ng-container>
                                                
                                                            <ng-container matColumnDef="nombre">
                                                                <th mat-header-cell mat-sort-header *matHeaderCellDef style="text-align: left;">Nombre</th>
                                                                <td mat-cell *matCellDef="let element" style="text-align: center;" class="auto-width">                                                        
                                                                    {{ element.Nombre }}
                                                                </td>
                                                            </ng-container>
                                                
                                                            <ng-container matColumnDef="fecha">
                                                                <th mat-header-cell mat-sort-header *matHeaderCellDef style="text-align: center;">Fecha</th>
                                                                <td mat-cell *matCellDef="let element" style="text-align: center;" class="auto-width">                                                        
                                                                    {{ element.Fecha | date : 'dd/MM/yyyy hh:mm a'}}
                                                                </td>
                                                            </ng-container>                                                
                                                                      
                                                            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                                                            <tr mat-row *matRowDef="let row; columns: displayedColumns;" ></tr>                    
                                                        </table>                                                        
                                                        </div>
                                                        <mat-paginator [pageSizeOptions]="[10, 25, 50, 100, 200]" showFirstLastButtons aria-label="Facebook">
                                                        </mat-paginator>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
        
                                        <div [hidden]="configPerfilUsuarios.verApartadoPerfiles == 0">
                                            <div class="form-group">                                                
                                                <div class="row">
                                                    <div class="col-lg-1">
                                                        <label class="control-label" style="padding-top: 7px;">
                                                            Nombre
                                                        </label>
                                                    </div>
                                                    <div class="col-lg-5">
                                                        <input tabindex="5" id="txtPerfilNombre" class="form-control borderAzul" maxlength="100" type="text" style="width: 100%;" [(ngModel)]="configPerfilUsuarios.nombrePerfil" (click)="configPerfilUsuarios_limpiarValidacionesPerfil()">
                                                    </div>
                                                    <div class="col-lg-1">
                                                        <label class="control-label" style="padding-top: 7px;">
                                                            Tipo
                                                        </label>
                                                    </div>
                                                    <div class="col-lg-5">
                                                        <!-- <ui-select id="perfilUsuarios" append-to-body="$root.mobileBrowser" chuy-select search-enabled="$root.mobileBrowser" ng-model="configPerfilUsuarios.idPerfilSucursalTipo"
                                                            theme="select2" style="width: 100%;" ng-change="configPerfilUsuarios.cambioTipoPerfil()">
                                                        <ui-select-match allow-clear="true" placeholder="Seleccionar el tipo de usuario">{{$select.selected.nombre}}</ui-select-match>
                                                        <ui-select-choices repeat="tipoPerfil.idPerfilSucursalTipo as tipoPerfil in configPerfilUsuarios.tipoPerfilesUsuarios | filter: {nombre: $select.search}">
                                                            <span ng-bind-html="tipoPerfil.nombre"></span>
                                                        </ui-select-choices>
                                                        </ui-select> -->
                                                        <ng-select id="perfilUsuarios" class="borderAzul"
                                                            style="width: 100%;" 
                                                            [multiple]="false" 
                                                            appendTo="#perfilUsuarios" 
                                                            [searchable]="false"
                                                            [(ngModel)]="configPerfilUsuarios.idPerfilSucursalTipo" 
                                                            [clearable]="true"
                                                            placeholder="Seleccionar el tipo de usuario"
                                                            [items]="configPerfilUsuarios.tipoPerfilesUsuarios" 
                                                            bindLabel="nombre" 
                                                            bindValue="idPerfilSucursalTipo"
                                                            (ngModelChange)="configPerfilUsuarios_cambioTipoPerfil()">
                                                        </ng-select>
                                                    </div>
                                                </div>
                                                <div class="row" style="padding-top: 10px;">
                                                    <div class="col-lg-1">
                                                        <label class="control-label" style="padding-top: 7px;">
                                                            Módulos
                                                        </label>
                                                    </div>
                                                    <div class="col-lg-5">
                                                        <!-- <ui-select id="ddlModulos" style="width: 100%;" multiple ng-change="configPerfilUsuarios.mostrarModulosSeleccionados()" append-to-body="$root.mobileBrowser" ng-click="configPerfilUsuarios.limpiarValidacionesModulos()" search-enabled="false" chuy-select saenz-select2
                                                            ng-model="configPerfilUsuarios.idModulosSeleccionados" theme="select2">
                                                            <ui-select-match placeholder="Seleccione los modulos para el perfil" >{{$item.nombreModulo}}</ui-select-match>
                                                            <ui-select-choices repeat="Modulo.idModulo as Modulo in configPerfilUsuarios.modulosSeleccionables| filter:configPerfilUsuarios.omitSelected | filter:$select.search">
                                                                {{Modulo.nombreModulo}}
                                                            </ui-select-choices>
                                                        </ui-select> -->
                                                        <ng-select id="ddlModulos" class="borderAzul"
                                                            style="width: 100%;" 
                                                            [multiple]="true" 
                                                            appendTo="#ddlModulos" 
                                                            [searchable]="true"
                                                            [(ngModel)]="configPerfilUsuarios.idModulosSeleccionados" 
                                                            [clearable]="false"
                                                            placeholder="Seleccione los modulos para el perfil"
                                                            [items]="configPerfilUsuarios.modulosSeleccionables" 
                                                            bindLabel="nombreModulo" 
                                                            bindValue="idModulo"
                                                            (ngModelChange)="configPerfilUsuarios_mostrarModulosSeleccionados()">
                                                        </ng-select>
                                                    </div>
                                                </div>
                                                <div class="col-lg-12" style="padding: 5px;">
                                                    <div class="col-lg-3">
                                                    </div>        
                                                </div>
                                                                                                                                                
                                                <div class="col-lg-12" style="background-color: white; padding-top: 15px; border-radius: 5px; padding-left: 8px; padding-right: 8px; padding-bottom: 15px;">
        
                                                    <table style="width: 100%" *ngIf="configPerfilUsuarios.visTablaEncabezados != 0">
                                                        <tr>
                                                            <th style="width: 80%; padding: 4px">Descripción</th>
                                                            <th style="width: 10%; text-align: center">Si</th>
                                                            <th style="width: 10%; text-align: center">No</th>
                                                        </tr>
                                                    </table>

                                                    <table style="width: 100%">
                                                        <ng-container *ngFor="let Modulos of configPerfilUsuarios.totalCatalogoModulos">
                                                          <ng-container *ngIf="Modulos.visualizar == 1">
                                                            <tr [ngStyle]="{'background-color': Modulos.colorBackground, 'color': Modulos.colorTexto}">
                                                              <th style="width: 80%; padding: 4px;">
                                                                <i [ngClass]="Modulos.visualizarLista == 1 ? 'fa fa-minus-square' : 'fa fa-plus-square'"
                                                                   style="cursor: pointer; font-size: initial; color: #b7c4c9;"
                                                                   (click)="configPerfilUsuarios_verListadoModulo(Modulos.idModulo)"></i>
                                                                {{Modulos.nombreModulo}}
                                                              </th>
                                                              <th style="width: 10%;"></th>
                                                              <th style="width: 10%;"></th>
                                                            </tr>
                                                            <ng-container *ngIf="Modulos.visualizarLista == 1">
                                                              <tr *ngFor="let Accesos of Modulos.accesos">
                                                                <td [ngStyle]="{'border-bottom': Accesos.tipoBordesAccesos}">
                                                                  <div style="margin-left: 5%" *ngIf="Accesos.contador != 0">{{Accesos.contador}}. {{Accesos.nombreAcceso}}</div>
                                                                  <div style="margin-left: 5%" *ngIf="Accesos.contador == 0">{{Accesos.nombreAcceso}}</div>
                                                                </td>
                                                                <td [ngStyle]="{'border-bottom': Accesos.tipoBordesAccesos}" style="text-align: center;">
                                                                  <input [(ngModel)]="Accesos.checkboxSi" trueValue="1" falseValue="0"
                                                                         (ngModelChange)="configPerfilUsuarios_cambiarCheckboxSi(Modulos.idModulo, Accesos.idAccesoSucursal)"
                                                                         type="checkbox" style="height: 18px; height: 18px;" [attr.content]="'body'">
                                                                </td>
                                                                <td [ngStyle]="{'border-bottom': Accesos.tipoBordesAccesos}" style="text-align: center;">
                                                                  <input [(ngModel)]="Accesos.checkboxNo" trueValue="1" falseValue="0"
                                                                         (ngModelChange)="configPerfilUsuarios_cambiarCheckboxNo(Modulos.idModulo, Accesos.idAccesoSucursal)"
                                                                         type="checkbox" style="height: 18px; height: 18px;" [attr.content]="'body'">
                                                                </td>
                                                              </tr>
                                                            </ng-container>
                                                          </ng-container>
                                                        </ng-container>
                                                      </table>                                                      
        
                                                </div>
                                                <div id="botones" class="col-md-12" style="text-align: center; margin-top: 45px; margin-bottom: 45px;">                                                                                                        
                                                    <div class="row">
                                                        <div class="col-lg-2">                                            
                                                        </div>
                                                        <div class="col-lg-4 py-1">
                                                            <div class="col-lg-1"></div>
                                                            <div class="col-lg-10">
                                                                <button id="botonGuardar" *ngIf="!configPerfilUsuarios.editarPerfilVal" type="button" (click)="configPerfilUsuarios_agregarPerfil()" class="buttonEstiloBlanco">Agregar</button>
                                                                <button id="botonEditar" *ngIf="configPerfilUsuarios.editarPerfilVal" type="button" (click)="configPerfilUsuarios_editarPerfil()" class="buttonEstiloBlanco">Editar</button>
                                                            </div>
                                                            <div class="col-lg-1"></div>
                                                        </div>
                                                        <div class="col-lg-4 py-1">
                                                            <div class="col-lg-1"></div>
                                                            <div class="col-lg-10">
                                                                <button id="botonCancelar" type="button" (click)="configPerfilUsuarios_regresarfuncion()" class="buttonEstiloBlanco">Regresar</button>
                                                            </div>
                                                            <div class="col-lg-1"></div>
                                                        </div>
                                                        <div class="col-lg-2">                                            
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
        
                    </div>
                </div>
            </div>
        </div>

    </mat-card-content>

</mat-card>


<div id="modalEliminarPerfilUsuario" aria-hidden="true" class="modal fade modalEliminarPerfilUsuario" role="dialog">
    <div class="modal-dialog" style="margin-top: 120px;">
        <div class="modal-content">
            <div class="modal-body">
                ¿Estas seguro que deseas eliminar el perfil "{{configPerfilUsuarios.nombrePerfilEliminar}}"?
            </div>
            <div class="modal-footer">
                <div class="col-lg-3">
                    <button type="button" (click)="modales.modalEliminarPerfilUsuario.hide()" class="buttonEstiloBlanco" style="height: auto;">
                        No
                    </button>
                </div>
                <div class="col-lg-3">
                    <button type="button" class="buttonEstiloBlanco" (click)="configPerfilUsuarios_eliminarPerfilUsuario()" style="height: auto;">
                        Aceptar
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
